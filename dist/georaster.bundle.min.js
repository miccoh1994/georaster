!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("node-fetch")):"function"==typeof define&&define.amd?define(["node-fetch"],t):"object"==typeof exports?exports.GeoRaster=t(require("node-fetch")):e.GeoRaster=t(e["node-fetch"])}("undefined"!=typeof self?self:this,(function(__WEBPACK_EXTERNAL_MODULE__36__){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=34)}([function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return a}));const i=Symbol("thread.errors"),n=Symbol("thread.events"),o=Symbol("thread.terminate"),s=Symbol("thread.transferable"),a=Symbol("thread.worker")},function(e,t,r){"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(62):e.exports=r(64)},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return s}));const i={deserialize:e=>Object.assign(Error(e.message),{name:e.name,stack:e.stack}),serialize:e=>({__error_marker:"$$error",message:e.message,name:e.name,stack:e.stack})};let n={deserialize(e){return(t=e)&&"object"==typeof t&&"__error_marker"in t&&"$$error"===t.__error_marker?i.deserialize(e):e;var t},serialize:e=>e instanceof Error?i.serialize(e):e};function o(e){return n.deserialize(e)}function s(e){return n.serialize(e)}},function(e,t){e.exports=require("util")},function(e,t,r){"use strict";var i=r(9),n=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=u;var o=Object.create(r(5));o.inherits=r(6);var s=r(20),a=r(23);o.inherits(u,s);for(var l=n(a.prototype),c=0;c<l.length;c++){var f=l[c];u.prototype[f]||(u.prototype[f]=a.prototype[f])}function u(e){if(!(this instanceof u))return new u(e);s.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||i.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),u.prototype._destroy=function(e,t){this.push(null),this.end(),i.nextTick(t,e)}},function(e,t){function r(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===r(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===r(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===r(e)},t.isError=function(e){return"[object Error]"===r(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=Buffer.isBuffer},function(e,t,r){try{var i=r(3);if("function"!=typeof i.inherits)throw"";e.exports=i.inherits}catch(t){e.exports=r(45)}},function(e,t){e.exports=require("path")},function(e,t,r){"use strict";var i,n;r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return n})),function(e){e.run="run"}(i||(i={})),function(e){e.error="error",e.init="init",e.result="result",e.running="running",e.uncaughtError="uncaughtError"}(n||(n={}))},function(e,t,r){"use strict";"undefined"==typeof process||!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?e.exports={nextTick:function(e,t,r,i){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var n,o,s=arguments.length;switch(s){case 0:case 1:return process.nextTick(e);case 2:return process.nextTick((function(){e.call(null,t)}));case 3:return process.nextTick((function(){e.call(null,t,r)}));case 4:return process.nextTick((function(){e.call(null,t,r,i)}));default:for(n=new Array(s-1),o=0;o<n.length;)n[o++]=arguments[o];return process.nextTick((function(){e.apply(null,n)}))}}}:e.exports=process},function(e,t,r){var i=r(13),n=i.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function s(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=i:(o(i,t),t.Buffer=s),o(n,s),s.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},s.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i.SlowBuffer(e)}},function(e,t,r){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var i in r)n(r,i)&&(e[i]=r[i])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var o={arraySet:function(e,t,r,i,n){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+i),n);else for(var o=0;o<i;o++)e[n+o]=t[r+o]},flattenChunks:function(e){var t,r,i,n,o,s;for(i=0,t=0,r=e.length;t<r;t++)i+=e[t].length;for(s=new Uint8Array(i),n=0,t=0,r=e.length;t<r;t++)o=e[t],s.set(o,n),n+=o.length;return s}},s={arraySet:function(e,t,r,i,n){for(var o=0;o<i;o++)e[n+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,o)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,s))},t.setTyped(i)},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("buffer")},,function(e,t){e.exports=require("events")},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("http")},function(e,t,r){"use strict";e.exports={countIn1D:function(e){return e.reduce((function(e,t){return void 0===e[t]?e[t]=1:e[t]++,e}),{})},countIn2D:function(e){return e.reduce((function(e,t){return t.forEach((function(t){void 0===e[t]?e[t]=1:e[t]++})),e}),{})},unflatten:function(e,t){for(var r=t.height,i=t.width,n=[],o=0;o<r;o++){var s=o*i,a=s+i;n.push(e.slice(s,a))}return n}}},function(e,t){e.exports=require("stream")},function(e,t,r){"use strict";var i=r(9);e.exports=w;var n,o=r(44);w.ReadableState=y;r(15).EventEmitter;var s=function(e,t){return e.listeners(t).length},a=r(21),l=r(10).Buffer,c=global.Uint8Array||function(){};var f=Object.create(r(5));f.inherits=r(6);var u=r(3),h=void 0;h=u&&u.debuglog?u.debuglog("stream"):function(){};var d,p=r(46),g=r(22);f.inherits(w,a);var m=["error","close","destroy","pause","resume"];function y(e,t){e=e||{};var i=t instanceof(n=n||r(4));this.objectMode=!!e.objectMode,i&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var o=e.highWaterMark,s=e.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=o||0===o?o:i&&(s||0===s)?s:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(d||(d=r(24).StringDecoder),this.decoder=new d(e.encoding),this.encoding=e.encoding)}function w(e){if(n=n||r(4),!(this instanceof w))return new w(e);this._readableState=new y(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),a.call(this)}function b(e,t,r,i,n){var o,s=e._readableState;null===t?(s.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,_(e)}(e,s)):(n||(o=function(e,t){var r;i=t,l.isBuffer(i)||i instanceof c||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk"));var i;return r}(s,t)),o?e.emit("error",o):s.objectMode||t&&t.length>0?("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=function(e){return l.from(e)}(t)),i?s.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):v(e,s,t,!0):s.ended?e.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!r?(t=s.decoder.write(t),s.objectMode||0!==t.length?v(e,s,t,!1):k(e,s)):v(e,s,t,!1))):i||(s.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(s)}function v(e,t,r,i){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,i?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&_(e)),k(e,t)}Object.defineProperty(w.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),w.prototype.destroy=g.destroy,w.prototype._undestroy=g.undestroy,w.prototype._destroy=function(e,t){this.push(null),t(e)},w.prototype.push=function(e,t){var r,i=this._readableState;return i.objectMode?r=!0:"string"==typeof e&&((t=t||i.defaultEncoding)!==i.encoding&&(e=l.from(e,t),t=""),r=!0),b(this,e,t,!1,r)},w.prototype.unshift=function(e){return b(this,e,null,!0,!1)},w.prototype.isPaused=function(){return!1===this._readableState.flowing},w.prototype.setEncoding=function(e){return d||(d=r(24).StringDecoder),this._readableState.decoder=new d(e),this._readableState.encoding=e,this};function S(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=8388608?e=8388608:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function _(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(h("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?i.nextTick(T,e):T(e))}function T(e){h("emit readable"),e.emit("readable"),A(e)}function k(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(P,e,t))}function P(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(h("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function I(e){h("readable nexttick read 0"),e.read(0)}function O(e,t){t.reading||(h("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),A(e),t.flowing&&!t.reading&&e.read(0)}function A(e){var t=e._readableState;for(h("flow",t.flowing);t.flowing&&null!==e.read(););}function C(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=function(e,t,r){var i;e<t.head.data.length?(i=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):i=e===t.head.data.length?t.shift():r?function(e,t){var r=t.head,i=1,n=r.data;e-=n.length;for(;r=r.next;){var o=r.data,s=e>o.length?o.length:e;if(s===o.length?n+=o:n+=o.slice(0,e),0===(e-=s)){s===o.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(s));break}++i}return t.length-=i,n}(e,t):function(e,t){var r=l.allocUnsafe(e),i=t.head,n=1;i.data.copy(r),e-=i.data.length;for(;i=i.next;){var o=i.data,s=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,s),0===(e-=s)){s===o.length?(++n,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=o.slice(s));break}++n}return t.length-=n,r}(e,t);return i}(e,t.buffer,t.decoder),r);var r}function E(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,i.nextTick(D,t,e))}function D(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function x(e,t){for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1}w.prototype.read=function(e){h("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return h("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?E(this):_(this),null;if(0===(e=S(e,t))&&t.ended)return 0===t.length&&E(this),null;var i,n=t.needReadable;return h("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&h("length less than watermark",n=!0),t.ended||t.reading?h("reading or ended",n=!1):n&&(h("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=S(r,t))),null===(i=e>0?C(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&E(this)),null!==i&&this.emit("data",i),i},w.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},w.prototype.pipe=function(e,t){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=e;break;case 1:n.pipes=[n.pipes,e];break;default:n.pipes.push(e)}n.pipesCount+=1,h("pipe count=%d opts=%j",n.pipesCount,t);var a=(!t||!1!==t.end)&&e!==process.stdout&&e!==process.stderr?c:w;function l(t,i){h("onunpipe"),t===r&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,h("cleanup"),e.removeListener("close",m),e.removeListener("finish",y),e.removeListener("drain",f),e.removeListener("error",g),e.removeListener("unpipe",l),r.removeListener("end",c),r.removeListener("end",w),r.removeListener("data",p),u=!0,!n.awaitDrain||e._writableState&&!e._writableState.needDrain||f())}function c(){h("onend"),e.end()}n.endEmitted?i.nextTick(a):r.once("end",a),e.on("unpipe",l);var f=function(e){return function(){var t=e._readableState;h("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,A(e))}}(r);e.on("drain",f);var u=!1;var d=!1;function p(t){h("ondata"),d=!1,!1!==e.write(t)||d||((1===n.pipesCount&&n.pipes===e||n.pipesCount>1&&-1!==x(n.pipes,e))&&!u&&(h("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,d=!0),r.pause())}function g(t){h("onerror",t),w(),e.removeListener("error",g),0===s(e,"error")&&e.emit("error",t)}function m(){e.removeListener("finish",y),w()}function y(){h("onfinish"),e.removeListener("close",m),w()}function w(){h("unpipe"),r.unpipe(e)}return r.on("data",p),function(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?o(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}(e,"error",g),e.once("close",m),e.once("finish",y),e.emit("pipe",r),n.flowing||(h("pipe resume"),r.resume()),e},w.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r)),this;if(!e){var i=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<n;o++)i[o].emit("unpipe",this,r);return this}var s=x(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r)),this},w.prototype.on=function(e,t){var r=a.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&_(this):i.nextTick(I,this))}return r},w.prototype.addListener=w.prototype.on,w.prototype.resume=function(){var e=this._readableState;return e.flowing||(h("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(O,e,t))}(this,e)),this},w.prototype.pause=function(){return h("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(h("pause"),this._readableState.flowing=!1,this.emit("pause")),this},w.prototype.wrap=function(e){var t=this,r=this._readableState,i=!1;for(var n in e.on("end",(function(){if(h("wrapped end"),r.decoder&&!r.ended){var e=r.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(n){(h("wrapped data"),r.decoder&&(n=r.decoder.write(n)),r.objectMode&&null==n)||(r.objectMode||n&&n.length)&&(t.push(n)||(i=!0,e.pause()))})),e)void 0===this[n]&&"function"==typeof e[n]&&(this[n]=function(t){return function(){return e[t].apply(e,arguments)}}(n));for(var o=0;o<m.length;o++)e.on(m[o],this.emit.bind(this,m[o]));return this._read=function(t){h("wrapped _read",t),i&&(i=!1,e.resume())},this},Object.defineProperty(w.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),w._fromList=C},function(e,t,r){e.exports=r(19)},function(e,t,r){"use strict";var i=r(9);function n(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var r=this,o=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return o||s?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||i.nextTick(n,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(i.nextTick(n,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,r){"use strict";var i=r(9);function n(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,r){var i=e.entry;e.entry=null;for(;i;){var n=i.callback;t.pendingcb--,n(r),i=i.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=m;var o,s=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:i.nextTick;m.WritableState=g;var a=Object.create(r(5));a.inherits=r(6);var l={deprecate:r(47)},c=r(21),f=r(10).Buffer,u=global.Uint8Array||function(){};var h,d=r(22);function p(){}function g(e,t){o=o||r(4),e=e||{};var a=t instanceof o;this.objectMode=!!e.objectMode,a&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var l=e.highWaterMark,c=e.writableHighWaterMark,f=this.objectMode?16:16384;this.highWaterMark=l||0===l?l:a&&(c||0===c)?c:f,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var u=!1===e.decodeStrings;this.decodeStrings=!u,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var r=e._writableState,n=r.sync,o=r.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(r),t)!function(e,t,r,n,o){--t.pendingcb,r?(i.nextTick(o,n),i.nextTick(_,e,t),e._writableState.errorEmitted=!0,e.emit("error",n)):(o(n),e._writableState.errorEmitted=!0,e.emit("error",n),_(e,t))}(e,r,n,t,o);else{var a=v(r);a||r.corked||r.bufferProcessing||!r.bufferedRequest||b(e,r),n?s(w,e,r,a,o):w(e,r,a,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}function m(e){if(o=o||r(4),!(h.call(m,this)||this instanceof o))return new m(e);this._writableState=new g(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),c.call(this)}function y(e,t,r,i,n,o,s){t.writelen=i,t.writecb=s,t.writing=!0,t.sync=!0,r?e._writev(n,t.onwrite):e._write(n,o,t.onwrite),t.sync=!1}function w(e,t,r,i){r||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,i(),_(e,t)}function b(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var i=t.bufferedRequestCount,o=new Array(i),s=t.corkedRequestsFree;s.entry=r;for(var a=0,l=!0;r;)o[a]=r,r.isBuf||(l=!1),r=r.next,a+=1;o.allBuffers=l,y(e,t,!0,t.length,o,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new n(t),t.bufferedRequestCount=0}else{for(;r;){var c=r.chunk,f=r.encoding,u=r.callback;if(y(e,t,!1,t.objectMode?1:c.length,c,f,u),r=r.next,t.bufferedRequestCount--,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequest=r,t.bufferProcessing=!1}function v(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function S(e,t){e._final((function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),_(e,t)}))}function _(e,t){var r=v(t);return r&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,i.nextTick(S,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}a.inherits(m,c),g.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(g.prototype,"buffer",{get:l.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(h=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(e){return!!h.call(this,e)||this===m&&(e&&e._writableState instanceof g)}})):h=function(e){return e instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(e,t,r){var n,o=this._writableState,s=!1,a=!o.objectMode&&(n=e,f.isBuffer(n)||n instanceof u);return a&&!f.isBuffer(e)&&(e=function(e){return f.from(e)}(e)),"function"==typeof t&&(r=t,t=null),a?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof r&&(r=p),o.ended?function(e,t){var r=new Error("write after end");e.emit("error",r),i.nextTick(t,r)}(this,r):(a||function(e,t,r,n){var o=!0,s=!1;return null===r?s=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(e.emit("error",s),i.nextTick(n,s),o=!1),o}(this,o,e,r))&&(o.pendingcb++,s=function(e,t,r,i,n,o){if(!r){var s=function(e,t,r){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=f.from(t,r));return t}(t,i,n);i!==s&&(r=!0,n="buffer",i=s)}var a=t.objectMode?1:i.length;t.length+=a;var l=t.length<t.highWaterMark;l||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:o,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else y(e,t,!1,a,i,n,o);return l}(this,o,a,e,t,r)),s},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||b(this,e))},m.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(e,t,r){t.ending=!0,_(e,t),r&&(t.finished?i.nextTick(r):e.once("finish",r));t.ended=!0,e.writable=!1}(this,n,r)},Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),m.prototype.destroy=d.destroy,m.prototype._undestroy=d.undestroy,m.prototype._destroy=function(e,t){this.end(),t(e)}},function(e,t,r){"use strict";var i=r(10).Buffer,n=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===n||!n(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=c,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=f,this.end=u,t=3;break;default:return this.write=h,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,r=function(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function f(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function u(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function d(e){return e&&e.length?this.write(e):""}t.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},o.prototype.text=function(e,t){var r=function(e,t,r){var i=t.length-1;if(i<r)return 0;var n=s(t[i]);if(n>=0)return n>0&&(e.lastNeed=n-1),n;if(--i<r||-2===n)return 0;if((n=s(t[i]))>=0)return n>0&&(e.lastNeed=n-2),n;if(--i<r||-2===n)return 0;if((n=s(t[i]))>=0)return n>0&&(2===n?n=0:e.lastNeed=n-3),n;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var i=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,r){"use strict";e.exports=s;var i=r(4),n=Object.create(r(5));function o(e,t){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(!i)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,null!=t&&this.push(t),i(e);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function s(e){if(!(this instanceof s))return new s(e);i.call(this,e),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",a)}function a(){var e=this;"function"==typeof this._flush?this._flush((function(t,r){l(e,t,r)})):l(this,null,null)}function l(e,t,r){if(t)return e.emit("error",t);if(null!=r&&e.push(r),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}n.inherits=r(6),n.inherits(s,i),s.prototype.push=function(e,t){return this._transformState.needTransform=!1,i.prototype.push.call(this,e,t)},s.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},s.prototype._write=function(e,t,r){var i=this._transformState;if(i.writecb=r,i.writechunk=e,i.writeencoding=t,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},s.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},s.prototype._destroy=function(e,t){var r=this;i.prototype._destroy.call(this,e,(function(e){t(e),r.emit("close")}))}},function(e,t,r){e.exports=function(e){function t(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return i.colors[Math.abs(t)%i.colors.length]}function i(e){let r;function s(...e){if(!s.enabled)return;const t=s,n=Number(new Date),o=n-(r||n);t.diff=o,t.prev=r,t.curr=n,r=n,e[0]=i.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(r,n)=>{if("%%"===r)return r;a++;const o=i.formatters[n];if("function"==typeof o){const i=e[a];r=o.call(t,i),e.splice(a,1),a--}return r}),i.formatArgs.call(t,e),(t.log||i.log).apply(t,e)}return s.namespace=e,s.enabled=i.enabled(e),s.useColors=i.useColors(),s.color=t(e),s.destroy=n,s.extend=o,"function"==typeof i.init&&i.init(s),i.instances.push(s),s}function n(){const e=i.instances.indexOf(this);return-1!==e&&(i.instances.splice(e,1),!0)}function o(e,t){const r=i(this.namespace+(void 0===t?":":t)+e);return r.log=this.log,r}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return i.debug=i,i.default=i,i.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},i.disable=function(){const e=[...i.names.map(s),...i.skips.map(s).map(e=>"-"+e)].join(",");return i.enable(""),e},i.enable=function(e){let t;i.save(e),i.names=[],i.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),n=r.length;for(t=0;t<n;t++)r[t]&&("-"===(e=r[t].replace(/\*/g,".*?"))[0]?i.skips.push(new RegExp("^"+e.substr(1)+"$")):i.names.push(new RegExp("^"+e+"$")));for(t=0;t<i.instances.length;t++){const e=i.instances[t];e.enabled=i.enabled(e.namespace)}},i.enabled=function(e){if("*"===e[e.length-1])return!0;let t,r;for(t=0,r=i.skips.length;t<r;t++)if(i.skips[t].test(e))return!1;for(t=0,r=i.names.length;t<r;t++)if(i.names[t].test(e))return!0;return!1},i.humanize=r(63),Object.keys(e).forEach(t=>{i[t]=e[t]}),i.instances=[],i.names=[],i.skips=[],i.formatters={},i.selectColor=t,i.enable(i.load()),i}},function(e,t,r){function i(e,t){"use strict";var r=(t=t||{}).pos||0,n="<".charCodeAt(0),o=">".charCodeAt(0),s="-".charCodeAt(0),a="/".charCodeAt(0),l="!".charCodeAt(0),c="'".charCodeAt(0),f='"'.charCodeAt(0);function u(){for(var t=[];e[r];)if(e.charCodeAt(r)==n){if(e.charCodeAt(r+1)===a)return(r=e.indexOf(">",r))+1&&(r+=1),t;if(e.charCodeAt(r+1)===l){if(e.charCodeAt(r+2)==s){for(;-1!==r&&(e.charCodeAt(r)!==o||e.charCodeAt(r-1)!=s||e.charCodeAt(r-2)!=s||-1==r);)r=e.indexOf(">",r+1);-1===r&&(r=e.length)}else for(r+=2;e.charCodeAt(r)!==o&&e[r];)r++;r++;continue}var i=g();t.push(i)}else{var c=h();c.trim().length>0&&t.push(c),r++}return t}function h(){var t=r;return-2===(r=e.indexOf("<",r)-1)&&(r=e.length),e.slice(t,r+1)}function d(){for(var t=r;-1==="\n\t>/= ".indexOf(e[r])&&e[r];)r++;return e.slice(t,r)}var p=t.noChildNodes||["img","br","input","meta","link"];function g(){r++;const t=d(),i={};let n=[];for(;e.charCodeAt(r)!==o&&e[r];){var s=e.charCodeAt(r);if(s>64&&s<91||s>96&&s<123){for(var l=d(),h=e.charCodeAt(r);h&&h!==c&&h!==f&&!(h>64&&h<91||h>96&&h<123)&&h!==o;)r++,h=e.charCodeAt(r);if(h===c||h===f){var g=m();if(-1===r)return{tagName:t,attributes:i,children:n}}else g=null,r--;i[l]=g}r++}if(e.charCodeAt(r-1)!==a)if("script"==t){var y=r+1;r=e.indexOf("<\/script>",r),n=[e.slice(y,r-1)],r+=9}else if("style"==t){y=r+1;r=e.indexOf("</style>",r),n=[e.slice(y,r-1)],r+=8}else-1==p.indexOf(t)&&(r++,n=u());else r++;return{tagName:t,attributes:i,children:n}}function m(){var t=e[r],i=++r;return r=e.indexOf(t,i),e.slice(i,r)}var y,w=null;if(void 0!==t.attrValue){t.attrName=t.attrName||"id";for(w=[];-1!==(y=void 0,y=new RegExp("\\s"+t.attrName+"\\s*=['\"]"+t.attrValue+"['\"]").exec(e),r=y?y.index:-1);)-1!==(r=e.lastIndexOf("<",r))&&w.push(g()),e=e.substr(r),r=0}else w=t.parseNode?g():u();return t.filter&&(w=i.filter(w,t.filter)),t.setPos&&(w.pos=r),w}i.simplify=function(e){var t={};if(!e.length)return"";if(1===e.length&&"string"==typeof e[0])return e[0];for(var r in e.forEach((function(e){if("object"==typeof e){t[e.tagName]||(t[e.tagName]=[]);var r=i.simplify(e.children||[]);t[e.tagName].push(r),e.attributes&&(r._attributes=e.attributes)}})),t)1==t[r].length&&(t[r]=t[r][0]);return t},i.filter=function(e,t){var r=[];return e.forEach((function(e){if("object"==typeof e&&t(e)&&r.push(e),e.children){var n=i.filter(e.children,t);r=r.concat(n)}})),r},i.stringify=function(e){var t="";function r(e){if(e)for(var r=0;r<e.length;r++)"string"==typeof e[r]?t+=e[r].trim():i(e[r])}function i(e){for(var i in t+="<"+e.tagName,e.attributes)null===e.attributes[i]?t+=" "+i:-1===e.attributes[i].indexOf('"')?t+=" "+i+'="'+e.attributes[i].trim()+'"':t+=" "+i+"='"+e.attributes[i].trim()+"'";t+=">",r(e.children),t+="</"+e.tagName+">"}return r(e),t},i.toContentString=function(e){if(Array.isArray(e)){var t="";return e.forEach((function(e){t=(t+=" "+i.toContentString(e)).trim()})),t}return"object"==typeof e?i.toContentString(e.children):" "+e},i.getElementById=function(e,t,r){var n=i(e,{attrValue:t});return r?i.simplify(n):n[0]},i.getElementsByClassName=function(e,t,r){const n=i(e,{attrName:"class",attrValue:"[a-zA-Z0-9-s ]*"+t+"[a-zA-Z0-9-s ]*"});return r?i.simplify(n):n},i.parseStream=function(e,t){if("string"==typeof t&&(t=t.length+2),"string"==typeof e){var n=r(12);e=n.createReadStream(e,{start:t}),t=0}var o=t,s="";return e.on("data",(function(t){s+=t;for(var r=0;;){if(!(o=s.indexOf("<",o)+1))return void(o=r);if("/"!==s[o+1]){var n=i(s,{pos:o-1,parseNode:!0,setPos:!0});if((o=n.pos)>s.length-1||o<r)return s=s.slice(r),o=0,void(r=0);e.emit("xml",n),r=o}else o+=1,r=pos}})),e.on("end",(function(){console.log("end")})),e},i.transformStream=function(e){const t=r(42);"string"==typeof e&&(e=e.length+2);var n=e||0,o="";return t({readableObjectMode:!0},(function(e,t,r){o+=e;for(var s=0;;){if(!(n=o.indexOf("<",n)+1))return n=s,r();if("/"!==o[n+1]){var a=i(o,{pos:n-1,parseNode:!0,setPos:!0});if((n=a.pos)>o.length-1||n<s)return o=o.slice(s),n=0,s=0,r();this.push(a),s=n}else n+=1,s=pos}r()}))},e.exports=i,i.xml=i},function(e,t,r){"use strict";var i=r(49),n=r(11),o=r(54),s=r(55),a=r(56),l=r(57),c=r(58),f=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var r=i.inflateInit2(this.strm,t.windowBits);if(r!==s.Z_OK)throw new Error(a[r]);if(this.header=new c,i.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=o.string2buf(t.dictionary):"[object ArrayBuffer]"===f.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=i.inflateSetDictionary(this.strm,t.dictionary))!==s.Z_OK))throw new Error(a[r])}function h(e,t){var r=new u(t);if(r.push(e,!0),r.err)throw r.msg||a[r.err];return r.result}u.prototype.push=function(e,t){var r,a,l,c,u,h=this.strm,d=this.options.chunkSize,p=this.options.dictionary,g=!1;if(this.ended)return!1;a=t===~~t?t:!0===t?s.Z_FINISH:s.Z_NO_FLUSH,"string"==typeof e?h.input=o.binstring2buf(e):"[object ArrayBuffer]"===f.call(e)?h.input=new Uint8Array(e):h.input=e,h.next_in=0,h.avail_in=h.input.length;do{if(0===h.avail_out&&(h.output=new n.Buf8(d),h.next_out=0,h.avail_out=d),(r=i.inflate(h,s.Z_NO_FLUSH))===s.Z_NEED_DICT&&p&&(r=i.inflateSetDictionary(this.strm,p)),r===s.Z_BUF_ERROR&&!0===g&&(r=s.Z_OK,g=!1),r!==s.Z_STREAM_END&&r!==s.Z_OK)return this.onEnd(r),this.ended=!0,!1;h.next_out&&(0!==h.avail_out&&r!==s.Z_STREAM_END&&(0!==h.avail_in||a!==s.Z_FINISH&&a!==s.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(h.output,h.next_out),c=h.next_out-l,u=o.buf2string(h.output,l),h.next_out=c,h.avail_out=d-c,c&&n.arraySet(h.output,h.output,l,c,0),this.onData(u)):this.onData(n.shrinkBuf(h.output,h.next_out)))),0===h.avail_in&&0===h.avail_out&&(g=!0)}while((h.avail_in>0||0===h.avail_out)&&r!==s.Z_STREAM_END);return r===s.Z_STREAM_END&&(a=s.Z_FINISH),a===s.Z_FINISH?(r=i.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===s.Z_OK):a!==s.Z_SYNC_FLUSH||(this.onEnd(s.Z_OK),h.avail_out=0,!0)},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){e===s.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},t.Inflate=u,t.inflate=h,t.inflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},t.ungzip=h},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"defaultPoolSize",(function(){return defaultPoolSize})),__webpack_require__.d(__webpack_exports__,"selectWorkerImplementation",(function(){return selectWorkerImplementation}));var callsites__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(30),callsites__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(callsites__WEBPACK_IMPORTED_MODULE_0__),events__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(15),events__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(events__WEBPACK_IMPORTED_MODULE_1__),os__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(16),os__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(os__WEBPACK_IMPORTED_MODULE_2__),path__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(7),path__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);let tsNodeAvailable;const defaultPoolSize=Object(os__WEBPACK_IMPORTED_MODULE_2__.cpus)().length;function detectTsNode(){if("function"==typeof require)return!1;if(tsNodeAvailable)return tsNodeAvailable;try{!function(){var e=new Error("Cannot find module 'ts-node'");throw e.code="MODULE_NOT_FOUND",e}(),tsNodeAvailable=!0}catch(e){if(!e||"MODULE_NOT_FOUND"!==e.code)throw e;tsNodeAvailable=!1}return tsNodeAvailable}function createTsNodeModule(e){return`\n    require("ts-node/register/transpile-only");\n    require(${JSON.stringify(e)});\n  `}function rebaseScriptPath(e,t){const r=callsites__WEBPACK_IMPORTED_MODULE_0___default()().find(e=>{const r=e.getFileName();return Boolean(r&&!r.match(t)&&!r.match(/[\/\\]master[\/\\]implementation/))}),i=r?r.getFileName():null;return i?path__WEBPACK_IMPORTED_MODULE_3__.join(path__WEBPACK_IMPORTED_MODULE_3__.dirname(i),e):e}function resolveScriptPath(scriptPath){const workerFilePath="function"==typeof require?require.resolve(path__WEBPACK_IMPORTED_MODULE_3__.join(eval("__dirname"),scriptPath)):__webpack_require__(59).resolve(rebaseScriptPath(scriptPath,/[\/\\]worker_threads[\/\\]/));return workerFilePath}function initWorkerThreadsWorker(){const NativeWorker="function"==typeof require?require("worker_threads").Worker:eval("require")("worker_threads").Worker;let allWorkers=[];class Worker extends NativeWorker{constructor(e,t){const r=resolveScriptPath(e);r.match(/\.tsx?$/i)&&detectTsNode()?super(createTsNodeModule(r),{eval:!0}):super(r,t),this.mappedEventListeners=new WeakMap,allWorkers.push(this)}addEventListener(e,t){const r=e=>{t({data:e})};this.mappedEventListeners.set(t,r),this.on(e,r)}removeEventListener(e,t){const r=this.mappedEventListeners.get(t)||t;this.off(e,r)}}const terminateWorkersAndMaster=()=>{Promise.all(allWorkers.map(e=>e.terminate())).then(()=>process.exit(0),()=>process.exit(1)),allWorkers=[]};return process.on("SIGINT",()=>terminateWorkersAndMaster()),process.on("SIGTERM",()=>terminateWorkersAndMaster()),Worker}function initTinyWorker(){const e=__webpack_require__(60);let t=[];const r=()=>{Promise.all(t.map(e=>e.terminate())).then(()=>process.exit(0),()=>process.exit(1)),t=[]};return process.on("SIGINT",()=>r()),process.on("SIGTERM",()=>r()),class extends e{constructor(e){const r="win32"===process.platform?`file:///${resolveScriptPath(e).replace(/\\/g,"/")}`:resolveScriptPath(e);r.match(/\.tsx?$/i)&&detectTsNode()?super(new Function(createTsNodeModule(resolveScriptPath(e))),[],{esm:!0}):super(r,[],{esm:!0}),t.push(this),this.emitter=new events__WEBPACK_IMPORTED_MODULE_1___default.a,this.onerror=e=>this.emitter.emit("error",e),this.onmessage=e=>this.emitter.emit("message",e)}addEventListener(e,t){this.emitter.addListener(e,t)}removeEventListener(e,t){this.emitter.removeListener(e,t)}terminate(){return t=t.filter(e=>e!==this),super.terminate()}}}function selectWorkerImplementation(){try{return initWorkerThreadsWorker()}catch(e){return console.debug("Node worker_threads not available. Trying to fall back to tiny-worker polyfill..."),initTinyWorker()}}},function(e,t,r){"use strict";const i=()=>{const e=Error.prepareStackTrace;Error.prepareStackTrace=(e,t)=>t;const t=(new Error).stack.slice(1);return Error.prepareStackTrace=e,t};e.exports=i,e.exports.default=i},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var i=r(0);function n(e){return e&&"object"==typeof e&&e[i.d]}},function(e,t){e.exports=require("https")},function(e,t){e.exports=require("url")},function(e,t,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),o=u(r(35)),s=u(r(37)),a=u(r(39)),l=r(18),c=r(69),f=u(r(68));function u(e){return e&&e.__esModule?e:{default:e}}function h(e,t){var r=t.left,i=t.top,n=t.right,o=t.bottom,s=t.width,a=t.height;return e.readRasters({window:[r,i,n,o],width:s,height:a,resampleMethod:"bilinear"}).then((function(e){return e.map((function(e){return(0,l.unflatten)(e,{height:a,width:s})}))}))}var d=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n&&console.log("starting GeoRaster.constructor with",t,r),this._web_worker_is_available="undefined"!=typeof window&&"undefined"!==window.Worker,this._blob_is_available="undefined"!=typeof Blob,this._url_is_available="undefined"!=typeof URL,"object"===(void 0===t?"undefined":i(t))&&t.constructor&&"Buffer"===t.constructor.name&&!1===Buffer.isBuffer(t)&&(t=new Buffer(t)),"string"==typeof t?(n&&console.log("data is a url"),this._data=t,this._url=t,this.rasterType="geotiff",this.sourceType="url"):"undefined"!=typeof Buffer&&Buffer.isBuffer(t)?(n&&console.log("data is a buffer"),this._data=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength),this.rasterType="geotiff",this.sourceType="Buffer"):t instanceof ArrayBuffer?(this._data=t,this.rasterType="geotiff",this.sourceType="ArrayBuffer"):Array.isArray(t)&&r&&(this._data=t,this.rasterType="object",this._metadata=r),n&&console.log("this after construction:",this)}return n(e,[{key:"preinitialize",value:function(e){var t=this;if(e&&console.log("starting preinitialize"),this._url){var r=this._url+".ovr";return function(e){try{return(0,o.default)(e,{method:"HEAD"}).then((function(e){return 200===e.status})).catch((function(e){return!1}))}catch(e){return Promise.resolve(!1)}}(r).then((function(i){return e&&console.log("overview exists:",i),i?(0,c.fromUrls)(t._url,[r],{cache:!0,forceXHR:!1}):(0,c.fromUrl)(t._url,{cache:!0,forceXHR:!1})}))}return Promise.resolve()}},{key:"initialize",value:function(e){var t=this;return this.preinitialize(e).then((function(r){return new Promise((function(i,n){if(e&&console.log("starting GeoRaster.initialize"),e&&console.log("this",t),"object"===t.rasterType||"geotiff"===t.rasterType||"tiff"===t.rasterType)if(t._web_worker_is_available){var o=new s.default;o.onmessage=function(n){e&&console.log("main thread received message:",n);var o=n.data;for(var s in o)t[s]=o[s];t._url&&(t._geotiff=r,t.getValues=function(e){return h(this._geotiff,e)}),t.toCanvas=function(e){return(0,f.default)(this,e)},i(t)},e&&console.log("about to postMessage"),t._data instanceof ArrayBuffer?o.postMessage({data:t._data,rasterType:t.rasterType,sourceType:t.sourceType,metadata:t._metadata},[t._data]):o.postMessage({data:t._data,rasterType:t.rasterType,sourceType:t.sourceType,metadata:t._metadata})}else e&&console.log("web worker is not available"),(0,a.default)({data:t._data,rasterType:t.rasterType,sourceType:t.sourceType,metadata:t._metadata},e).then((function(n){e&&console.log("result:",n),t._url&&(n._geotiff=r,n.getValues=function(e){return h(this._geotiff,e)}),n.toCanvas=function(e){return(0,f.default)(this,e)},i(n)})).catch(n);else n("couldn't find a way to parse")}))}))}}]),e}(),p=function(e,t,r){if(r&&console.log("starting parseGeoraster with ",e,t),void 0===e){throw Error("[Georaster.parseGeoraster] Error. You passed in undefined to parseGeoraster. We can't make a raster out of nothing!")}return new d(e,t,r).initialize(r)};void 0!==e.exports&&(e.exports=p),"undefined"!=typeof window?window.parseGeoraster=p:"undefined"!=typeof self&&(self.parseGeoraster=p)},function(e,t,r){var i=r(36),n=i.default||i,o=function(e,t){return/^\/\//.test(e)&&(e="https:"+e),n.call(this,e,t)};e.exports=t=o,t.fetch=o,t.Headers=i.Headers,t.Request=i.Request,t.Response=i.Response,t.default=o},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__36__},function(e,t,r){"use strict";e.exports=function(){return r(38)('!function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],i=!0,n=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(e){n=!0,o=e}finally{try{!i&&a.return&&a.return()}finally{if(n)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function(e,t){return new Promise((function(r,l){try{t&&console.log("starting parseData with",e),t&&console.log("\\tGeoTIFF:","undefined"==typeof GeoTIFF?"undefined":n(GeoTIFF));var c={},f=void 0,u=void 0;if("object"===e.rasterType)c.values=e.data,c.height=f=e.metadata.height||c.values[0].length,c.width=u=e.metadata.width||c.values[0][0].length,c.pixelHeight=e.metadata.pixelHeight,c.pixelWidth=e.metadata.pixelWidth,c.projection=e.metadata.projection,c.xmin=e.metadata.xmin,c.ymax=e.metadata.ymax,c.noDataValue=e.metadata.noDataValue,c.numberOfRasters=c.values.length,c.xmax=c.xmin+c.width*c.pixelWidth,c.ymin=c.ymax-c.height*c.pixelHeight,c._data=null,r(a(c));else if("geotiff"===e.rasterType){c._data=e.data;var h=o.fromArrayBuffer;"url"===e.sourceType&&(h=o.fromUrl),t&&console.log("data.rasterType is geotiff"),r(h(e.data).then((function(r){return t&&console.log("geotiff:",r),r.getImage().then((function(r){t&&console.log("image:",r);var n=r.fileDirectory,o=r.getGeoKeys(),l=o.GeographicTypeGeoKey,h=o.ProjectedCSTypeGeoKey;c.projection=l||h,t&&console.log("projection:",c.projection),c.height=f=r.getHeight(),t&&console.log("result.height:",c.height),c.width=u=r.getWidth(),t&&console.log("result.width:",c.width);var d=r.getResolution(),p=i(d,2),g=p[0],y=p[1];c.pixelHeight=Math.abs(y),c.pixelWidth=Math.abs(g);var m=r.getOrigin(),w=i(m,2),b=w[0],T=w[1];return c.xmin=b,c.xmax=c.xmin+u*c.pixelWidth,c.ymax=T,c.ymin=c.ymax-f*c.pixelHeight,c.noDataValue=n.GDAL_NODATA?parseFloat(n.GDAL_NODATA):null,c.numberOfRasters=n.SamplesPerPixel,"url"!==e.sourceType?r.readRasters().then((function(e){return c.values=e.map((function(e){return(0,s.unflatten)(e,{height:f,width:u})})),a(c)})):c}))})))}}catch(e){l(e),console.error("[georaster] error parsing georaster:",e)}}))};var o=r(2),s=r(4);function a(e,t){var r=e.noDataValue,i=e.height,n=e.width;return new Promise((function(o,s){e.maxs=[],e.mins=[],e.ranges=[];for(var a=void 0,l=void 0,c=0;c<e.numberOfRasters;c++){var f=e.values[c];t&&console.log("[georaster] rows:",f);for(var u=0;u<i;u++)for(var h=f[u],d=0;d<n;d++){var p=h[d];p==r||isNaN(p)||(void 0===l||p<l?l=p:(void 0===a||p>a)&&(a=p))}e.maxs.push(a),e.mins.push(l),e.ranges.push(a-l)}o(e)}))}},function(e,t,r){"use strict";r.r(t);var i=r(0),n=r.n(i);self;onmessage=e=>{const t=e.data;n()(t).then(e=>{e._data instanceof ArrayBuffer?postMessage(e,[e._data]):postMessage(e),close()})}},function(e,t,r){parcelRequire=function(t,i,n,o){var s,a="function"==typeof parcelRequire&&parcelRequire;function l(e,n){if(!i[e]){if(!t[e]){var o="function"==typeof parcelRequire&&parcelRequire;if(!n&&o)return o(e,!0);if(a)return a(e,!0);if("string"==typeof e)return r(3)(e);var s=new Error("Cannot find module \'"+e+"\'");throw s.code="MODULE_NOT_FOUND",s}f.resolve=function(r){return t[e][1][r]||r},f.cache={};var c=i[e]=new l.Module(e);t[e][0].call(c.exports,f,c,c.exports,this)}return i[e].exports;function f(e){return l(f.resolve(e))}}l.isParcelRequire=!0,l.Module=function(e){this.id=e,this.bundle=l,this.exports={}},l.modules=t,l.cache=i,l.parent=a,l.register=function(e,r){t[e]=[function(e,t){t.exports=r},{}]};for(var c=0;c<n.length;c++)try{l(n[c])}catch(t){s||(s=t)}if(n.length){var f=l(n[n.length-1]);e.exports=f}if(parcelRequire=l,s)throw s;return l}({j27V:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.geoKeys=r.geoKeyNames=r.ExtraSamplesValues=r.photometricInterpretations=r.fieldTypes=r.fieldTypeNames=r.arrayFields=r.fieldTagTypes=r.fieldTags=r.fieldTagNames=void 0;const i={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams"};r.fieldTagNames=i;const n={};r.fieldTags=n;for(const e in i)i.hasOwnProperty(e)&&(n[i[e]]=parseInt(e,10));r.fieldTagTypes={256:"SHORT",257:"SHORT",258:"SHORT",259:"SHORT",262:"SHORT",273:"LONG",274:"SHORT",277:"SHORT",278:"LONG",279:"LONG",282:"RATIONAL",283:"RATIONAL",284:"SHORT",286:"SHORT",287:"RATIONAL",296:"SHORT",305:"ASCII",306:"ASCII",338:"SHORT",339:"SHORT",513:"LONG",514:"LONG",1024:"SHORT",1025:"SHORT",2048:"SHORT",2049:"ASCII",33550:"DOUBLE",33922:"DOUBLE",34665:"LONG",34735:"SHORT",34737:"ASCII",42113:"ASCII"};const o=[n.BitsPerSample,n.ExtraSamples,n.SampleFormat,n.StripByteCounts,n.StripOffsets,n.StripRowCounts,n.TileByteCounts,n.TileOffsets];r.arrayFields=o;const s={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"};r.fieldTypeNames=s;const a={};r.fieldTypes=a;for(const e in s)s.hasOwnProperty(e)&&(a[s[e]]=parseInt(e,10));r.photometricInterpretations={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9};r.ExtraSamplesValues={Unspecified:0,Assocalpha:1,Unassalpha:2};const l={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"};r.geoKeyNames=l;const c={};r.geoKeys=c;for(const e in l)l.hasOwnProperty(e)&&(c[l[e]]=parseInt(e,10))},{}],fpBl:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fromWhiteIsZero=function(e,t){const{width:r,height:i}=e,n=new Uint8Array(r*i*3);let o;for(let r=0,i=0;r<e.length;++r,i+=3)o=256-e[r]/t*256,n[i]=o,n[i+1]=o,n[i+2]=o;return n},r.fromBlackIsZero=function(e,t){const{width:r,height:i}=e,n=new Uint8Array(r*i*3);let o;for(let r=0,i=0;r<e.length;++r,i+=3)o=e[r]/t*256,n[i]=o,n[i+1]=o,n[i+2]=o;return n},r.fromPalette=function(e,t){const{width:r,height:i}=e,n=new Uint8Array(r*i*3),o=t.length/3,s=t.length/3*2;for(let r=0,i=0;r<e.length;++r,i+=3){const a=e[r];n[i]=t[a]/65536*256,n[i+1]=t[a+o]/65536*256,n[i+2]=t[a+s]/65536*256}return n},r.fromCMYK=function(e){const{width:t,height:r}=e,i=new Uint8Array(t*r*3);for(let t=0,r=0;t<e.length;t+=4,r+=3){const n=e[t],o=e[t+1],s=e[t+2],a=e[t+3];i[r]=(255-n)/256*255*((255-a)/256),i[r+1]=(255-o)/256*255*((255-a)/256),i[r+2]=(255-s)/256*255*((255-a)/256)}return i},r.fromYCbCr=function(e){const{width:t,height:r}=e,i=new Uint8ClampedArray(t*r*3);for(let t=0,r=0;t<e.length;t+=3,r+=3){const n=e[t],o=e[t+1],s=e[t+2];i[r]=n+1.402*(s-128),i[r+1]=n-.34414*(o-128)-.71414*(s-128),i[r+2]=n+1.772*(o-128)}return i},r.fromCIELab=function(e){const{width:t,height:r}=e,i=new Uint8Array(t*r*3);for(let t=0,r=0;t<e.length;t+=3,r+=3){let n,o,s,a=(e[t+0]+16)/116,l=(e[t+1]<<24>>24)/500+a,c=a-(e[t+2]<<24>>24)/200;n=(n=3.2406*(l=.95047*(l*l*l>.008856?l*l*l:(l-16/116)/7.787))+-1.5372*(a=1*(a*a*a>.008856?a*a*a:(a-16/116)/7.787))+-.4986*(c=1.08883*(c*c*c>.008856?c*c*c:(c-16/116)/7.787)))>.0031308?1.055*n**(1/2.4)-.055:12.92*n,o=(o=-.9689*l+1.8758*a+.0415*c)>.0031308?1.055*o**(1/2.4)-.055:12.92*o,s=(s=.0557*l+-.204*a+1.057*c)>.0031308?1.055*s**(1/2.4)-.055:12.92*s,i[r]=255*Math.max(0,Math.min(1,n)),i[r+1]=255*Math.max(0,Math.min(1,o)),i[r+2]=255*Math.max(0,Math.min(1,s))}return i}},{}],IKSA:[function(e,t,r){"use strict";function i(e,t){let r=e.length-t,i=0;do{for(let r=t;r>0;r--)e[i+t]+=e[i],i++;r-=t}while(r>0)}function n(e,t,r){let i=0,n=e.length;const o=n/r;for(;n>t;){for(let r=t;r>0;--r)e[i+t]+=e[i],++i;n-=t}const s=e.slice();for(let t=0;t<o;++t)for(let i=0;i<r;++i)e[r*t+i]=s[(r-i-1)*o+t]}Object.defineProperty(r,"__esModule",{value:!0}),r.applyPredictor=function(e,t,r,o,s,a){if(!t||1===t)return e;for(let e=0;e<s.length;++e){if(s[e]%8!=0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(s[e]!==s[0])throw new Error("When decoding with predictor, all samples must have the same size.")}const l=s[0]/8,c=2===a?1:s.length;for(let a=0;a<o&&!(a*c*r*l>=e.byteLength);++a){let o;if(2===t){switch(s[0]){case 8:o=new Uint8Array(e,a*c*r*l,c*r*l);break;case 16:o=new Uint16Array(e,a*c*r*l,c*r*l/2);break;case 32:o=new Uint32Array(e,a*c*r*l,c*r*l/4);break;default:throw new Error(`Predictor 2 not allowed with ${s[0]} bits per sample.`)}i(o,c)}else 3===t&&n(o=new Uint8Array(e,a*c*r*l,c*r*l),c,l)}return e}},{}],FJDe:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("../predictor");r.default=class{decode(e,t){const r=this.decodeBlock(t),n=e.Predictor||1;if(1!==n){const t=!e.StripOffsets,o=t?e.TileWidth:e.ImageWidth,s=t?e.TileLength:e.RowsPerStrip||e.ImageLength;return(0,i.applyPredictor)(r,n,o,s,e.BitsPerSample,e.PlanarConfiguration)}return r}}},{"../predictor":"IKSA"}],V9bQ:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));class n extends i.default{decodeBlock(e){return e}}r.default=n},{"./basedecoder":"FJDe"}],tcId:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));function n(e,t){for(let r=t.length-1;r>=0;r--)e.push(t[r]);return e}function o(e){const t=new Uint16Array(4093),r=new Uint8Array(4093);for(let e=0;e<=257;e++)t[e]=4096,r[e]=e;let i=258,o=9,s=0;function a(){i=258,o=9}function l(e){const t=function(e,t,r){const i=t%8,n=Math.floor(t/8),o=8-i,s=t+r-8*(n+1);let a=8*(n+2)-(t+r);const l=8*(n+2)-t;if(a=Math.max(0,a),n>=e.length)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),257;let c=e[n]&2**(8-i)-1,f=c<<=r-o;if(n+1<e.length){let t=e[n+1]>>>a;f+=t<<=Math.max(0,r-l)}if(s>8&&n+2<e.length){const i=8*(n+3)-(t+r);f+=e[n+2]>>>i}return f}(e,s,o);return s+=o,t}function c(e,n){return r[i]=n,t[i]=e,++i-1}function f(e){const i=[];for(let n=e;4096!==n;n=t[n])i.push(r[n]);return i}const u=[];a();const h=new Uint8Array(e);let d,p=l(h);for(;257!==p;){if(256===p){for(a(),p=l(h);256===p;)p=l(h);if(257===p)break;if(p>256)throw new Error(`corrupted code at scanline ${p}`);n(u,f(p)),d=p}else if(p<i){const e=f(p);n(u,e),c(d,e[e.length-1]),d=p}else{const e=f(d);if(!e)throw new Error(`Bogus entry. Not in dictionary, ${d} / ${i}, position: ${s}`);n(u,e),u.push(e[e.length-1]),c(d,e[e.length-1]),d=p}i+1>=2**o&&(12===o?d=void 0:o++),p=l(h)}return new Uint8Array(u)}class s extends i.default{decodeBlock(e){return o(e).buffer}}r.default=s},{"./basedecoder":"FJDe"}],J7kk:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));const n=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),o=4017,s=799,a=3406,l=2276,c=1567,f=3784,u=5793,h=2896;function d(e,t){let r=0;const i=[];let n=16;for(;n>0&&!e[n-1];)--n;i.push({children:[],index:0});let o,s=i[0];for(let a=0;a<n;a++){for(let n=0;n<e[a];n++){for((s=i.pop()).children[s.index]=t[r];s.index>0;)s=i.pop();for(s.index++,i.push(s);i.length<=a;)i.push(o={children:[],index:0}),s.children[s.index]=o.children,s=o;r++}a+1<n&&(i.push(o={children:[],index:0}),s.children[s.index]=o.children,s=o)}return i[0].children}function p(e,t,r,i,o,s,a,l,c){const{mcusPerLine:f,progressive:u}=r,h=t;let d=t,p=0,g=0;function y(){if(g>0)return p>>--g&1;if(255===(p=e[d++])){const t=e[d++];if(t)throw new Error(`unexpected marker: ${(p<<8|t).toString(16)}`)}return g=7,p>>>7}function m(e){let t,r=e;for(;null!==(t=y());){if("number"==typeof(r=r[t]))return r;if("object"!=typeof r)throw new Error("invalid huffman sequence")}return null}function w(e){let t=e,r=0;for(;t>0;){const e=y();if(null===e)return;r=r<<1|e,--t}return r}function b(e){const t=w(e);return t>=1<<e-1?t:t+(-1<<e)+1}let T,P=0,S=0;function I(e,t,r,i,n){const o=r%f,s=(r/f|0)*e.v+i,a=o*e.h+n;t(e,e.blocks[s][a])}function D(e,t,r){const i=r/e.blocksPerLine|0,n=r%e.blocksPerLine;t(e,e.blocks[i][n])}const A=i.length;let O,v,M,G,E,C;C=u?0===s?0===l?function(e,t){const r=m(e.huffmanTableDC),i=0===r?0:b(r)<<c;e.pred+=i,t[0]=e.pred}:function(e,t){t[0]|=y()<<c}:0===l?function(e,t){if(P>0)return void P--;let r=s;const i=a;for(;r<=i;){const i=m(e.huffmanTableAC),o=15&i,s=i>>4;if(0===o){if(s<15){P=w(s)+(1<<s)-1;break}r+=16}else t[n[r+=s]]=b(o)*(1<<c),r++}}:function(e,t){let r=s;const i=a;let o=0;for(;r<=i;){const i=n[r],s=t[i]<0?-1:1;switch(S){case 0:{const t=m(e.huffmanTableAC),r=15&t;if(o=t>>4,0===r)o<15?(P=w(o)+(1<<o),S=4):(o=16,S=1);else{if(1!==r)throw new Error("invalid ACn encoding");T=b(r),S=o?2:3}continue}case 1:case 2:t[i]?t[i]+=(y()<<c)*s:0==--o&&(S=2===S?3:0);break;case 3:t[i]?t[i]+=(y()<<c)*s:(t[i]=T<<c,S=0);break;case 4:t[i]&&(t[i]+=(y()<<c)*s)}r++}4===S&&0==--P&&(S=0)}:function(e,t){const r=m(e.huffmanTableDC),i=0===r?0:b(r);e.pred+=i,t[0]=e.pred;let o=1;for(;o<64;){const r=m(e.huffmanTableAC),i=15&r,s=r>>4;if(0===i){if(s<15)break;o+=16}else t[n[o+=s]]=b(i),o++}};let k,F,_=0;F=1===A?i[0].blocksPerLine*i[0].blocksPerColumn:f*r.mcusPerColumn;const U=o||F;for(;_<F;){for(v=0;v<A;v++)i[v].pred=0;if(P=0,1===A)for(O=i[0],E=0;E<U;E++)D(O,C,_),_++;else for(E=0;E<U;E++){for(v=0;v<A;v++){O=i[v];const{h:e,v:t}=O;for(M=0;M<t;M++)for(G=0;G<e;G++)I(O,C,_,M,G)}if(++_===F)break}if(g=0,(k=e[d]<<8|e[d+1])<65280)throw new Error("marker was not found");if(!(k>=65488&&k<=65495))break;d+=2}return d-h}function g(e,t){const r=[],{blocksPerLine:i,blocksPerColumn:n}=t,d=i<<3,p=new Int32Array(64),g=new Uint8Array(64);function y(e,r,i){const n=t.quantizationTable;let d,p,g,y,m,w,b,T,P;const S=i;let I;for(I=0;I<64;I++)S[I]=e[I]*n[I];for(I=0;I<8;++I){const e=8*I;0!==S[1+e]||0!==S[2+e]||0!==S[3+e]||0!==S[4+e]||0!==S[5+e]||0!==S[6+e]||0!==S[7+e]?(d=u*S[0+e]+128>>8,p=u*S[4+e]+128>>8,g=S[2+e],y=S[6+e],m=h*(S[1+e]-S[7+e])+128>>8,T=h*(S[1+e]+S[7+e])+128>>8,w=S[3+e]<<4,b=S[5+e]<<4,P=d-p+1>>1,d=d+p+1>>1,p=P,P=g*f+y*c+128>>8,g=g*c-y*f+128>>8,y=P,P=m-b+1>>1,m=m+b+1>>1,b=P,P=T+w+1>>1,w=T-w+1>>1,T=P,P=d-y+1>>1,d=d+y+1>>1,y=P,P=p-g+1>>1,p=p+g+1>>1,g=P,P=m*l+T*a+2048>>12,m=m*a-T*l+2048>>12,T=P,P=w*s+b*o+2048>>12,w=w*o-b*s+2048>>12,b=P,S[0+e]=d+T,S[7+e]=d-T,S[1+e]=p+b,S[6+e]=p-b,S[2+e]=g+w,S[5+e]=g-w,S[3+e]=y+m,S[4+e]=y-m):(P=u*S[0+e]+512>>10,S[0+e]=P,S[1+e]=P,S[2+e]=P,S[3+e]=P,S[4+e]=P,S[5+e]=P,S[6+e]=P,S[7+e]=P)}for(I=0;I<8;++I){const e=I;0!==S[8+e]||0!==S[16+e]||0!==S[24+e]||0!==S[32+e]||0!==S[40+e]||0!==S[48+e]||0!==S[56+e]?(d=u*S[0+e]+2048>>12,p=u*S[32+e]+2048>>12,g=S[16+e],y=S[48+e],m=h*(S[8+e]-S[56+e])+2048>>12,T=h*(S[8+e]+S[56+e])+2048>>12,w=S[24+e],b=S[40+e],P=d-p+1>>1,d=d+p+1>>1,p=P,P=g*f+y*c+2048>>12,g=g*c-y*f+2048>>12,y=P,P=m-b+1>>1,m=m+b+1>>1,b=P,P=T+w+1>>1,w=T-w+1>>1,T=P,P=d-y+1>>1,d=d+y+1>>1,y=P,P=p-g+1>>1,p=p+g+1>>1,g=P,P=m*l+T*a+2048>>12,m=m*a-T*l+2048>>12,T=P,P=w*s+b*o+2048>>12,w=w*o-b*s+2048>>12,b=P,S[0+e]=d+T,S[56+e]=d-T,S[8+e]=p+b,S[48+e]=p-b,S[16+e]=g+w,S[40+e]=g-w,S[24+e]=y+m,S[32+e]=y-m):(P=u*i[I+0]+8192>>14,S[0+e]=P,S[8+e]=P,S[16+e]=P,S[24+e]=P,S[32+e]=P,S[40+e]=P,S[48+e]=P,S[56+e]=P)}for(I=0;I<64;++I){const e=128+(S[I]+8>>4);r[I]=e<0?0:e>255?255:e}}for(let e=0;e<n;e++){const n=e<<3;for(let e=0;e<8;e++)r.push(new Uint8Array(d));for(let o=0;o<i;o++){y(t.blocks[e][o],g,p);let i=0;const s=o<<3;for(let e=0;e<8;e++){const t=r[n+e];for(let e=0;e<8;e++)t[s+e]=g[i++]}}}return r}class y{constructor(){this.jfif=null,this.adobe=null,this.quantizationTables=[],this.huffmanTablesAC=[],this.huffmanTablesDC=[],this.resetFrames()}resetFrames(){this.frames=[]}parse(e){let t=0;function r(){const r=e[t]<<8|e[t+1];return t+=2,r}function i(){const i=r(),n=e.subarray(t,t+i-2);return t+=n.length,n}function o(e){let t,r,i=0,n=0;for(r in e.components)e.components.hasOwnProperty(r)&&(i<(t=e.components[r]).h&&(i=t.h),n<t.v&&(n=t.v));const o=Math.ceil(e.samplesPerLine/8/i),s=Math.ceil(e.scanLines/8/n);for(r in e.components)if(e.components.hasOwnProperty(r)){t=e.components[r];const a=Math.ceil(Math.ceil(e.samplesPerLine/8)*t.h/i),l=Math.ceil(Math.ceil(e.scanLines/8)*t.v/n),c=o*t.h,f=s*t.v,u=[];for(let e=0;e<f;e++){const e=[];for(let t=0;t<c;t++)e.push(new Int32Array(64));u.push(e)}t.blocksPerLine=a,t.blocksPerColumn=l,t.blocks=u}e.maxH=i,e.maxV=n,e.mcusPerLine=o,e.mcusPerColumn=s}let s=r();if(65496!==s)throw new Error("SOI not found");for(s=r();65497!==s;){switch(s){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:{const e=i();65504===s&&74===e[0]&&70===e[1]&&73===e[2]&&70===e[3]&&0===e[4]&&(this.jfif={version:{major:e[5],minor:e[6]},densityUnits:e[7],xDensity:e[8]<<8|e[9],yDensity:e[10]<<8|e[11],thumbWidth:e[12],thumbHeight:e[13],thumbData:e.subarray(14,14+3*e[12]*e[13])}),65518===s&&65===e[0]&&100===e[1]&&111===e[2]&&98===e[3]&&101===e[4]&&0===e[5]&&(this.adobe={version:e[6],flags0:e[7]<<8|e[8],flags1:e[9]<<8|e[10],transformCode:e[11]});break}case 65499:{const i=r()+t-2;for(;t<i;){const i=e[t++],o=new Int32Array(64);if(i>>4==0)for(let r=0;r<64;r++)o[n[r]]=e[t++];else{if(i>>4!=1)throw new Error("DQT: invalid table spec");for(let e=0;e<64;e++)o[n[e]]=r()}this.quantizationTables[15&i]=o}break}case 65472:case 65473:case 65474:{r();const i={extended:65473===s,progressive:65474===s,precision:e[t++],scanLines:r(),samplesPerLine:r(),components:{},componentsOrder:[]},n=e[t++];let a;for(let r=0;r<n;r++){a=e[t];const r=e[t+1]>>4,n=15&e[t+1],o=e[t+2];i.componentsOrder.push(a),i.components[a]={h:r,v:n,quantizationIdx:o},t+=3}o(i),this.frames.push(i);break}case 65476:{const i=r();for(let r=2;r<i;){const i=e[t++],n=new Uint8Array(16);let o=0;for(let r=0;r<16;r++,t++)n[r]=e[t],o+=n[r];const s=new Uint8Array(o);for(let r=0;r<o;r++,t++)s[r]=e[t];r+=17+o,i>>4==0?this.huffmanTablesDC[15&i]=d(n,s):this.huffmanTablesAC[15&i]=d(n,s)}break}case 65501:r(),this.resetInterval=r();break;case 65498:{r();const i=e[t++],n=[],o=this.frames[0];for(let r=0;r<i;r++){const r=o.components[e[t++]],i=e[t++];r.huffmanTableDC=this.huffmanTablesDC[i>>4],r.huffmanTableAC=this.huffmanTablesAC[15&i],n.push(r)}const s=e[t++],a=e[t++],l=e[t++],c=p(e,t,o,n,this.resetInterval,s,a,l>>4,15&l);t+=c;break}case 65535:255!==e[t]&&t--;break;default:if(255===e[t-3]&&e[t-2]>=192&&e[t-2]<=254){t-=3;break}throw new Error(`unknown JPEG marker ${s.toString(16)}`)}s=r()}}getResult(){const{frames:e}=this;if(0===this.frames.length)throw new Error("no frames were decoded");this.frames.length>1&&console.warn("more than one frame is not supported");for(let e=0;e<this.frames.length;e++){const t=this.frames[e].components;for(const e of Object.keys(t))t[e].quantizationTable=this.quantizationTables[t[e].quantizationIdx],delete t[e].quantizationIdx}const t=e[0],{components:r,componentsOrder:i}=t,n=[],o=t.samplesPerLine,s=t.scanLines;for(let e=0;e<i.length;e++){const o=r[i[e]];n.push({lines:g(0,o),scaleX:o.h/t.maxH,scaleY:o.v/t.maxV})}const a=new Uint8Array(o*s*n.length);let l=0;for(let e=0;e<s;++e)for(let t=0;t<o;++t)for(let r=0;r<n.length;++r){const i=n[r];a[l]=i.lines[0|e*i.scaleY][0|t*i.scaleX],++l}return a}}class m extends i.default{constructor(e){super(),this.reader=new y,e.JPEGTables&&this.reader.parse(e.JPEGTables)}decodeBlock(e){return this.reader.resetFrames(),this.reader.parse(new Uint8Array(e)),this.reader.getResult().buffer}}r.default=m},{"./basedecoder":"FJDe"}],JAiC:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("pako/lib/inflate"),n=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));class o extends n.default{decodeBlock(e){return(0,i.inflate)(new Uint8Array(e)).buffer}}r.default=o},{"./basedecoder":"FJDe"}],OcPz:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));class n extends i.default{decodeBlock(e){const t=new DataView(e),r=[];for(let i=0;i<e.byteLength;++i){let e=t.getInt8(i);if(e<0){const n=t.getUint8(i+1);e=-e;for(let t=0;t<=e;++t)r.push(n);i+=1}else{for(let n=0;n<=e;++n)r.push(t.getUint8(i+n+1));i+=e+1}}return new Uint8Array(r).buffer}}r.default=n},{"./basedecoder":"FJDe"}],FGCZ:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getDecoder=function(e){switch(e.Compression){case void 0:case 1:return new i.default;case 5:return new n.default;case 6:throw new Error("old style JPEG compression is not supported.");case 7:return new o.default(e);case 8:case 32946:return new s.default;case 32773:return new a.default;default:throw new Error(`Unknown compression method identifier: ${e.Compression}`)}};var i=l(e("./raw")),n=l(e("./lzw")),o=l(e("./jpeg")),s=l(e("./deflate")),a=l(e("./packbits"));function l(e){return e&&e.__esModule?e:{default:e}}},{"./raw":"V9bQ","./lzw":"tcId","./jpeg":"J7kk","./deflate":"JAiC","./packbits":"OcPz"}],OQju:[function(e,t,r){"use strict";function i(e,t,r,i=1){return new(Object.getPrototypeOf(e).constructor)(t*r*i)}function n(e,t,r,n,o){const s=t/n,a=r/o;return e.map(e=>{const l=i(e,n,o);for(let i=0;i<o;++i){const o=Math.min(Math.round(a*i),r-1);for(let r=0;r<n;++r){const a=Math.min(Math.round(s*r),t-1),c=e[o*t+a];l[i*n+r]=c}}return l})}function o(e,t,r){return(1-r)*e+r*t}function s(e,t,r,n,s){const a=t/n,l=r/s;return e.map(e=>{const c=i(e,n,s);for(let i=0;i<s;++i){const s=l*i,f=Math.floor(s),u=Math.min(Math.ceil(s),r-1);for(let r=0;r<n;++r){const l=a*r,h=l%1,d=Math.floor(l),p=Math.min(Math.ceil(l),t-1),g=e[f*t+d],y=e[f*t+p],m=e[u*t+d],w=e[u*t+p],b=o(o(g,y,h),o(m,w,h),s%1);c[i*n+r]=b}}return c})}function a(e,t,r,n,o,s){const a=t/n,l=r/o,c=i(e,n,o,s);for(let i=0;i<o;++i){const o=Math.min(Math.round(l*i),r-1);for(let r=0;r<n;++r){const l=Math.min(Math.round(a*r),t-1);for(let a=0;a<s;++a){const f=e[o*t*s+l*s+a];c[i*n*s+r*s+a]=f}}}return c}function l(e,t,r,n,s,a){const l=t/n,c=r/s,f=i(e,n,s,a);for(let i=0;i<s;++i){const s=c*i,u=Math.floor(s),h=Math.min(Math.ceil(s),r-1);for(let r=0;r<n;++r){const c=l*r,d=c%1,p=Math.floor(c),g=Math.min(Math.ceil(c),t-1);for(let l=0;l<a;++l){const c=e[u*t*a+p*a+l],y=e[u*t*a+g*a+l],m=e[h*t*a+p*a+l],w=e[h*t*a+g*a+l],b=o(o(c,y,d),o(m,w,d),s%1);f[i*n*a+r*a+l]=b}}}return f}Object.defineProperty(r,"__esModule",{value:!0}),r.resampleNearest=n,r.resampleBilinear=s,r.resample=function(e,t,r,i,o,a="nearest"){switch(a.toLowerCase()){case"nearest":return n(e,t,r,i,o);case"bilinear":case"linear":return s(e,t,r,i,o);default:throw new Error(`Unsupported resampling method: \'${a}\'`)}},r.resampleNearestInterleaved=a,r.resampleBilinearInterleaved=l,r.resampleInterleaved=function(e,t,r,i,n,o,s="nearest"){switch(s.toLowerCase()){case"nearest":return a(e,t,r,i,n,o);case"bilinear":case"linear":return l(e,t,r,i,n,o);default:throw new Error(`Unsupported resampling method: \'${s}\'`)}}},{}],eOWo:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("txml")),n=e("./globals"),o=e("./rgb"),s=e("./compression"),a=e("./resample");function l(e,t,r){let i=0;for(let n=t;n<r;++n)i+=e[n];return i}function c(e,t,r){switch(e){case 1:switch(t){case 8:return new Uint8Array(r);case 16:return new Uint16Array(r);case 32:return new Uint32Array(r)}break;case 2:switch(t){case 8:return new Int8Array(r);case 16:return new Int16Array(r);case 32:return new Int32Array(r)}break;case 3:switch(t){case 32:return new Float32Array(r);case 64:return new Float64Array(r)}}throw Error("Unsupported data format/bitsPerSample")}var f=class{constructor(e,t,r,i,n,o){this.fileDirectory=e,this.geoKeys=t,this.dataView=r,this.littleEndian=i,this.tiles=n?{}:null,this.isTiled=!e.StripOffsets;const s=e.PlanarConfiguration;if(this.planarConfiguration=void 0===s?1:s,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.");this.source=o}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return this.fileDirectory.SamplesPerPixel}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:void 0!==this.fileDirectory.RowsPerStrip?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBytesPerPixel(){let e=0;for(let t=0;t<this.fileDirectory.BitsPerSample.length;++t){const r=this.fileDirectory.BitsPerSample[t];if(r%8!=0)throw new Error(`Sample bit-width of ${r} is not supported.`);if(r!==this.fileDirectory.BitsPerSample[0])throw new Error("Differing size of samples in a pixel are not supported.");e+=r}return e/8}getSampleByteSize(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${e} is out of range.`);const t=this.fileDirectory.BitsPerSample[e];if(t%8!=0)throw new Error(`Sample bit-width of ${t} is not supported.`);return t/8}getReaderForSample(e){const t=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,r=this.fileDirectory.BitsPerSample[e];switch(t){case 1:switch(r){case 8:return DataView.prototype.getUint8;case 16:return DataView.prototype.getUint16;case 32:return DataView.prototype.getUint32}break;case 2:switch(r){case 8:return DataView.prototype.getInt8;case 16:return DataView.prototype.getInt16;case 32:return DataView.prototype.getInt32}break;case 3:switch(r){case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}throw Error("Unsupported data format/bitsPerSample")}getArrayForSample(e,t){return c(this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,this.fileDirectory.BitsPerSample[e],t)}async getTileOrStrip(e,t,r,i){const n=Math.ceil(this.getWidth()/this.getTileWidth()),o=Math.ceil(this.getHeight()/this.getTileHeight());let s;const{tiles:a}=this;let l,c;1===this.planarConfiguration?s=t*n+e:2===this.planarConfiguration&&(s=r*n*o+t*n+e),this.isTiled?(l=this.fileDirectory.TileOffsets[s],c=this.fileDirectory.TileByteCounts[s]):(l=this.fileDirectory.StripOffsets[s],c=this.fileDirectory.StripByteCounts[s]);const f=await this.source.fetch(l,c);let u;return null===a?u=i.decode(this.fileDirectory,f):a[s]||(u=i.decode(this.fileDirectory,f),a[s]=u),{x:e,y:t,sample:r,data:await u}}async _readRaster(e,t,r,i,n,o,s,c){const f=this.getTileWidth(),u=this.getTileHeight(),h=Math.max(Math.floor(e[0]/f),0),d=Math.min(Math.ceil(e[2]/f),Math.ceil(this.getWidth()/this.getTileWidth())),p=Math.max(Math.floor(e[1]/u),0),g=Math.min(Math.ceil(e[3]/u),Math.ceil(this.getHeight()/this.getTileHeight())),y=e[2]-e[0];let m=this.getBytesPerPixel();const w=[],b=[];for(let e=0;e<t.length;++e)1===this.planarConfiguration?w.push(l(this.fileDirectory.BitsPerSample,0,t[e])/8):w.push(0),b.push(this.getReaderForSample(t[e]));const T=[],{littleEndian:P}=this;for(let o=p;o<g;++o)for(let s=h;s<d;++s)for(let a=0;a<t.length;++a){const l=a,c=t[a];2===this.planarConfiguration&&(m=this.getSampleByteSize(c));const h=this.getTileOrStrip(s,o,c,n);T.push(h),h.then(n=>{const o=n.data,s=new DataView(o),a=n.y*u,c=n.x*f,h=(n.y+1)*u,d=(n.x+1)*f,p=b[l],g=Math.min(u,u-(h-e[3])),T=Math.min(f,f-(d-e[2]));for(let n=Math.max(0,e[1]-a);n<g;++n)for(let o=Math.max(0,e[0]-c);o<T;++o){const u=(n*f+o)*m,h=p.call(s,u+w[l],P);let d;i?(d=(n+a-e[1])*y*t.length+(o+c-e[0])*t.length+l,r[d]=h):(d=(n+a-e[1])*y+o+c-e[0],r[l][d]=h)}})}if(await Promise.all(T),o&&e[2]-e[0]!==o||s&&e[3]-e[1]!==s){let n;return(n=i?(0,a.resampleInterleaved)(r,e[2]-e[0],e[3]-e[1],o,s,t.length,c):(0,a.resample)(r,e[2]-e[0],e[3]-e[1],o,s,c)).width=o,n.height=s,n}return r.width=o||e[2]-e[0],r.height=s||e[3]-e[1],r}async readRasters({window:e,samples:t=[],interleave:r,pool:i=null,width:n,height:o,resampleMethod:a,fillValue:l}={}){const f=e||[0,0,this.getWidth(),this.getHeight()];if(f[0]>f[2]||f[1]>f[3])throw new Error("Invalid subsets");const u=(f[2]-f[0])*(f[3]-f[1]);if(t&&t.length){for(let e=0;e<t.length;++e)if(t[e]>=this.fileDirectory.SamplesPerPixel)return Promise.reject(new RangeError(`Invalid sample index \'${t[e]}\'.`))}else for(let e=0;e<this.fileDirectory.SamplesPerPixel;++e)t.push(e);let h;if(r)h=c(this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,Math.max.apply(null,this.fileDirectory.BitsPerSample),u*t.length),l&&h.fill(l);else{h=[];for(let e=0;e<t.length;++e){const r=this.getArrayForSample(t[e],u);Array.isArray(l)&&e<l.length?r.fill(l[e]):l&&!Array.isArray(l)&&r.fill(l),h.push(r)}}const d=i||(0,s.getDecoder)(this.fileDirectory);return await this._readRaster(f,t,h,r,d,n,o,a)}async readRGB({window:e,pool:t=null,width:r,height:i,resampleMethod:s,enableAlpha:a=!1}={}){const l=e||[0,0,this.getWidth(),this.getHeight()];if(l[0]>l[2]||l[1]>l[3])throw new Error("Invalid subsets");const c=this.fileDirectory.PhotometricInterpretation;if(c===n.photometricInterpretations.RGB){let o=[0,1,2];if(this.fileDirectory.ExtraSamples!==n.ExtraSamplesValues.Unspecified&&a){o=[];for(let e=0;e<this.fileDirectory.BitsPerSample.length;e+=1)o.push(e)}return this.readRasters({window:e,interleave:!0,samples:o,pool:t,width:r,height:i})}let f;switch(c){case n.photometricInterpretations.WhiteIsZero:case n.photometricInterpretations.BlackIsZero:case n.photometricInterpretations.Palette:f=[0];break;case n.photometricInterpretations.CMYK:f=[0,1,2,3];break;case n.photometricInterpretations.YCbCr:case n.photometricInterpretations.CIELab:f=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const u={window:l,interleave:!0,samples:f,pool:t,width:r,height:i,resampleMethod:s},{fileDirectory:h}=this,d=await this.readRasters(u),p=2**this.fileDirectory.BitsPerSample[0];let g;switch(c){case n.photometricInterpretations.WhiteIsZero:g=(0,o.fromWhiteIsZero)(d,p);break;case n.photometricInterpretations.BlackIsZero:g=(0,o.fromBlackIsZero)(d,p);break;case n.photometricInterpretations.Palette:g=(0,o.fromPalette)(d,h.ColorMap);break;case n.photometricInterpretations.CMYK:g=(0,o.fromCMYK)(d);break;case n.photometricInterpretations.YCbCr:g=(0,o.fromYCbCr)(d);break;case n.photometricInterpretations.CIELab:g=(0,o.fromCIELab)(d);break;default:throw new Error("Unsupported photometric interpretation.")}return g.width=d.width,g.height=d.height,g}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const e=[];for(let t=0;t<this.fileDirectory.ModelTiepoint.length;t+=6)e.push({i:this.fileDirectory.ModelTiepoint[t],j:this.fileDirectory.ModelTiepoint[t+1],k:this.fileDirectory.ModelTiepoint[t+2],x:this.fileDirectory.ModelTiepoint[t+3],y:this.fileDirectory.ModelTiepoint[t+4],z:this.fileDirectory.ModelTiepoint[t+5]});return e}getGDALMetadata(e=null){const t={};if(!this.fileDirectory.GDAL_METADATA)return null;const r=this.fileDirectory.GDAL_METADATA,n=(0,i.default)(r.substring(0,r.length-1));if(!n[0].tagName)throw new Error("Failed to parse GDAL metadata XML.");const o=n[0];if("GDALMetadata"!==o.tagName)throw new Error("Unexpected GDAL metadata XML tag.");let s=o.children.filter(e=>"Item"===e.tagName);e&&(s=s.filter(t=>Number(t.attributes.sample)===e));for(let e=0;e<s.length;++e){const r=s[e];t[r.attributes.name]=r.children[0]}return t}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const e=this.fileDirectory.GDAL_NODATA;return Number(e.substring(0,e.length-1))}getOrigin(){const e=this.fileDirectory.ModelTiepoint,t=this.fileDirectory.ModelTransformation;if(e&&6===e.length)return[e[3],e[4],e[5]];if(t)return[t[3],t[7],t[11]];throw new Error("The image does not have an affine transformation.")}getResolution(e=null){const t=this.fileDirectory.ModelPixelScale,r=this.fileDirectory.ModelTransformation;if(t)return[t[0],-t[1],t[2]];if(r)return[r[0],r[5],r[10]];if(e){const[t,r,i]=e.getResolution();return[t*e.getWidth()/this.getWidth(),r*e.getHeight()/this.getHeight(),i*e.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return 1===this.geoKeys.GTRasterTypeGeoKey}getBoundingBox(){const e=this.getOrigin(),t=this.getResolution(),r=e[0],i=e[1],n=r+t[0]*this.getWidth(),o=i+t[1]*this.getHeight();return[Math.min(r,n),Math.min(i,o),Math.max(r,n),Math.max(i,o)]}};r.default=f},{"./globals":"j27V","./rgb":"fpBl","./compression":"FGCZ","./resample":"OQju"}],dqpX:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=class{constructor(e){this._dataView=new DataView(e)}get buffer(){return this._dataView.buffer}getUint64(e,t){const r=this.getUint32(e,t),i=this.getUint32(e+4,t);return t?r<<32|i:i<<32|r}getInt64(e,t){let r,i;return t?(r=this.getInt32(e,t))<<32|(i=this.getUint32(e+4,t)):(r=this.getUint32(e,t),(i=this.getInt32(e+4,t))<<32|r)}getUint8(e,t){return this._dataView.getUint8(e,t)}getInt8(e,t){return this._dataView.getInt8(e,t)}getUint16(e,t){return this._dataView.getUint16(e,t)}getInt16(e,t){return this._dataView.getInt16(e,t)}getUint32(e,t){return this._dataView.getUint32(e,t)}getInt32(e,t){return this._dataView.getInt32(e,t)}getFloat32(e,t){return this._dataView.getFloat32(e,t)}getFloat64(e,t){return this._dataView.getFloat64(e,t)}}},{}],dGLV:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=class{constructor(e,t,r,i){this._dataView=new DataView(e),this._sliceOffset=t,this._littleEndian=r,this._bigTiff=i}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(e,t){return this.sliceOffset<=e&&this.sliceTop>=e+t}readUint8(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}readInt8(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}readUint16(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}readInt16(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}readUint32(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}readInt32(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}readFloat32(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}readFloat64(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}readUint64(e){const t=this.readUint32(e),r=this.readUint32(e+4);let i;if(this._littleEndian){if(i=t+2**32*r,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}if(i=2**32*t+r,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}readInt64(e){let t,r;if(this._littleEndian){if(t=this.readInt32(e),r=this.readUint32(e+4),combined=t+2**32*r,!Number.isSafeInteger(combined))throw new Error(`${combined} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return combined}if(t=this.readUint32(e-this._sliceOffset),r=this.readInt32(e-this._sliceOffset+4),combined=2**32*t+r,!Number.isSafeInteger(combined))throw new Error(`${combined} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return combined}readOffset(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}},{}],dHPO:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("threads/register");var i=e("threads");const n="undefined"!=typeof navigator?navigator.hardwareConcurrency:null;var o=class{constructor(e=n){const t=new Worker("/decoder.worker.7cb947d7.js");this.pool=(0,i.Pool)(()=>(0,i.spawn)(t),e)}async decode(e,t){return new Promise((r,i)=>{this.pool.queue(async n=>{try{const i=await n(e,t);r(i)}catch(e){i(e)}})})}destroy(){this.pool.terminate(!0)}};r.default=o},{"./decoder.worker.js":[["decoder.worker.7cb947d7.js","LHx9"],"decoder.worker.7cb947d7.js.map","LHx9"]}],cUx7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.makeFetchSource=f,r.makeXHRSource=u,r.makeHttpSource=h,r.makeRemoteSource=function(e,t){const{forceXHR:r}=t;if("function"==typeof fetch&&!r)return f(e,t);if("undefined"!=typeof XMLHttpRequest)return u(e,t);if(o.default.get)return h(e,t);throw new Error("No remote source available")},r.makeBufferSource=function(e){return{fetch:async(t,r)=>e.slice(t,t+r)}},r.makeFileSource=function(e){const t=d(e,"r");return{async fetch(e,r){const n=await t,{buffer:o}=await p(n,i.Buffer.alloc(r),0,r,e);return o.buffer}}},r.makeFileReaderSource=function(e){return{fetch:async(t,r)=>new Promise((i,n)=>{const o=e.slice(t,t+r),s=new FileReader;s.onload=e=>i(e.target.result),s.onerror=n,s.readAsArrayBuffer(o)})}};var i=e("buffer"),n=e("fs"),o=l(e("http")),s=l(e("https")),a=l(e("url"));function l(e){return e&&e.__esModule?e:{default:e}}class c{constructor(e,{blockSize:t=65536}={}){this.retrievalFunction=e,this.blockSize=t,this.blockRequests=new Map,this.blocks=new Map,this.blockIdsAwaitingRequest=null}async fetch(e,t,r=!1){const i=e+t,n=[],o=[],s=[];for(let t=Math.floor(e/this.blockSize)*this.blockSize;t<i;t+=this.blockSize){const e=Math.floor(t/this.blockSize);this.blocks.has(e)||this.blockRequests.has(e)||o.push(e),this.blockRequests.has(e)&&s.push(this.blockRequests.get(e)),n.push(e)}if(this.blockIdsAwaitingRequest)for(let e=0;e<o.length;++e){const t=o[e];this.blockIdsAwaitingRequest.add(t)}else this.blockIdsAwaitingRequest=new Set(o);if(r||await async function(e){return new Promise(t=>setTimeout(t,e))}(),this.blockIdsAwaitingRequest){const e=function(e){if(0===e.length)return[];const t=[];let r=[];t.push(r);for(let i=0;i<e.length;++i)0===i||e[i]===e[i-1]+1?r.push(e[i]):(r=[e[i]],t.push(r));return t}(Array.from(this.blockIdsAwaitingRequest).sort());for(const t of e){const e=this.requestData(t[0]*this.blockSize,t.length*this.blockSize);for(let r=0;r<t.length;++r){const i=t[r];this.blockRequests.set(i,(async()=>{const t=await e,n=r*this.blockSize,o=Math.min(n+this.blockSize,t.data.byteLength),s=t.data.slice(n,o);this.blockRequests.delete(i),this.blocks.set(i,{data:s,offset:t.offset+n,length:s.byteLength,top:t.offset+o})})())}}this.blockIdsAwaitingRequest=null}const a=[];for(const e of o)this.blockRequests.has(e)&&a.push(this.blockRequests.get(e));return await Promise.all(a),await Promise.all(s),function(e,t,r){const i=t+r,n=new ArrayBuffer(r),o=new Uint8Array(n);for(const r of e){const e=r.offset-t,n=r.top-i;let s,a=0,l=0;e<0?a=-e:e>0&&(l=e),n<0?s=r.length-a:n>0&&(s=i-r.offset-a);const c=new Uint8Array(r.data,a,s);o.set(c,l)}return n}(n.map(e=>this.blocks.get(e)),e,t)}async requestData(e,t){const r=await this.retrievalFunction(e,t);return r.length?r.length!==r.data.byteLength&&(r.data=r.data.slice(0,r.length)):r.length=r.data.byteLength,r.top=r.offset+r.length,r}}function f(e,{headers:t={},blockSize:r}={}){return new c(async(r,i)=>{const n=await fetch(e,{headers:{...t,Range:`bytes=${r}-${r+i-1}`}});if(n.ok){if(206===n.status)return{data:n.arrayBuffer?await n.arrayBuffer():(await n.buffer()).buffer,offset:r,length:i};{const e=n.arrayBuffer?await n.arrayBuffer():(await n.buffer()).buffer;return{data:e,offset:0,length:e.byteLength}}}throw new Error("Error fetching data.")},{blockSize:r})}function u(e,{headers:t={},blockSize:r}={}){return new c(async(r,i)=>new Promise((n,o)=>{const s=new XMLHttpRequest;s.open("GET",e),s.responseType="arraybuffer";const a={...t,Range:`bytes=${r}-${r+i-1}`};for(const[e,t]of Object.entries(a))s.setRequestHeader(e,t);s.onload=()=>{const e=s.response;206===s.status?n({data:e,offset:r,length:i}):n({data:e,offset:0,length:e.byteLength})},s.onerror=o,s.send()}),{blockSize:r})}function h(e,{headers:t={},blockSize:r}={}){return new c(async(r,n)=>new Promise((l,c)=>{const f=a.default.parse(e);("http:"===f.protocol?o.default:s.default).get({...f,headers:{...t,Range:`bytes=${r}-${r+n-1}`}},e=>{const t=[];e.on("data",e=>{t.push(e)}),e.on("end",()=>{const e=i.Buffer.concat(t).buffer;l({data:e,offset:r,length:e.byteLength})})}).on("error",c)}),{blockSize:r})}function d(e,t,r){return new Promise((i,o)=>{(0,n.open)(e,t,r,(e,t)=>{e?o(e):i(t)})})}function p(...e){return new Promise((t,r)=>{(0,n.read)(...e,(e,i,n)=>{e?r(e):t({bytesRead:i,buffer:n})})})}},{}],FOZT:[function(e,t,r){"use strict";function i(e){const t=[],{length:r}=e;for(let i=0;i<r;i++)t.push(e[i]);return t}Object.defineProperty(r,"__esModule",{value:!0}),r.assign=function(e,t){for(const r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},r.chunk=function(e,t){const r=[],i=e.length;for(let n=0;n<i;n+=t){const i=[];for(let r=n;r<n+t;r++)i.push(e[r]);r.push(i)}return r},r.endsWith=function(e,t){return!(e.length<t.length)&&e.substr(e.length-t.length)===t},r.forEach=function(e,t){const{length:r}=e;for(let i=0;i<r;i++)t(e[i],i)},r.invert=function(e){const t={};for(const r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t},r.range=function(e){const t=[];for(let r=0;r<e;r++)t.push(r);return t},r.times=function(e,t){const r=[];for(let i=0;i<e;i++)r.push(t(i));return r},r.toArray=i,r.toArrayRecursively=function e(t){return t.length?i(t).map(e):t}},{}],BGyE:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.writeGeotiff=function(e,t){let r,o,s,l;"number"==typeof e[0]?(r=t.height||t.ImageLength,s=t.width||t.ImageWidth,o=e.length/(r*s),l=e):(o=e.length,r=e[0].length,s=e[0][0].length,l=[],(0,n.times)(r,t=>{(0,n.times)(s,r=>{(0,n.times)(o,i=>{l.push(e[i][t][r])})})})),t.ImageLength=r,delete t.height,t.ImageWidth=s,delete t.width,t.BitsPerSample||(t.BitsPerSample=(0,n.times)(o,()=>8)),d.forEach(e=>{const r=e[0];if(!t[r]){const i=e[1];t[r]=i}}),t.PhotometricInterpretation||(t.PhotometricInterpretation=3===t.BitsPerSample.length?2:1),t.SamplesPerPixel||(t.SamplesPerPixel=[o]),t.StripByteCounts||(t.StripByteCounts=[o*r*s]),t.ModelPixelScale||(t.ModelPixelScale=[360/s,180/r,0]),t.SampleFormat||(t.SampleFormat=(0,n.times)(o,()=>1));const c=Object.keys(t).filter(e=>(0,n.endsWith)(e,"GeoKey")).sort((e,t)=>a[e]-a[t]);if(!t.GeoKeyDirectory){const e=[1,1,0,c.length];c.forEach(r=>{const n=Number(a[r]);let o,s,l;e.push(n),"SHORT"===i.fieldTagTypes[n]?(o=1,s=0,l=t[r]):"GeogCitationGeoKey"===r?(o=t.GeoAsciiParams.length,s=Number(a.GeoAsciiParams),l=0):console.log(`[geotiff.js] couldn\'t get TIFFTagLocation for ${r}`),e.push(s),e.push(o),e.push(l)}),t.GeoKeyDirectory=e}for(const e in c)c.hasOwnProperty(e)&&delete t[e];["Compression","ExtraSamples","GeographicTypeGeoKey","GTModelTypeGeoKey","GTRasterTypeGeoKey","ImageLength","ImageWidth","PhotometricInterpretation","PlanarConfiguration","ResolutionUnit","SamplesPerPixel","XPosition","YPosition"].forEach(e=>{t[e]&&(t[e]=(e=>Array.isArray(e)?e:[e])(t[e]))});const f=(e=>{const t={};for(const r in e)"StripOffsets"!==r&&(a[r]||console.error(r,"not in name2code:",Object.keys(a)),t[a[r]]=e[r]);return t})(t);return h(l,s,r,f)};var i=e("./globals"),n=e("./utils");const o=(0,n.invert)(i.fieldTagNames),s=(0,n.invert)(i.geoKeyNames),a={};(0,n.assign)(a,o),(0,n.assign)(a,s);const l=(0,n.invert)(i.fieldTypeNames),c={nextZero:(e,t)=>{let r=t;for(;0!==e[r];)r++;return r},readUshort:(e,t)=>e[t]<<8|e[t+1],readShort:(e,t)=>{const r=c.ui8;return r[0]=e[t+1],r[1]=e[t+0],c.i16[0]},readInt:(e,t)=>{const r=c.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],c.i32[0]},readUint:(e,t)=>{const r=c.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],c.ui32[0]},readASCII:(e,t,r)=>r.map(r=>String.fromCharCode(e[t+r])).join(""),readFloat:(e,t)=>{const r=c.ui8;return(0,n.times)(4,i=>{r[i]=e[t+3-i]}),c.fl32[0]},readDouble:(e,t)=>{const r=c.ui8;return(0,n.times)(8,i=>{r[i]=e[t+7-i]}),c.fl64[0]},writeUshort:(e,t,r)=>{e[t]=r>>8&255,e[t+1]=255&r},writeUint:(e,t,r)=>{e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r>>0&255},writeASCII:(e,t,r)=>{(0,n.times)(r.length,i=>{e[t+i]=r.charCodeAt(i)})},ui8:new Uint8Array(8)};c.fl64=new Float64Array(c.ui8.buffer),c.writeDouble=(e,t,r)=>{c.fl64[0]=r,(0,n.times)(8,r=>{e[t+r]=c.ui8[7-r]})};const f=(e,t,r,o)=>{let s=r;const a=Object.keys(o).filter(e=>null!=e&&"undefined"!==e);e.writeUshort(t,s,a.length);let c=(s+=2)+12*a.length+4;for(const r of a){let a=null;"number"==typeof r?a=r:"string"==typeof r&&(a=parseInt(r,10));const f=i.fieldTagTypes[a],u=l[f];if(null==f||void 0===f||void 0===f)throw new Error(`unknown type of tag: ${a}`);let h=o[r];if(void 0===h)throw new Error(`failed to get value for key ${r}`);"ASCII"===f&&"string"==typeof h&&!1===(0,n.endsWith)(h,"\\0")&&(h+="\\0");const d=h.length;e.writeUshort(t,s,a),s+=2,e.writeUshort(t,s,u),s+=2,e.writeUint(t,s,d);let p=[-1,1,1,2,4,8,0,0,0,0,0,0,8][u]*d,g=s+=4;p>4&&(e.writeUint(t,s,c),g=c),"ASCII"===f?e.writeASCII(t,g,h):"SHORT"===f?(0,n.times)(d,r=>{e.writeUshort(t,g+2*r,h[r])}):"LONG"===f?(0,n.times)(d,r=>{e.writeUint(t,g+4*r,h[r])}):"RATIONAL"===f?(0,n.times)(d,r=>{e.writeUint(t,g+8*r,Math.round(1e4*h[r])),e.writeUint(t,g+8*r+4,1e4)}):"DOUBLE"===f&&(0,n.times)(d,r=>{e.writeDouble(t,g+8*r,h[r])}),p>4&&(c+=p+=1&p),s+=4}return[s,c]},u=e=>{const t=new Uint8Array(1e3);let r=4;const i=c;t[0]=77,t[1]=77,t[3]=42;let n=8;if(i.writeUint(t,r,n),r+=4,e.forEach((r,o)=>{const s=f(i,t,n,r);n=s[1],o<e.length-1&&i.writeUint(t,s[0],n)}),t.slice)return t.slice(0,n).buffer;const o=new Uint8Array(n);for(let e=0;e<n;e++)o[e]=t[e];return o.buffer},h=(e,t,r,i)=>{if(null==r)throw new Error(`you passed into encodeImage a width of type ${r}`);if(null==t)throw new Error(`you passed into encodeImage a width of type ${t}`);const o={256:[t],257:[r],273:[1e3],278:[r],305:"geotiff.js"};if(i)for(const e in i)i.hasOwnProperty(e)&&(o[e]=i[e]);const s=new Uint8Array(u([o])),a=new Uint8Array(e),l=o[277],c=new Uint8Array(1e3+t*r*l);return(0,n.times)(s.length,e=>{c[e]=s[e]}),(0,n.forEach)(a,(e,t)=>{c[1e3+t]=e}),c.buffer},d=[["Compression",1],["PlanarConfiguration",1],["XPosition",0],["YPosition",0],["ResolutionUnit",1],["ExtraSamples",0],["GeoAsciiParams","WGS 84\\0"],["ModelTiepoint",[0,0,0,-180,90,0]],["GTModelTypeGeoKey",2],["GTRasterTypeGeoKey",1],["GeographicTypeGeoKey",4326],["GeogCitationGeoKey","WGS 84"]]},{"./globals":"j27V","./utils":"FOZT"}],bsJs:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fromUrl=async function(e,t={}){return w.fromSource((0,a.makeRemoteSource)(e,t))},r.fromArrayBuffer=async function(e){return w.fromSource((0,a.makeBufferSource)(e))},r.fromFile=async function(e){return w.fromSource((0,a.makeFileSource)(e))},r.fromBlob=async function(e){return w.fromSource((0,a.makeFileReaderSource)(e))},r.fromUrls=async function(e,t=[],r={}){const i=await w.fromSource((0,a.makeRemoteSource)(e,r)),n=await Promise.all(t.map(e=>w.fromSource((0,a.makeRemoteSource)(e,r))));return new T(i,n)},r.writeArrayBuffer=async function(e,t){return(0,c.writeGeotiff)(e,t)},Object.defineProperty(r,"Pool",{enumerable:!0,get:function(){return s.default}}),r.rgb=r.globals=r.MultiGeoTIFF=r.default=r.GeoTIFF=void 0;var i=d(e("./geotiffimage")),n=d(e("./dataview64")),o=d(e("./dataslice")),s=d(e("./pool")),a=e("./source"),l=h(e("./globals"));r.globals=l;var c=e("./geotiffwriter"),f=h(e("./rgb"));function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function h(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=i?Object.getOwnPropertyDescriptor(e,n):null;o&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n]}return r.default=e,t&&t.set(e,r),r}function d(e){return e&&e.__esModule?e:{default:e}}function p(e){switch(e){case l.fieldTypes.BYTE:case l.fieldTypes.ASCII:case l.fieldTypes.SBYTE:case l.fieldTypes.UNDEFINED:return 1;case l.fieldTypes.SHORT:case l.fieldTypes.SSHORT:return 2;case l.fieldTypes.LONG:case l.fieldTypes.SLONG:case l.fieldTypes.FLOAT:case l.fieldTypes.IFD:return 4;case l.fieldTypes.RATIONAL:case l.fieldTypes.SRATIONAL:case l.fieldTypes.DOUBLE:case l.fieldTypes.LONG8:case l.fieldTypes.SLONG8:case l.fieldTypes.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${e}`)}}function g(e){const t=e.GeoKeyDirectory;if(!t)return null;const r={};for(let i=4;i<=4*t[3];i+=4){const n=l.geoKeyNames[t[i]],o=t[i+1]?l.fieldTagNames[t[i+1]]:null,s=t[i+2],a=t[i+3];let c=null;if(o){if(null==(c=e[o]))throw new Error(`Could not get value of geoKey \'${n}\'.`);"string"==typeof c?c=c.substring(a,a+s-1):c.subarray&&(c=c.subarray(a,a+s-1))}else c=a;r[n]=c}return r}function y(e,t,r,i){let n=null,o=null;const s=p(t);switch(t){case l.fieldTypes.BYTE:case l.fieldTypes.ASCII:case l.fieldTypes.UNDEFINED:n=new Uint8Array(r),o=e.readUint8;break;case l.fieldTypes.SBYTE:n=new Int8Array(r),o=e.readInt8;break;case l.fieldTypes.SHORT:n=new Uint16Array(r),o=e.readUint16;break;case l.fieldTypes.SSHORT:n=new Int16Array(r),o=e.readInt16;break;case l.fieldTypes.LONG:case l.fieldTypes.IFD:n=new Uint32Array(r),o=e.readUint32;break;case l.fieldTypes.SLONG:n=new Int32Array(r),o=e.readInt32;break;case l.fieldTypes.LONG8:case l.fieldTypes.IFD8:n=new Array(r),o=e.readUint64;break;case l.fieldTypes.SLONG8:n=new Array(r),o=e.readInt64;break;case l.fieldTypes.RATIONAL:n=new Uint32Array(2*r),o=e.readUint32;break;case l.fieldTypes.SRATIONAL:n=new Int32Array(2*r),o=e.readInt32;break;case l.fieldTypes.FLOAT:n=new Float32Array(r),o=e.readFloat32;break;case l.fieldTypes.DOUBLE:n=new Float64Array(r),o=e.readFloat64;break;default:throw new RangeError(`Invalid field type: ${t}`)}if(t!==l.fieldTypes.RATIONAL&&t!==l.fieldTypes.SRATIONAL)for(let t=0;t<r;++t)n[t]=o.call(e,i+t*s);else for(let t=0;t<r;t+=2)n[t]=o.call(e,i+t*s),n[t+1]=o.call(e,i+(t*s+4));return t===l.fieldTypes.ASCII?String.fromCharCode.apply(null,n):n}r.rgb=f;class m{async readRasters(e={}){const{window:t,width:r,height:i}=e;let{resX:n,resY:o,bbox:s}=e;const a=await this.getImage();let l=a;const c=await this.getImageCount(),f=a.getBoundingBox();if(t&&s)throw new Error(\'Both "bbox" and "window" passed.\');if(r||i){if(t){const[e,r]=a.getOrigin(),[i,n]=a.getResolution();s=[e+t[0]*i,r+t[1]*n,e+t[2]*i,r+t[3]*n]}const e=s||f;if(r){if(n)throw new Error("Both width and resX passed");n=(e[2]-e[0])/r}if(i){if(o)throw new Error("Both width and resY passed");o=(e[3]-e[1])/i}}if(n||o){const e=[];for(let t=0;t<c;++t){const r=await this.getImage(t),{SubfileType:i,NewSubfileType:n}=r.fileDirectory;(0===t||2===i||1&n)&&e.push(r)}e.sort((e,t)=>e.getWidth()-t.getWidth());for(let t=0;t<e.length;++t){const r=e[t],i=(f[2]-f[0])/r.getWidth(),s=(f[3]-f[1])/r.getHeight();if(l=r,n&&n>i||o&&o>s)break}}let u=t;if(s){const[e,t]=a.getOrigin(),[r,i]=l.getResolution(a);u=[Math.round((s[0]-e)/r),Math.round((s[1]-t)/i),Math.round((s[2]-e)/r),Math.round((s[3]-t)/i)],u=[Math.min(u[0],u[2]),Math.min(u[1],u[3]),Math.max(u[0],u[2]),Math.max(u[1],u[3])]}return l.readRasters({...e,window:u})}}class w extends m{constructor(e,t,r,i,n={}){super(),this.source=e,this.littleEndian=t,this.bigTiff=r,this.firstIFDOffset=i,this.cache=n.cache||!1,this.fileDirectories=null,this.fileDirectoriesParsing=null,this.ghostValues=null}async getSlice(e,t){const r=this.bigTiff?4048:1024;return new o.default(await this.source.fetch(e,void 0!==t?t:r),e,this.littleEndian,this.bigTiff)}async parseFileDirectories(){let e=this.firstIFDOffset;const t=this.bigTiff?8:2,r=this.bigTiff?20:12,i=[];for(;0!==e;){let n=await this.getSlice(e);const o=this.bigTiff?n.readUint64(e):n.readUint16(e),s=o*r+(this.bigTiff?16:6);n.covers(e,s)||(n=await this.getSlice(e,s));const a={};let c=e+(this.bigTiff?8:2);for(let e=0;e<o;c+=r,++e){const e=n.readUint16(c),t=n.readUint16(c+2),r=this.bigTiff?n.readUint64(c+4):n.readUint32(c+4);let i,o;const s=p(t),f=c+(this.bigTiff?12:8);if(s*r<=(this.bigTiff?8:4))i=y(n,t,r,f);else{const e=n.readOffset(f),o=p(t)*r;i=n.covers(e,o)?y(n,t,r,e):y(await this.getSlice(e,o),t,r,e)}o=1===r&&-1===l.arrayFields.indexOf(e)&&t!==l.fieldTypes.RATIONAL&&t!==l.fieldTypes.SRATIONAL?i[0]:i,a[l.fieldTagNames[e]]=o}i.push([a,g(a)]),e=n.readOffset(e+t+r*o)}return i}async getImage(e=0){this.fileDirectories||(this.fileDirectoriesParsing||(this.fileDirectoriesParsing=this.parseFileDirectories()),this.fileDirectories=await this.fileDirectoriesParsing);const t=this.fileDirectories[e];if(!t)throw new RangeError("Invalid image index");return new i.default(t[0],t[1],this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){return this.fileDirectories||(this.fileDirectoriesParsing||(this.fileDirectoriesParsing=this.parseFileDirectories()),this.fileDirectories=await this.fileDirectoriesParsing),this.fileDirectories.length}async getGhostValues(){const e=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const t="GDAL_STRUCTURAL_METADATA_SIZE=",r=t.length+100;let i=await this.getSlice(e,r);if(t===y(i,l.fieldTypes.ASCII,t.length,e)){const t=y(i,l.fieldTypes.ASCII,r,e).split("\\n")[0],n=Number(t.split("=")[1].split(" ")[0])+t.length;n>r&&(i=await this.getSlice(e,n));const o=y(i,l.fieldTypes.ASCII,n,e);this.ghostValues={},o.split("\\n").filter(e=>e.length>0).map(e=>e.split("=")).forEach(([e,t])=>{this.ghostValues[e]=t})}return this.ghostValues}static async fromSource(e,t){const r=await e.fetch(0,1024),i=new n.default(r),o=i.getUint16(0,0);let s;if(18761===o)s=!0;else{if(19789!==o)throw new TypeError("Invalid byte order value.");s=!1}const a=i.getUint16(2,s);let l;if(42===a)l=!1;else{if(43!==a)throw new TypeError("Invalid magic number.");if(l=!0,8!==i.getUint16(4,s))throw new Error("Unsupported offset byte-size.")}const c=l?i.getUint64(8,s):i.getUint32(4,s);return new w(e,s,l,c,t)}}r.GeoTIFF=w;var b=w;r.default=b;class T extends m{constructor(e,t){super(),this.mainFile=e,this.overviewFiles=t,this.imageFiles=[e].concat(t),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const e=[this.mainFile.parseFileDirectories()].concat(this.overviewFiles.map(e=>e.parseFileDirectories()));return this.fileDirectoriesPerFile=await Promise.all(e),this.fileDirectoriesPerFile}async getImage(e=0){this.fileDirectoriesPerFile||(this.fileDirectoriesPerFileParsing||(this.fileDirectoriesPerFileParsing=this.parseFileDirectoriesPerFile()),this.fileDirectoriesPerFile=await this.fileDirectoriesPerFileParsing);let t=e;for(let e=0;e<this.fileDirectoriesPerFile.length;++e){const r=this.fileDirectoriesPerFile[e];if(t<r.length){const n=this.imageFiles[e];return new i.default(r[t][0],r[t][1],n.dataView,n.littleEndian,n.cache,n.source)}t-=r.length}throw new RangeError("Invalid image index")}async getImageCount(){return this.fileDirectoriesPerFile||(this.fileDirectoriesPerFileParsing||(this.fileDirectoriesPerFileParsing=this.parseFileDirectoriesPerFile()),this.fileDirectoriesPerFile=await this.fileDirectoriesPerFileParsing),this.fileDirectoriesPerFile.reduce((e,t)=>e+t.length,0)}}r.MultiGeoTIFF=T},{"./geotiffimage":"eOWo","./dataview64":"dqpX","./dataslice":"dGLV","./pool":"dHPO","./source":"cUx7","./globals":"j27V","./geotiffwriter":"BGyE","./rgb":"fpBl"}],epB2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("./geotiff");Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return i[e]}})}))},{"./geotiff":"bsJs"}]},{},["epB2"])},function(e,t){function r(e){var t=new Error("Cannot find module \'"+e+"\'");throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=3},function(e,t,r){"use strict";e.exports={countIn1D:function(e){return e.reduce((function(e,t){return void 0===e[t]?e[t]=1:e[t]++,e}),{})},countIn2D:function(e){return e.reduce((function(e,t){return t.forEach((function(t){void 0===e[t]?e[t]=1:e[t]++})),e}),{})},unflatten:function(e,t){for(var r=t.height,i=t.width,n=[],o=0;o<r;o++){var s=o*i,a=s+i;n.push(e.slice(s,a))}return n}}}]);',null)}},function(e,t,r){"use strict";var i=window.URL||window.webkitURL;e.exports=function(e,t){try{try{var r;try{(r=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(e),r=r.getBlob()}catch(t){r=new Blob([e])}return new Worker(i.createObjectURL(r))}catch(t){return new Worker("data:application/javascript,"+encodeURIComponent(e))}}catch(e){if(!t)throw Error("Inline worker is not supported");return new Worker(t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],i=!0,n=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(i=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);i=!0);}catch(e){n=!0,o=e}finally{try{!i&&a.return&&a.return()}finally{if(n)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=function(e,t){return new Promise((function(r,l){try{t&&console.log("starting parseData with",e),t&&console.log("\tGeoTIFF:","undefined"==typeof GeoTIFF?"undefined":n(GeoTIFF));var c={},f=void 0,u=void 0;if("object"===e.rasterType)c.values=e.data,c.height=f=e.metadata.height||c.values[0].length,c.width=u=e.metadata.width||c.values[0][0].length,c.pixelHeight=e.metadata.pixelHeight,c.pixelWidth=e.metadata.pixelWidth,c.projection=e.metadata.projection,c.xmin=e.metadata.xmin,c.ymax=e.metadata.ymax,c.noDataValue=e.metadata.noDataValue,c.numberOfRasters=c.values.length,c.xmax=c.xmin+c.width*c.pixelWidth,c.ymin=c.ymax-c.height*c.pixelHeight,c._data=null,r(a(c));else if("geotiff"===e.rasterType){c._data=e.data;var h=o.fromArrayBuffer;"url"===e.sourceType&&(h=o.fromUrl),t&&console.log("data.rasterType is geotiff"),r(h(e.data).then((function(r){return t&&console.log("geotiff:",r),r.getImage().then((function(r){t&&console.log("image:",r);var n=r.fileDirectory,o=r.getGeoKeys(),l=o.GeographicTypeGeoKey,h=o.ProjectedCSTypeGeoKey;c.projection=l||h,t&&console.log("projection:",c.projection),c.height=f=r.getHeight(),t&&console.log("result.height:",c.height),c.width=u=r.getWidth(),t&&console.log("result.width:",c.width);var d=r.getResolution(),p=i(d,2),g=p[0],m=p[1];c.pixelHeight=Math.abs(m),c.pixelWidth=Math.abs(g);var y=r.getOrigin(),w=i(y,2),b=w[0],v=w[1];return c.xmin=b,c.xmax=c.xmin+u*c.pixelWidth,c.ymax=v,c.ymin=c.ymax-f*c.pixelHeight,c.noDataValue=n.GDAL_NODATA?parseFloat(n.GDAL_NODATA):null,c.numberOfRasters=n.SamplesPerPixel,"url"!==e.sourceType?r.readRasters().then((function(e){return c.values=e.map((function(e){return(0,s.unflatten)(e,{height:f,width:u})})),a(c)})):c}))})))}}catch(e){l(e),console.error("[georaster] error parsing georaster:",e)}}))};var o=r(40),s=r(18);function a(e,t){var r=e.noDataValue,i=e.height,n=e.width;return new Promise((function(o,s){e.maxs=[],e.mins=[],e.ranges=[];for(var a=void 0,l=void 0,c=0;c<e.numberOfRasters;c++){var f=e.values[c];t&&console.log("[georaster] rows:",f);for(var u=0;u<i;u++)for(var h=f[u],d=0;d<n;d++){var p=h[d];p==r||isNaN(p)||(void 0===l||p<l?l=p:(void 0===a||p>a)&&(a=p))}e.maxs.push(a),e.mins.push(l),e.ranges.push(a-l)}o(e)}))}},function(e,t,r){parcelRequire=function(t,i,n,o){var s,a="function"==typeof parcelRequire&&parcelRequire;function l(e,n){if(!i[e]){if(!t[e]){var o="function"==typeof parcelRequire&&parcelRequire;if(!n&&o)return o(e,!0);if(a)return a(e,!0);if("string"==typeof e)return r(41)(e);var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}f.resolve=function(r){return t[e][1][r]||r},f.cache={};var c=i[e]=new l.Module(e);t[e][0].call(c.exports,f,c,c.exports,this)}return i[e].exports;function f(e){return l(f.resolve(e))}}l.isParcelRequire=!0,l.Module=function(e){this.id=e,this.bundle=l,this.exports={}},l.modules=t,l.cache=i,l.parent=a,l.register=function(e,r){t[e]=[function(e,t){t.exports=r},{}]};for(var c=0;c<n.length;c++)try{l(n[c])}catch(t){s||(s=t)}if(n.length){var f=l(n[n.length-1]);e.exports=f}if(parcelRequire=l,s)throw s;return l}({j27V:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.geoKeys=r.geoKeyNames=r.ExtraSamplesValues=r.photometricInterpretations=r.fieldTypes=r.fieldTypeNames=r.arrayFields=r.fieldTagTypes=r.fieldTags=r.fieldTagNames=void 0;const i={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams"};r.fieldTagNames=i;const n={};r.fieldTags=n;for(const e in i)i.hasOwnProperty(e)&&(n[i[e]]=parseInt(e,10));r.fieldTagTypes={256:"SHORT",257:"SHORT",258:"SHORT",259:"SHORT",262:"SHORT",273:"LONG",274:"SHORT",277:"SHORT",278:"LONG",279:"LONG",282:"RATIONAL",283:"RATIONAL",284:"SHORT",286:"SHORT",287:"RATIONAL",296:"SHORT",305:"ASCII",306:"ASCII",338:"SHORT",339:"SHORT",513:"LONG",514:"LONG",1024:"SHORT",1025:"SHORT",2048:"SHORT",2049:"ASCII",33550:"DOUBLE",33922:"DOUBLE",34665:"LONG",34735:"SHORT",34737:"ASCII",42113:"ASCII"};const o=[n.BitsPerSample,n.ExtraSamples,n.SampleFormat,n.StripByteCounts,n.StripOffsets,n.StripRowCounts,n.TileByteCounts,n.TileOffsets];r.arrayFields=o;const s={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"};r.fieldTypeNames=s;const a={};r.fieldTypes=a;for(const e in s)s.hasOwnProperty(e)&&(a[s[e]]=parseInt(e,10));r.photometricInterpretations={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9};r.ExtraSamplesValues={Unspecified:0,Assocalpha:1,Unassalpha:2};const l={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"};r.geoKeyNames=l;const c={};r.geoKeys=c;for(const e in l)l.hasOwnProperty(e)&&(c[l[e]]=parseInt(e,10))},{}],fpBl:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fromWhiteIsZero=function(e,t){const{width:r,height:i}=e,n=new Uint8Array(r*i*3);let o;for(let r=0,i=0;r<e.length;++r,i+=3)o=256-e[r]/t*256,n[i]=o,n[i+1]=o,n[i+2]=o;return n},r.fromBlackIsZero=function(e,t){const{width:r,height:i}=e,n=new Uint8Array(r*i*3);let o;for(let r=0,i=0;r<e.length;++r,i+=3)o=e[r]/t*256,n[i]=o,n[i+1]=o,n[i+2]=o;return n},r.fromPalette=function(e,t){const{width:r,height:i}=e,n=new Uint8Array(r*i*3),o=t.length/3,s=t.length/3*2;for(let r=0,i=0;r<e.length;++r,i+=3){const a=e[r];n[i]=t[a]/65536*256,n[i+1]=t[a+o]/65536*256,n[i+2]=t[a+s]/65536*256}return n},r.fromCMYK=function(e){const{width:t,height:r}=e,i=new Uint8Array(t*r*3);for(let t=0,r=0;t<e.length;t+=4,r+=3){const n=e[t],o=e[t+1],s=e[t+2],a=e[t+3];i[r]=(255-n)/256*255*((255-a)/256),i[r+1]=(255-o)/256*255*((255-a)/256),i[r+2]=(255-s)/256*255*((255-a)/256)}return i},r.fromYCbCr=function(e){const{width:t,height:r}=e,i=new Uint8ClampedArray(t*r*3);for(let t=0,r=0;t<e.length;t+=3,r+=3){const n=e[t],o=e[t+1],s=e[t+2];i[r]=n+1.402*(s-128),i[r+1]=n-.34414*(o-128)-.71414*(s-128),i[r+2]=n+1.772*(o-128)}return i},r.fromCIELab=function(e){const{width:t,height:r}=e,i=new Uint8Array(t*r*3);for(let t=0,r=0;t<e.length;t+=3,r+=3){let n,o,s,a=(e[t+0]+16)/116,l=(e[t+1]<<24>>24)/500+a,c=a-(e[t+2]<<24>>24)/200;n=(n=3.2406*(l=.95047*(l*l*l>.008856?l*l*l:(l-16/116)/7.787))+-1.5372*(a=1*(a*a*a>.008856?a*a*a:(a-16/116)/7.787))+-.4986*(c=1.08883*(c*c*c>.008856?c*c*c:(c-16/116)/7.787)))>.0031308?1.055*n**(1/2.4)-.055:12.92*n,o=(o=-.9689*l+1.8758*a+.0415*c)>.0031308?1.055*o**(1/2.4)-.055:12.92*o,s=(s=.0557*l+-.204*a+1.057*c)>.0031308?1.055*s**(1/2.4)-.055:12.92*s,i[r]=255*Math.max(0,Math.min(1,n)),i[r+1]=255*Math.max(0,Math.min(1,o)),i[r+2]=255*Math.max(0,Math.min(1,s))}return i}},{}],IKSA:[function(e,t,r){"use strict";function i(e,t){let r=e.length-t,i=0;do{for(let r=t;r>0;r--)e[i+t]+=e[i],i++;r-=t}while(r>0)}function n(e,t,r){let i=0,n=e.length;const o=n/r;for(;n>t;){for(let r=t;r>0;--r)e[i+t]+=e[i],++i;n-=t}const s=e.slice();for(let t=0;t<o;++t)for(let i=0;i<r;++i)e[r*t+i]=s[(r-i-1)*o+t]}Object.defineProperty(r,"__esModule",{value:!0}),r.applyPredictor=function(e,t,r,o,s,a){if(!t||1===t)return e;for(let e=0;e<s.length;++e){if(s[e]%8!=0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(s[e]!==s[0])throw new Error("When decoding with predictor, all samples must have the same size.")}const l=s[0]/8,c=2===a?1:s.length;for(let a=0;a<o&&!(a*c*r*l>=e.byteLength);++a){let o;if(2===t){switch(s[0]){case 8:o=new Uint8Array(e,a*c*r*l,c*r*l);break;case 16:o=new Uint16Array(e,a*c*r*l,c*r*l/2);break;case 32:o=new Uint32Array(e,a*c*r*l,c*r*l/4);break;default:throw new Error(`Predictor 2 not allowed with ${s[0]} bits per sample.`)}i(o,c)}else 3===t&&n(o=new Uint8Array(e,a*c*r*l,c*r*l),c,l)}return e}},{}],FJDe:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("../predictor");r.default=class{decode(e,t){const r=this.decodeBlock(t),n=e.Predictor||1;if(1!==n){const t=!e.StripOffsets,o=t?e.TileWidth:e.ImageWidth,s=t?e.TileLength:e.RowsPerStrip||e.ImageLength;return(0,i.applyPredictor)(r,n,o,s,e.BitsPerSample,e.PlanarConfiguration)}return r}}},{"../predictor":"IKSA"}],V9bQ:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));class n extends i.default{decodeBlock(e){return e}}r.default=n},{"./basedecoder":"FJDe"}],tcId:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));function n(e,t){for(let r=t.length-1;r>=0;r--)e.push(t[r]);return e}function o(e){const t=new Uint16Array(4093),r=new Uint8Array(4093);for(let e=0;e<=257;e++)t[e]=4096,r[e]=e;let i=258,o=9,s=0;function a(){i=258,o=9}function l(e){const t=function(e,t,r){const i=t%8,n=Math.floor(t/8),o=8-i,s=t+r-8*(n+1);let a=8*(n+2)-(t+r);const l=8*(n+2)-t;if(a=Math.max(0,a),n>=e.length)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),257;let c=e[n]&2**(8-i)-1,f=c<<=r-o;if(n+1<e.length){let t=e[n+1]>>>a;f+=t<<=Math.max(0,r-l)}if(s>8&&n+2<e.length){const i=8*(n+3)-(t+r);f+=e[n+2]>>>i}return f}(e,s,o);return s+=o,t}function c(e,n){return r[i]=n,t[i]=e,++i-1}function f(e){const i=[];for(let n=e;4096!==n;n=t[n])i.push(r[n]);return i}const u=[];a();const h=new Uint8Array(e);let d,p=l(h);for(;257!==p;){if(256===p){for(a(),p=l(h);256===p;)p=l(h);if(257===p)break;if(p>256)throw new Error(`corrupted code at scanline ${p}`);n(u,f(p)),d=p}else if(p<i){const e=f(p);n(u,e),c(d,e[e.length-1]),d=p}else{const e=f(d);if(!e)throw new Error(`Bogus entry. Not in dictionary, ${d} / ${i}, position: ${s}`);n(u,e),u.push(e[e.length-1]),c(d,e[e.length-1]),d=p}i+1>=2**o&&(12===o?d=void 0:o++),p=l(h)}return new Uint8Array(u)}class s extends i.default{decodeBlock(e){return o(e).buffer}}r.default=s},{"./basedecoder":"FJDe"}],J7kk:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));const n=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),o=4017,s=799,a=3406,l=2276,c=1567,f=3784,u=5793,h=2896;function d(e,t){let r=0;const i=[];let n=16;for(;n>0&&!e[n-1];)--n;i.push({children:[],index:0});let o,s=i[0];for(let a=0;a<n;a++){for(let n=0;n<e[a];n++){for((s=i.pop()).children[s.index]=t[r];s.index>0;)s=i.pop();for(s.index++,i.push(s);i.length<=a;)i.push(o={children:[],index:0}),s.children[s.index]=o.children,s=o;r++}a+1<n&&(i.push(o={children:[],index:0}),s.children[s.index]=o.children,s=o)}return i[0].children}function p(e,t,r,i,o,s,a,l,c){const{mcusPerLine:f,progressive:u}=r,h=t;let d=t,p=0,g=0;function m(){if(g>0)return p>>--g&1;if(255===(p=e[d++])){const t=e[d++];if(t)throw new Error(`unexpected marker: ${(p<<8|t).toString(16)}`)}return g=7,p>>>7}function y(e){let t,r=e;for(;null!==(t=m());){if("number"==typeof(r=r[t]))return r;if("object"!=typeof r)throw new Error("invalid huffman sequence")}return null}function w(e){let t=e,r=0;for(;t>0;){const e=m();if(null===e)return;r=r<<1|e,--t}return r}function b(e){const t=w(e);return t>=1<<e-1?t:t+(-1<<e)+1}let v,S=0,_=0;function T(e,t,r,i,n){const o=r%f,s=(r/f|0)*e.v+i,a=o*e.h+n;t(e,e.blocks[s][a])}function k(e,t,r){const i=r/e.blocksPerLine|0,n=r%e.blocksPerLine;t(e,e.blocks[i][n])}const P=i.length;let I,O,A,C,E,D;D=u?0===s?0===l?function(e,t){const r=y(e.huffmanTableDC),i=0===r?0:b(r)<<c;e.pred+=i,t[0]=e.pred}:function(e,t){t[0]|=m()<<c}:0===l?function(e,t){if(S>0)return void S--;let r=s;const i=a;for(;r<=i;){const i=y(e.huffmanTableAC),o=15&i,s=i>>4;if(0===o){if(s<15){S=w(s)+(1<<s)-1;break}r+=16}else t[n[r+=s]]=b(o)*(1<<c),r++}}:function(e,t){let r=s;const i=a;let o=0;for(;r<=i;){const i=n[r],s=t[i]<0?-1:1;switch(_){case 0:{const t=y(e.huffmanTableAC),r=15&t;if(o=t>>4,0===r)o<15?(S=w(o)+(1<<o),_=4):(o=16,_=1);else{if(1!==r)throw new Error("invalid ACn encoding");v=b(r),_=o?2:3}continue}case 1:case 2:t[i]?t[i]+=(m()<<c)*s:0==--o&&(_=2===_?3:0);break;case 3:t[i]?t[i]+=(m()<<c)*s:(t[i]=v<<c,_=0);break;case 4:t[i]&&(t[i]+=(m()<<c)*s)}r++}4===_&&0==--S&&(_=0)}:function(e,t){const r=y(e.huffmanTableDC),i=0===r?0:b(r);e.pred+=i,t[0]=e.pred;let o=1;for(;o<64;){const r=y(e.huffmanTableAC),i=15&r,s=r>>4;if(0===i){if(s<15)break;o+=16}else t[n[o+=s]]=b(i),o++}};let x,M,R=0;M=1===P?i[0].blocksPerLine*i[0].blocksPerColumn:f*r.mcusPerColumn;const F=o||M;for(;R<M;){for(O=0;O<P;O++)i[O].pred=0;if(S=0,1===P)for(I=i[0],E=0;E<F;E++)k(I,D,R),R++;else for(E=0;E<F;E++){for(O=0;O<P;O++){I=i[O];const{h:e,v:t}=I;for(A=0;A<t;A++)for(C=0;C<e;C++)T(I,D,R,A,C)}if(++R===M)break}if(g=0,(x=e[d]<<8|e[d+1])<65280)throw new Error("marker was not found");if(!(x>=65488&&x<=65495))break;d+=2}return d-h}function g(e,t){const r=[],{blocksPerLine:i,blocksPerColumn:n}=t,d=i<<3,p=new Int32Array(64),g=new Uint8Array(64);function m(e,r,i){const n=t.quantizationTable;let d,p,g,m,y,w,b,v,S;const _=i;let T;for(T=0;T<64;T++)_[T]=e[T]*n[T];for(T=0;T<8;++T){const e=8*T;0!==_[1+e]||0!==_[2+e]||0!==_[3+e]||0!==_[4+e]||0!==_[5+e]||0!==_[6+e]||0!==_[7+e]?(d=u*_[0+e]+128>>8,p=u*_[4+e]+128>>8,g=_[2+e],m=_[6+e],y=h*(_[1+e]-_[7+e])+128>>8,v=h*(_[1+e]+_[7+e])+128>>8,w=_[3+e]<<4,b=_[5+e]<<4,S=d-p+1>>1,d=d+p+1>>1,p=S,S=g*f+m*c+128>>8,g=g*c-m*f+128>>8,m=S,S=y-b+1>>1,y=y+b+1>>1,b=S,S=v+w+1>>1,w=v-w+1>>1,v=S,S=d-m+1>>1,d=d+m+1>>1,m=S,S=p-g+1>>1,p=p+g+1>>1,g=S,S=y*l+v*a+2048>>12,y=y*a-v*l+2048>>12,v=S,S=w*s+b*o+2048>>12,w=w*o-b*s+2048>>12,b=S,_[0+e]=d+v,_[7+e]=d-v,_[1+e]=p+b,_[6+e]=p-b,_[2+e]=g+w,_[5+e]=g-w,_[3+e]=m+y,_[4+e]=m-y):(S=u*_[0+e]+512>>10,_[0+e]=S,_[1+e]=S,_[2+e]=S,_[3+e]=S,_[4+e]=S,_[5+e]=S,_[6+e]=S,_[7+e]=S)}for(T=0;T<8;++T){const e=T;0!==_[8+e]||0!==_[16+e]||0!==_[24+e]||0!==_[32+e]||0!==_[40+e]||0!==_[48+e]||0!==_[56+e]?(d=u*_[0+e]+2048>>12,p=u*_[32+e]+2048>>12,g=_[16+e],m=_[48+e],y=h*(_[8+e]-_[56+e])+2048>>12,v=h*(_[8+e]+_[56+e])+2048>>12,w=_[24+e],b=_[40+e],S=d-p+1>>1,d=d+p+1>>1,p=S,S=g*f+m*c+2048>>12,g=g*c-m*f+2048>>12,m=S,S=y-b+1>>1,y=y+b+1>>1,b=S,S=v+w+1>>1,w=v-w+1>>1,v=S,S=d-m+1>>1,d=d+m+1>>1,m=S,S=p-g+1>>1,p=p+g+1>>1,g=S,S=y*l+v*a+2048>>12,y=y*a-v*l+2048>>12,v=S,S=w*s+b*o+2048>>12,w=w*o-b*s+2048>>12,b=S,_[0+e]=d+v,_[56+e]=d-v,_[8+e]=p+b,_[48+e]=p-b,_[16+e]=g+w,_[40+e]=g-w,_[24+e]=m+y,_[32+e]=m-y):(S=u*i[T+0]+8192>>14,_[0+e]=S,_[8+e]=S,_[16+e]=S,_[24+e]=S,_[32+e]=S,_[40+e]=S,_[48+e]=S,_[56+e]=S)}for(T=0;T<64;++T){const e=128+(_[T]+8>>4);r[T]=e<0?0:e>255?255:e}}for(let e=0;e<n;e++){const n=e<<3;for(let e=0;e<8;e++)r.push(new Uint8Array(d));for(let o=0;o<i;o++){m(t.blocks[e][o],g,p);let i=0;const s=o<<3;for(let e=0;e<8;e++){const t=r[n+e];for(let e=0;e<8;e++)t[s+e]=g[i++]}}}return r}class m{constructor(){this.jfif=null,this.adobe=null,this.quantizationTables=[],this.huffmanTablesAC=[],this.huffmanTablesDC=[],this.resetFrames()}resetFrames(){this.frames=[]}parse(e){let t=0;function r(){const r=e[t]<<8|e[t+1];return t+=2,r}function i(){const i=r(),n=e.subarray(t,t+i-2);return t+=n.length,n}function o(e){let t,r,i=0,n=0;for(r in e.components)e.components.hasOwnProperty(r)&&(i<(t=e.components[r]).h&&(i=t.h),n<t.v&&(n=t.v));const o=Math.ceil(e.samplesPerLine/8/i),s=Math.ceil(e.scanLines/8/n);for(r in e.components)if(e.components.hasOwnProperty(r)){t=e.components[r];const a=Math.ceil(Math.ceil(e.samplesPerLine/8)*t.h/i),l=Math.ceil(Math.ceil(e.scanLines/8)*t.v/n),c=o*t.h,f=s*t.v,u=[];for(let e=0;e<f;e++){const e=[];for(let t=0;t<c;t++)e.push(new Int32Array(64));u.push(e)}t.blocksPerLine=a,t.blocksPerColumn=l,t.blocks=u}e.maxH=i,e.maxV=n,e.mcusPerLine=o,e.mcusPerColumn=s}let s=r();if(65496!==s)throw new Error("SOI not found");for(s=r();65497!==s;){switch(s){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:{const e=i();65504===s&&74===e[0]&&70===e[1]&&73===e[2]&&70===e[3]&&0===e[4]&&(this.jfif={version:{major:e[5],minor:e[6]},densityUnits:e[7],xDensity:e[8]<<8|e[9],yDensity:e[10]<<8|e[11],thumbWidth:e[12],thumbHeight:e[13],thumbData:e.subarray(14,14+3*e[12]*e[13])}),65518===s&&65===e[0]&&100===e[1]&&111===e[2]&&98===e[3]&&101===e[4]&&0===e[5]&&(this.adobe={version:e[6],flags0:e[7]<<8|e[8],flags1:e[9]<<8|e[10],transformCode:e[11]});break}case 65499:{const i=r()+t-2;for(;t<i;){const i=e[t++],o=new Int32Array(64);if(i>>4==0)for(let r=0;r<64;r++)o[n[r]]=e[t++];else{if(i>>4!=1)throw new Error("DQT: invalid table spec");for(let e=0;e<64;e++)o[n[e]]=r()}this.quantizationTables[15&i]=o}break}case 65472:case 65473:case 65474:{r();const i={extended:65473===s,progressive:65474===s,precision:e[t++],scanLines:r(),samplesPerLine:r(),components:{},componentsOrder:[]},n=e[t++];let a;for(let r=0;r<n;r++){a=e[t];const r=e[t+1]>>4,n=15&e[t+1],o=e[t+2];i.componentsOrder.push(a),i.components[a]={h:r,v:n,quantizationIdx:o},t+=3}o(i),this.frames.push(i);break}case 65476:{const i=r();for(let r=2;r<i;){const i=e[t++],n=new Uint8Array(16);let o=0;for(let r=0;r<16;r++,t++)n[r]=e[t],o+=n[r];const s=new Uint8Array(o);for(let r=0;r<o;r++,t++)s[r]=e[t];r+=17+o,i>>4==0?this.huffmanTablesDC[15&i]=d(n,s):this.huffmanTablesAC[15&i]=d(n,s)}break}case 65501:r(),this.resetInterval=r();break;case 65498:{r();const i=e[t++],n=[],o=this.frames[0];for(let r=0;r<i;r++){const r=o.components[e[t++]],i=e[t++];r.huffmanTableDC=this.huffmanTablesDC[i>>4],r.huffmanTableAC=this.huffmanTablesAC[15&i],n.push(r)}const s=e[t++],a=e[t++],l=e[t++],c=p(e,t,o,n,this.resetInterval,s,a,l>>4,15&l);t+=c;break}case 65535:255!==e[t]&&t--;break;default:if(255===e[t-3]&&e[t-2]>=192&&e[t-2]<=254){t-=3;break}throw new Error(`unknown JPEG marker ${s.toString(16)}`)}s=r()}}getResult(){const{frames:e}=this;if(0===this.frames.length)throw new Error("no frames were decoded");this.frames.length>1&&console.warn("more than one frame is not supported");for(let e=0;e<this.frames.length;e++){const t=this.frames[e].components;for(const e of Object.keys(t))t[e].quantizationTable=this.quantizationTables[t[e].quantizationIdx],delete t[e].quantizationIdx}const t=e[0],{components:r,componentsOrder:i}=t,n=[],o=t.samplesPerLine,s=t.scanLines;for(let e=0;e<i.length;e++){const o=r[i[e]];n.push({lines:g(0,o),scaleX:o.h/t.maxH,scaleY:o.v/t.maxV})}const a=new Uint8Array(o*s*n.length);let l=0;for(let e=0;e<s;++e)for(let t=0;t<o;++t)for(let r=0;r<n.length;++r){const i=n[r];a[l]=i.lines[0|e*i.scaleY][0|t*i.scaleX],++l}return a}}class y extends i.default{constructor(e){super(),this.reader=new m,e.JPEGTables&&this.reader.parse(e.JPEGTables)}decodeBlock(e){return this.reader.resetFrames(),this.reader.parse(new Uint8Array(e)),this.reader.getResult().buffer}}r.default=y},{"./basedecoder":"FJDe"}],JAiC:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=e("pako/lib/inflate"),n=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));class o extends n.default{decodeBlock(e){return(0,i.inflate)(new Uint8Array(e)).buffer}}r.default=o},{"./basedecoder":"FJDe"}],OcPz:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("./basedecoder"));class n extends i.default{decodeBlock(e){const t=new DataView(e),r=[];for(let i=0;i<e.byteLength;++i){let e=t.getInt8(i);if(e<0){const n=t.getUint8(i+1);e=-e;for(let t=0;t<=e;++t)r.push(n);i+=1}else{for(let n=0;n<=e;++n)r.push(t.getUint8(i+n+1));i+=e+1}}return new Uint8Array(r).buffer}}r.default=n},{"./basedecoder":"FJDe"}],FGCZ:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getDecoder=function(e){switch(e.Compression){case void 0:case 1:return new i.default;case 5:return new n.default;case 6:throw new Error("old style JPEG compression is not supported.");case 7:return new o.default(e);case 8:case 32946:return new s.default;case 32773:return new a.default;default:throw new Error(`Unknown compression method identifier: ${e.Compression}`)}};var i=l(e("./raw")),n=l(e("./lzw")),o=l(e("./jpeg")),s=l(e("./deflate")),a=l(e("./packbits"));function l(e){return e&&e.__esModule?e:{default:e}}},{"./raw":"V9bQ","./lzw":"tcId","./jpeg":"J7kk","./deflate":"JAiC","./packbits":"OcPz"}],OQju:[function(e,t,r){"use strict";function i(e,t,r,i=1){return new(Object.getPrototypeOf(e).constructor)(t*r*i)}function n(e,t,r,n,o){const s=t/n,a=r/o;return e.map(e=>{const l=i(e,n,o);for(let i=0;i<o;++i){const o=Math.min(Math.round(a*i),r-1);for(let r=0;r<n;++r){const a=Math.min(Math.round(s*r),t-1),c=e[o*t+a];l[i*n+r]=c}}return l})}function o(e,t,r){return(1-r)*e+r*t}function s(e,t,r,n,s){const a=t/n,l=r/s;return e.map(e=>{const c=i(e,n,s);for(let i=0;i<s;++i){const s=l*i,f=Math.floor(s),u=Math.min(Math.ceil(s),r-1);for(let r=0;r<n;++r){const l=a*r,h=l%1,d=Math.floor(l),p=Math.min(Math.ceil(l),t-1),g=e[f*t+d],m=e[f*t+p],y=e[u*t+d],w=e[u*t+p],b=o(o(g,m,h),o(y,w,h),s%1);c[i*n+r]=b}}return c})}function a(e,t,r,n,o,s){const a=t/n,l=r/o,c=i(e,n,o,s);for(let i=0;i<o;++i){const o=Math.min(Math.round(l*i),r-1);for(let r=0;r<n;++r){const l=Math.min(Math.round(a*r),t-1);for(let a=0;a<s;++a){const f=e[o*t*s+l*s+a];c[i*n*s+r*s+a]=f}}}return c}function l(e,t,r,n,s,a){const l=t/n,c=r/s,f=i(e,n,s,a);for(let i=0;i<s;++i){const s=c*i,u=Math.floor(s),h=Math.min(Math.ceil(s),r-1);for(let r=0;r<n;++r){const c=l*r,d=c%1,p=Math.floor(c),g=Math.min(Math.ceil(c),t-1);for(let l=0;l<a;++l){const c=e[u*t*a+p*a+l],m=e[u*t*a+g*a+l],y=e[h*t*a+p*a+l],w=e[h*t*a+g*a+l],b=o(o(c,m,d),o(y,w,d),s%1);f[i*n*a+r*a+l]=b}}}return f}Object.defineProperty(r,"__esModule",{value:!0}),r.resampleNearest=n,r.resampleBilinear=s,r.resample=function(e,t,r,i,o,a="nearest"){switch(a.toLowerCase()){case"nearest":return n(e,t,r,i,o);case"bilinear":case"linear":return s(e,t,r,i,o);default:throw new Error(`Unsupported resampling method: '${a}'`)}},r.resampleNearestInterleaved=a,r.resampleBilinearInterleaved=l,r.resampleInterleaved=function(e,t,r,i,n,o,s="nearest"){switch(s.toLowerCase()){case"nearest":return a(e,t,r,i,n,o);case"bilinear":case"linear":return l(e,t,r,i,n,o);default:throw new Error(`Unsupported resampling method: '${s}'`)}}},{}],eOWo:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=function(e){return e&&e.__esModule?e:{default:e}}(e("txml")),n=e("./globals"),o=e("./rgb"),s=e("./compression"),a=e("./resample");function l(e,t,r){let i=0;for(let n=t;n<r;++n)i+=e[n];return i}function c(e,t,r){switch(e){case 1:switch(t){case 8:return new Uint8Array(r);case 16:return new Uint16Array(r);case 32:return new Uint32Array(r)}break;case 2:switch(t){case 8:return new Int8Array(r);case 16:return new Int16Array(r);case 32:return new Int32Array(r)}break;case 3:switch(t){case 32:return new Float32Array(r);case 64:return new Float64Array(r)}}throw Error("Unsupported data format/bitsPerSample")}var f=class{constructor(e,t,r,i,n,o){this.fileDirectory=e,this.geoKeys=t,this.dataView=r,this.littleEndian=i,this.tiles=n?{}:null,this.isTiled=!e.StripOffsets;const s=e.PlanarConfiguration;if(this.planarConfiguration=void 0===s?1:s,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.");this.source=o}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return this.fileDirectory.SamplesPerPixel}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:void 0!==this.fileDirectory.RowsPerStrip?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBytesPerPixel(){let e=0;for(let t=0;t<this.fileDirectory.BitsPerSample.length;++t){const r=this.fileDirectory.BitsPerSample[t];if(r%8!=0)throw new Error(`Sample bit-width of ${r} is not supported.`);if(r!==this.fileDirectory.BitsPerSample[0])throw new Error("Differing size of samples in a pixel are not supported.");e+=r}return e/8}getSampleByteSize(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${e} is out of range.`);const t=this.fileDirectory.BitsPerSample[e];if(t%8!=0)throw new Error(`Sample bit-width of ${t} is not supported.`);return t/8}getReaderForSample(e){const t=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,r=this.fileDirectory.BitsPerSample[e];switch(t){case 1:switch(r){case 8:return DataView.prototype.getUint8;case 16:return DataView.prototype.getUint16;case 32:return DataView.prototype.getUint32}break;case 2:switch(r){case 8:return DataView.prototype.getInt8;case 16:return DataView.prototype.getInt16;case 32:return DataView.prototype.getInt32}break;case 3:switch(r){case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}throw Error("Unsupported data format/bitsPerSample")}getArrayForSample(e,t){return c(this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,this.fileDirectory.BitsPerSample[e],t)}async getTileOrStrip(e,t,r,i){const n=Math.ceil(this.getWidth()/this.getTileWidth()),o=Math.ceil(this.getHeight()/this.getTileHeight());let s;const{tiles:a}=this;let l,c;1===this.planarConfiguration?s=t*n+e:2===this.planarConfiguration&&(s=r*n*o+t*n+e),this.isTiled?(l=this.fileDirectory.TileOffsets[s],c=this.fileDirectory.TileByteCounts[s]):(l=this.fileDirectory.StripOffsets[s],c=this.fileDirectory.StripByteCounts[s]);const f=await this.source.fetch(l,c);let u;return null===a?u=i.decode(this.fileDirectory,f):a[s]||(u=i.decode(this.fileDirectory,f),a[s]=u),{x:e,y:t,sample:r,data:await u}}async _readRaster(e,t,r,i,n,o,s,c){const f=this.getTileWidth(),u=this.getTileHeight(),h=Math.max(Math.floor(e[0]/f),0),d=Math.min(Math.ceil(e[2]/f),Math.ceil(this.getWidth()/this.getTileWidth())),p=Math.max(Math.floor(e[1]/u),0),g=Math.min(Math.ceil(e[3]/u),Math.ceil(this.getHeight()/this.getTileHeight())),m=e[2]-e[0];let y=this.getBytesPerPixel();const w=[],b=[];for(let e=0;e<t.length;++e)1===this.planarConfiguration?w.push(l(this.fileDirectory.BitsPerSample,0,t[e])/8):w.push(0),b.push(this.getReaderForSample(t[e]));const v=[],{littleEndian:S}=this;for(let o=p;o<g;++o)for(let s=h;s<d;++s)for(let a=0;a<t.length;++a){const l=a,c=t[a];2===this.planarConfiguration&&(y=this.getSampleByteSize(c));const h=this.getTileOrStrip(s,o,c,n);v.push(h),h.then(n=>{const o=n.data,s=new DataView(o),a=n.y*u,c=n.x*f,h=(n.y+1)*u,d=(n.x+1)*f,p=b[l],g=Math.min(u,u-(h-e[3])),v=Math.min(f,f-(d-e[2]));for(let n=Math.max(0,e[1]-a);n<g;++n)for(let o=Math.max(0,e[0]-c);o<v;++o){const u=(n*f+o)*y,h=p.call(s,u+w[l],S);let d;i?(d=(n+a-e[1])*m*t.length+(o+c-e[0])*t.length+l,r[d]=h):(d=(n+a-e[1])*m+o+c-e[0],r[l][d]=h)}})}if(await Promise.all(v),o&&e[2]-e[0]!==o||s&&e[3]-e[1]!==s){let n;return(n=i?(0,a.resampleInterleaved)(r,e[2]-e[0],e[3]-e[1],o,s,t.length,c):(0,a.resample)(r,e[2]-e[0],e[3]-e[1],o,s,c)).width=o,n.height=s,n}return r.width=o||e[2]-e[0],r.height=s||e[3]-e[1],r}async readRasters({window:e,samples:t=[],interleave:r,pool:i=null,width:n,height:o,resampleMethod:a,fillValue:l}={}){const f=e||[0,0,this.getWidth(),this.getHeight()];if(f[0]>f[2]||f[1]>f[3])throw new Error("Invalid subsets");const u=(f[2]-f[0])*(f[3]-f[1]);if(t&&t.length){for(let e=0;e<t.length;++e)if(t[e]>=this.fileDirectory.SamplesPerPixel)return Promise.reject(new RangeError(`Invalid sample index '${t[e]}'.`))}else for(let e=0;e<this.fileDirectory.SamplesPerPixel;++e)t.push(e);let h;if(r)h=c(this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,Math.max.apply(null,this.fileDirectory.BitsPerSample),u*t.length),l&&h.fill(l);else{h=[];for(let e=0;e<t.length;++e){const r=this.getArrayForSample(t[e],u);Array.isArray(l)&&e<l.length?r.fill(l[e]):l&&!Array.isArray(l)&&r.fill(l),h.push(r)}}const d=i||(0,s.getDecoder)(this.fileDirectory);return await this._readRaster(f,t,h,r,d,n,o,a)}async readRGB({window:e,pool:t=null,width:r,height:i,resampleMethod:s,enableAlpha:a=!1}={}){const l=e||[0,0,this.getWidth(),this.getHeight()];if(l[0]>l[2]||l[1]>l[3])throw new Error("Invalid subsets");const c=this.fileDirectory.PhotometricInterpretation;if(c===n.photometricInterpretations.RGB){let o=[0,1,2];if(this.fileDirectory.ExtraSamples!==n.ExtraSamplesValues.Unspecified&&a){o=[];for(let e=0;e<this.fileDirectory.BitsPerSample.length;e+=1)o.push(e)}return this.readRasters({window:e,interleave:!0,samples:o,pool:t,width:r,height:i})}let f;switch(c){case n.photometricInterpretations.WhiteIsZero:case n.photometricInterpretations.BlackIsZero:case n.photometricInterpretations.Palette:f=[0];break;case n.photometricInterpretations.CMYK:f=[0,1,2,3];break;case n.photometricInterpretations.YCbCr:case n.photometricInterpretations.CIELab:f=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const u={window:l,interleave:!0,samples:f,pool:t,width:r,height:i,resampleMethod:s},{fileDirectory:h}=this,d=await this.readRasters(u),p=2**this.fileDirectory.BitsPerSample[0];let g;switch(c){case n.photometricInterpretations.WhiteIsZero:g=(0,o.fromWhiteIsZero)(d,p);break;case n.photometricInterpretations.BlackIsZero:g=(0,o.fromBlackIsZero)(d,p);break;case n.photometricInterpretations.Palette:g=(0,o.fromPalette)(d,h.ColorMap);break;case n.photometricInterpretations.CMYK:g=(0,o.fromCMYK)(d);break;case n.photometricInterpretations.YCbCr:g=(0,o.fromYCbCr)(d);break;case n.photometricInterpretations.CIELab:g=(0,o.fromCIELab)(d);break;default:throw new Error("Unsupported photometric interpretation.")}return g.width=d.width,g.height=d.height,g}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const e=[];for(let t=0;t<this.fileDirectory.ModelTiepoint.length;t+=6)e.push({i:this.fileDirectory.ModelTiepoint[t],j:this.fileDirectory.ModelTiepoint[t+1],k:this.fileDirectory.ModelTiepoint[t+2],x:this.fileDirectory.ModelTiepoint[t+3],y:this.fileDirectory.ModelTiepoint[t+4],z:this.fileDirectory.ModelTiepoint[t+5]});return e}getGDALMetadata(e=null){const t={};if(!this.fileDirectory.GDAL_METADATA)return null;const r=this.fileDirectory.GDAL_METADATA,n=(0,i.default)(r.substring(0,r.length-1));if(!n[0].tagName)throw new Error("Failed to parse GDAL metadata XML.");const o=n[0];if("GDALMetadata"!==o.tagName)throw new Error("Unexpected GDAL metadata XML tag.");let s=o.children.filter(e=>"Item"===e.tagName);e&&(s=s.filter(t=>Number(t.attributes.sample)===e));for(let e=0;e<s.length;++e){const r=s[e];t[r.attributes.name]=r.children[0]}return t}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const e=this.fileDirectory.GDAL_NODATA;return Number(e.substring(0,e.length-1))}getOrigin(){const e=this.fileDirectory.ModelTiepoint,t=this.fileDirectory.ModelTransformation;if(e&&6===e.length)return[e[3],e[4],e[5]];if(t)return[t[3],t[7],t[11]];throw new Error("The image does not have an affine transformation.")}getResolution(e=null){const t=this.fileDirectory.ModelPixelScale,r=this.fileDirectory.ModelTransformation;if(t)return[t[0],-t[1],t[2]];if(r)return[r[0],r[5],r[10]];if(e){const[t,r,i]=e.getResolution();return[t*e.getWidth()/this.getWidth(),r*e.getHeight()/this.getHeight(),i*e.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return 1===this.geoKeys.GTRasterTypeGeoKey}getBoundingBox(){const e=this.getOrigin(),t=this.getResolution(),r=e[0],i=e[1],n=r+t[0]*this.getWidth(),o=i+t[1]*this.getHeight();return[Math.min(r,n),Math.min(i,o),Math.max(r,n),Math.max(i,o)]}};r.default=f},{"./globals":"j27V","./rgb":"fpBl","./compression":"FGCZ","./resample":"OQju"}],dqpX:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=class{constructor(e){this._dataView=new DataView(e)}get buffer(){return this._dataView.buffer}getUint64(e,t){const r=this.getUint32(e,t),i=this.getUint32(e+4,t);return t?r<<32|i:i<<32|r}getInt64(e,t){let r,i;return t?(r=this.getInt32(e,t))<<32|(i=this.getUint32(e+4,t)):(r=this.getUint32(e,t),(i=this.getInt32(e+4,t))<<32|r)}getUint8(e,t){return this._dataView.getUint8(e,t)}getInt8(e,t){return this._dataView.getInt8(e,t)}getUint16(e,t){return this._dataView.getUint16(e,t)}getInt16(e,t){return this._dataView.getInt16(e,t)}getUint32(e,t){return this._dataView.getUint32(e,t)}getInt32(e,t){return this._dataView.getInt32(e,t)}getFloat32(e,t){return this._dataView.getFloat32(e,t)}getFloat64(e,t){return this._dataView.getFloat64(e,t)}}},{}],dGLV:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=class{constructor(e,t,r,i){this._dataView=new DataView(e),this._sliceOffset=t,this._littleEndian=r,this._bigTiff=i}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(e,t){return this.sliceOffset<=e&&this.sliceTop>=e+t}readUint8(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}readInt8(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}readUint16(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}readInt16(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}readUint32(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}readInt32(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}readFloat32(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}readFloat64(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}readUint64(e){const t=this.readUint32(e),r=this.readUint32(e+4);let i;if(this._littleEndian){if(i=t+2**32*r,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}if(i=2**32*t+r,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}readInt64(e){let t,r;if(this._littleEndian){if(t=this.readInt32(e),r=this.readUint32(e+4),combined=t+2**32*r,!Number.isSafeInteger(combined))throw new Error(`${combined} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return combined}if(t=this.readUint32(e-this._sliceOffset),r=this.readInt32(e-this._sliceOffset+4),combined=2**32*t+r,!Number.isSafeInteger(combined))throw new Error(`${combined} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return combined}readOffset(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}},{}],dHPO:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("threads/register");var i=e("threads");const n="undefined"!=typeof navigator?navigator.hardwareConcurrency:null;var o=class{constructor(e=n){const t=new Worker("/decoder.worker.7cb947d7.js");this.pool=(0,i.Pool)(()=>(0,i.spawn)(t),e)}async decode(e,t){return new Promise((r,i)=>{this.pool.queue(async n=>{try{const i=await n(e,t);r(i)}catch(e){i(e)}})})}destroy(){this.pool.terminate(!0)}};r.default=o},{"./decoder.worker.js":[["decoder.worker.7cb947d7.js","LHx9"],"decoder.worker.7cb947d7.js.map","LHx9"]}],cUx7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.makeFetchSource=f,r.makeXHRSource=u,r.makeHttpSource=h,r.makeRemoteSource=function(e,t){const{forceXHR:r}=t;if("function"==typeof fetch&&!r)return f(e,t);if("undefined"!=typeof XMLHttpRequest)return u(e,t);if(o.default.get)return h(e,t);throw new Error("No remote source available")},r.makeBufferSource=function(e){return{fetch:async(t,r)=>e.slice(t,t+r)}},r.makeFileSource=function(e){const t=d(e,"r");return{async fetch(e,r){const n=await t,{buffer:o}=await p(n,i.Buffer.alloc(r),0,r,e);return o.buffer}}},r.makeFileReaderSource=function(e){return{fetch:async(t,r)=>new Promise((i,n)=>{const o=e.slice(t,t+r),s=new FileReader;s.onload=e=>i(e.target.result),s.onerror=n,s.readAsArrayBuffer(o)})}};var i=e("buffer"),n=e("fs"),o=l(e("http")),s=l(e("https")),a=l(e("url"));function l(e){return e&&e.__esModule?e:{default:e}}class c{constructor(e,{blockSize:t=65536}={}){this.retrievalFunction=e,this.blockSize=t,this.blockRequests=new Map,this.blocks=new Map,this.blockIdsAwaitingRequest=null}async fetch(e,t,r=!1){const i=e+t,n=[],o=[],s=[];for(let t=Math.floor(e/this.blockSize)*this.blockSize;t<i;t+=this.blockSize){const e=Math.floor(t/this.blockSize);this.blocks.has(e)||this.blockRequests.has(e)||o.push(e),this.blockRequests.has(e)&&s.push(this.blockRequests.get(e)),n.push(e)}if(this.blockIdsAwaitingRequest)for(let e=0;e<o.length;++e){const t=o[e];this.blockIdsAwaitingRequest.add(t)}else this.blockIdsAwaitingRequest=new Set(o);if(r||await async function(e){return new Promise(t=>setTimeout(t,e))}(),this.blockIdsAwaitingRequest){const e=function(e){if(0===e.length)return[];const t=[];let r=[];t.push(r);for(let i=0;i<e.length;++i)0===i||e[i]===e[i-1]+1?r.push(e[i]):(r=[e[i]],t.push(r));return t}(Array.from(this.blockIdsAwaitingRequest).sort());for(const t of e){const e=this.requestData(t[0]*this.blockSize,t.length*this.blockSize);for(let r=0;r<t.length;++r){const i=t[r];this.blockRequests.set(i,(async()=>{const t=await e,n=r*this.blockSize,o=Math.min(n+this.blockSize,t.data.byteLength),s=t.data.slice(n,o);this.blockRequests.delete(i),this.blocks.set(i,{data:s,offset:t.offset+n,length:s.byteLength,top:t.offset+o})})())}}this.blockIdsAwaitingRequest=null}const a=[];for(const e of o)this.blockRequests.has(e)&&a.push(this.blockRequests.get(e));return await Promise.all(a),await Promise.all(s),function(e,t,r){const i=t+r,n=new ArrayBuffer(r),o=new Uint8Array(n);for(const r of e){const e=r.offset-t,n=r.top-i;let s,a=0,l=0;e<0?a=-e:e>0&&(l=e),n<0?s=r.length-a:n>0&&(s=i-r.offset-a);const c=new Uint8Array(r.data,a,s);o.set(c,l)}return n}(n.map(e=>this.blocks.get(e)),e,t)}async requestData(e,t){const r=await this.retrievalFunction(e,t);return r.length?r.length!==r.data.byteLength&&(r.data=r.data.slice(0,r.length)):r.length=r.data.byteLength,r.top=r.offset+r.length,r}}function f(e,{headers:t={},blockSize:r}={}){return new c(async(r,i)=>{const n=await fetch(e,{headers:{...t,Range:`bytes=${r}-${r+i-1}`}});if(n.ok){if(206===n.status)return{data:n.arrayBuffer?await n.arrayBuffer():(await n.buffer()).buffer,offset:r,length:i};{const e=n.arrayBuffer?await n.arrayBuffer():(await n.buffer()).buffer;return{data:e,offset:0,length:e.byteLength}}}throw new Error("Error fetching data.")},{blockSize:r})}function u(e,{headers:t={},blockSize:r}={}){return new c(async(r,i)=>new Promise((n,o)=>{const s=new XMLHttpRequest;s.open("GET",e),s.responseType="arraybuffer";const a={...t,Range:`bytes=${r}-${r+i-1}`};for(const[e,t]of Object.entries(a))s.setRequestHeader(e,t);s.onload=()=>{const e=s.response;206===s.status?n({data:e,offset:r,length:i}):n({data:e,offset:0,length:e.byteLength})},s.onerror=o,s.send()}),{blockSize:r})}function h(e,{headers:t={},blockSize:r}={}){return new c(async(r,n)=>new Promise((l,c)=>{const f=a.default.parse(e);("http:"===f.protocol?o.default:s.default).get({...f,headers:{...t,Range:`bytes=${r}-${r+n-1}`}},e=>{const t=[];e.on("data",e=>{t.push(e)}),e.on("end",()=>{const e=i.Buffer.concat(t).buffer;l({data:e,offset:r,length:e.byteLength})})}).on("error",c)}),{blockSize:r})}function d(e,t,r){return new Promise((i,o)=>{(0,n.open)(e,t,r,(e,t)=>{e?o(e):i(t)})})}function p(...e){return new Promise((t,r)=>{(0,n.read)(...e,(e,i,n)=>{e?r(e):t({bytesRead:i,buffer:n})})})}},{}],FOZT:[function(e,t,r){"use strict";function i(e){const t=[],{length:r}=e;for(let i=0;i<r;i++)t.push(e[i]);return t}Object.defineProperty(r,"__esModule",{value:!0}),r.assign=function(e,t){for(const r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},r.chunk=function(e,t){const r=[],i=e.length;for(let n=0;n<i;n+=t){const i=[];for(let r=n;r<n+t;r++)i.push(e[r]);r.push(i)}return r},r.endsWith=function(e,t){return!(e.length<t.length)&&e.substr(e.length-t.length)===t},r.forEach=function(e,t){const{length:r}=e;for(let i=0;i<r;i++)t(e[i],i)},r.invert=function(e){const t={};for(const r in e)e.hasOwnProperty(r)&&(t[e[r]]=r);return t},r.range=function(e){const t=[];for(let r=0;r<e;r++)t.push(r);return t},r.times=function(e,t){const r=[];for(let i=0;i<e;i++)r.push(t(i));return r},r.toArray=i,r.toArrayRecursively=function e(t){return t.length?i(t).map(e):t}},{}],BGyE:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.writeGeotiff=function(e,t){let r,o,s,l;"number"==typeof e[0]?(r=t.height||t.ImageLength,s=t.width||t.ImageWidth,o=e.length/(r*s),l=e):(o=e.length,r=e[0].length,s=e[0][0].length,l=[],(0,n.times)(r,t=>{(0,n.times)(s,r=>{(0,n.times)(o,i=>{l.push(e[i][t][r])})})})),t.ImageLength=r,delete t.height,t.ImageWidth=s,delete t.width,t.BitsPerSample||(t.BitsPerSample=(0,n.times)(o,()=>8)),d.forEach(e=>{const r=e[0];if(!t[r]){const i=e[1];t[r]=i}}),t.PhotometricInterpretation||(t.PhotometricInterpretation=3===t.BitsPerSample.length?2:1),t.SamplesPerPixel||(t.SamplesPerPixel=[o]),t.StripByteCounts||(t.StripByteCounts=[o*r*s]),t.ModelPixelScale||(t.ModelPixelScale=[360/s,180/r,0]),t.SampleFormat||(t.SampleFormat=(0,n.times)(o,()=>1));const c=Object.keys(t).filter(e=>(0,n.endsWith)(e,"GeoKey")).sort((e,t)=>a[e]-a[t]);if(!t.GeoKeyDirectory){const e=[1,1,0,c.length];c.forEach(r=>{const n=Number(a[r]);let o,s,l;e.push(n),"SHORT"===i.fieldTagTypes[n]?(o=1,s=0,l=t[r]):"GeogCitationGeoKey"===r?(o=t.GeoAsciiParams.length,s=Number(a.GeoAsciiParams),l=0):console.log(`[geotiff.js] couldn't get TIFFTagLocation for ${r}`),e.push(s),e.push(o),e.push(l)}),t.GeoKeyDirectory=e}for(const e in c)c.hasOwnProperty(e)&&delete t[e];["Compression","ExtraSamples","GeographicTypeGeoKey","GTModelTypeGeoKey","GTRasterTypeGeoKey","ImageLength","ImageWidth","PhotometricInterpretation","PlanarConfiguration","ResolutionUnit","SamplesPerPixel","XPosition","YPosition"].forEach(e=>{t[e]&&(t[e]=(e=>Array.isArray(e)?e:[e])(t[e]))});const f=(e=>{const t={};for(const r in e)"StripOffsets"!==r&&(a[r]||console.error(r,"not in name2code:",Object.keys(a)),t[a[r]]=e[r]);return t})(t);return h(l,s,r,f)};var i=e("./globals"),n=e("./utils");const o=(0,n.invert)(i.fieldTagNames),s=(0,n.invert)(i.geoKeyNames),a={};(0,n.assign)(a,o),(0,n.assign)(a,s);const l=(0,n.invert)(i.fieldTypeNames),c={nextZero:(e,t)=>{let r=t;for(;0!==e[r];)r++;return r},readUshort:(e,t)=>e[t]<<8|e[t+1],readShort:(e,t)=>{const r=c.ui8;return r[0]=e[t+1],r[1]=e[t+0],c.i16[0]},readInt:(e,t)=>{const r=c.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],c.i32[0]},readUint:(e,t)=>{const r=c.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],c.ui32[0]},readASCII:(e,t,r)=>r.map(r=>String.fromCharCode(e[t+r])).join(""),readFloat:(e,t)=>{const r=c.ui8;return(0,n.times)(4,i=>{r[i]=e[t+3-i]}),c.fl32[0]},readDouble:(e,t)=>{const r=c.ui8;return(0,n.times)(8,i=>{r[i]=e[t+7-i]}),c.fl64[0]},writeUshort:(e,t,r)=>{e[t]=r>>8&255,e[t+1]=255&r},writeUint:(e,t,r)=>{e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r>>0&255},writeASCII:(e,t,r)=>{(0,n.times)(r.length,i=>{e[t+i]=r.charCodeAt(i)})},ui8:new Uint8Array(8)};c.fl64=new Float64Array(c.ui8.buffer),c.writeDouble=(e,t,r)=>{c.fl64[0]=r,(0,n.times)(8,r=>{e[t+r]=c.ui8[7-r]})};const f=(e,t,r,o)=>{let s=r;const a=Object.keys(o).filter(e=>null!=e&&"undefined"!==e);e.writeUshort(t,s,a.length);let c=(s+=2)+12*a.length+4;for(const r of a){let a=null;"number"==typeof r?a=r:"string"==typeof r&&(a=parseInt(r,10));const f=i.fieldTagTypes[a],u=l[f];if(null==f||void 0===f||void 0===f)throw new Error(`unknown type of tag: ${a}`);let h=o[r];if(void 0===h)throw new Error(`failed to get value for key ${r}`);"ASCII"===f&&"string"==typeof h&&!1===(0,n.endsWith)(h,"\0")&&(h+="\0");const d=h.length;e.writeUshort(t,s,a),s+=2,e.writeUshort(t,s,u),s+=2,e.writeUint(t,s,d);let p=[-1,1,1,2,4,8,0,0,0,0,0,0,8][u]*d,g=s+=4;p>4&&(e.writeUint(t,s,c),g=c),"ASCII"===f?e.writeASCII(t,g,h):"SHORT"===f?(0,n.times)(d,r=>{e.writeUshort(t,g+2*r,h[r])}):"LONG"===f?(0,n.times)(d,r=>{e.writeUint(t,g+4*r,h[r])}):"RATIONAL"===f?(0,n.times)(d,r=>{e.writeUint(t,g+8*r,Math.round(1e4*h[r])),e.writeUint(t,g+8*r+4,1e4)}):"DOUBLE"===f&&(0,n.times)(d,r=>{e.writeDouble(t,g+8*r,h[r])}),p>4&&(c+=p+=1&p),s+=4}return[s,c]},u=e=>{const t=new Uint8Array(1e3);let r=4;const i=c;t[0]=77,t[1]=77,t[3]=42;let n=8;if(i.writeUint(t,r,n),r+=4,e.forEach((r,o)=>{const s=f(i,t,n,r);n=s[1],o<e.length-1&&i.writeUint(t,s[0],n)}),t.slice)return t.slice(0,n).buffer;const o=new Uint8Array(n);for(let e=0;e<n;e++)o[e]=t[e];return o.buffer},h=(e,t,r,i)=>{if(null==r)throw new Error(`you passed into encodeImage a width of type ${r}`);if(null==t)throw new Error(`you passed into encodeImage a width of type ${t}`);const o={256:[t],257:[r],273:[1e3],278:[r],305:"geotiff.js"};if(i)for(const e in i)i.hasOwnProperty(e)&&(o[e]=i[e]);const s=new Uint8Array(u([o])),a=new Uint8Array(e),l=o[277],c=new Uint8Array(1e3+t*r*l);return(0,n.times)(s.length,e=>{c[e]=s[e]}),(0,n.forEach)(a,(e,t)=>{c[1e3+t]=e}),c.buffer},d=[["Compression",1],["PlanarConfiguration",1],["XPosition",0],["YPosition",0],["ResolutionUnit",1],["ExtraSamples",0],["GeoAsciiParams","WGS 84\0"],["ModelTiepoint",[0,0,0,-180,90,0]],["GTModelTypeGeoKey",2],["GTRasterTypeGeoKey",1],["GeographicTypeGeoKey",4326],["GeogCitationGeoKey","WGS 84"]]},{"./globals":"j27V","./utils":"FOZT"}],bsJs:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.fromUrl=async function(e,t={}){return w.fromSource((0,a.makeRemoteSource)(e,t))},r.fromArrayBuffer=async function(e){return w.fromSource((0,a.makeBufferSource)(e))},r.fromFile=async function(e){return w.fromSource((0,a.makeFileSource)(e))},r.fromBlob=async function(e){return w.fromSource((0,a.makeFileReaderSource)(e))},r.fromUrls=async function(e,t=[],r={}){const i=await w.fromSource((0,a.makeRemoteSource)(e,r)),n=await Promise.all(t.map(e=>w.fromSource((0,a.makeRemoteSource)(e,r))));return new v(i,n)},r.writeArrayBuffer=async function(e,t){return(0,c.writeGeotiff)(e,t)},Object.defineProperty(r,"Pool",{enumerable:!0,get:function(){return s.default}}),r.rgb=r.globals=r.MultiGeoTIFF=r.default=r.GeoTIFF=void 0;var i=d(e("./geotiffimage")),n=d(e("./dataview64")),o=d(e("./dataslice")),s=d(e("./pool")),a=e("./source"),l=h(e("./globals"));r.globals=l;var c=e("./geotiffwriter"),f=h(e("./rgb"));function u(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return u=function(){return e},e}function h(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=u();if(t&&t.has(e))return t.get(e);var r={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=i?Object.getOwnPropertyDescriptor(e,n):null;o&&(o.get||o.set)?Object.defineProperty(r,n,o):r[n]=e[n]}return r.default=e,t&&t.set(e,r),r}function d(e){return e&&e.__esModule?e:{default:e}}function p(e){switch(e){case l.fieldTypes.BYTE:case l.fieldTypes.ASCII:case l.fieldTypes.SBYTE:case l.fieldTypes.UNDEFINED:return 1;case l.fieldTypes.SHORT:case l.fieldTypes.SSHORT:return 2;case l.fieldTypes.LONG:case l.fieldTypes.SLONG:case l.fieldTypes.FLOAT:case l.fieldTypes.IFD:return 4;case l.fieldTypes.RATIONAL:case l.fieldTypes.SRATIONAL:case l.fieldTypes.DOUBLE:case l.fieldTypes.LONG8:case l.fieldTypes.SLONG8:case l.fieldTypes.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${e}`)}}function g(e){const t=e.GeoKeyDirectory;if(!t)return null;const r={};for(let i=4;i<=4*t[3];i+=4){const n=l.geoKeyNames[t[i]],o=t[i+1]?l.fieldTagNames[t[i+1]]:null,s=t[i+2],a=t[i+3];let c=null;if(o){if(null==(c=e[o]))throw new Error(`Could not get value of geoKey '${n}'.`);"string"==typeof c?c=c.substring(a,a+s-1):c.subarray&&(c=c.subarray(a,a+s-1))}else c=a;r[n]=c}return r}function m(e,t,r,i){let n=null,o=null;const s=p(t);switch(t){case l.fieldTypes.BYTE:case l.fieldTypes.ASCII:case l.fieldTypes.UNDEFINED:n=new Uint8Array(r),o=e.readUint8;break;case l.fieldTypes.SBYTE:n=new Int8Array(r),o=e.readInt8;break;case l.fieldTypes.SHORT:n=new Uint16Array(r),o=e.readUint16;break;case l.fieldTypes.SSHORT:n=new Int16Array(r),o=e.readInt16;break;case l.fieldTypes.LONG:case l.fieldTypes.IFD:n=new Uint32Array(r),o=e.readUint32;break;case l.fieldTypes.SLONG:n=new Int32Array(r),o=e.readInt32;break;case l.fieldTypes.LONG8:case l.fieldTypes.IFD8:n=new Array(r),o=e.readUint64;break;case l.fieldTypes.SLONG8:n=new Array(r),o=e.readInt64;break;case l.fieldTypes.RATIONAL:n=new Uint32Array(2*r),o=e.readUint32;break;case l.fieldTypes.SRATIONAL:n=new Int32Array(2*r),o=e.readInt32;break;case l.fieldTypes.FLOAT:n=new Float32Array(r),o=e.readFloat32;break;case l.fieldTypes.DOUBLE:n=new Float64Array(r),o=e.readFloat64;break;default:throw new RangeError(`Invalid field type: ${t}`)}if(t!==l.fieldTypes.RATIONAL&&t!==l.fieldTypes.SRATIONAL)for(let t=0;t<r;++t)n[t]=o.call(e,i+t*s);else for(let t=0;t<r;t+=2)n[t]=o.call(e,i+t*s),n[t+1]=o.call(e,i+(t*s+4));return t===l.fieldTypes.ASCII?String.fromCharCode.apply(null,n):n}r.rgb=f;class y{async readRasters(e={}){const{window:t,width:r,height:i}=e;let{resX:n,resY:o,bbox:s}=e;const a=await this.getImage();let l=a;const c=await this.getImageCount(),f=a.getBoundingBox();if(t&&s)throw new Error('Both "bbox" and "window" passed.');if(r||i){if(t){const[e,r]=a.getOrigin(),[i,n]=a.getResolution();s=[e+t[0]*i,r+t[1]*n,e+t[2]*i,r+t[3]*n]}const e=s||f;if(r){if(n)throw new Error("Both width and resX passed");n=(e[2]-e[0])/r}if(i){if(o)throw new Error("Both width and resY passed");o=(e[3]-e[1])/i}}if(n||o){const e=[];for(let t=0;t<c;++t){const r=await this.getImage(t),{SubfileType:i,NewSubfileType:n}=r.fileDirectory;(0===t||2===i||1&n)&&e.push(r)}e.sort((e,t)=>e.getWidth()-t.getWidth());for(let t=0;t<e.length;++t){const r=e[t],i=(f[2]-f[0])/r.getWidth(),s=(f[3]-f[1])/r.getHeight();if(l=r,n&&n>i||o&&o>s)break}}let u=t;if(s){const[e,t]=a.getOrigin(),[r,i]=l.getResolution(a);u=[Math.round((s[0]-e)/r),Math.round((s[1]-t)/i),Math.round((s[2]-e)/r),Math.round((s[3]-t)/i)],u=[Math.min(u[0],u[2]),Math.min(u[1],u[3]),Math.max(u[0],u[2]),Math.max(u[1],u[3])]}return l.readRasters({...e,window:u})}}class w extends y{constructor(e,t,r,i,n={}){super(),this.source=e,this.littleEndian=t,this.bigTiff=r,this.firstIFDOffset=i,this.cache=n.cache||!1,this.fileDirectories=null,this.fileDirectoriesParsing=null,this.ghostValues=null}async getSlice(e,t){const r=this.bigTiff?4048:1024;return new o.default(await this.source.fetch(e,void 0!==t?t:r),e,this.littleEndian,this.bigTiff)}async parseFileDirectories(){let e=this.firstIFDOffset;const t=this.bigTiff?8:2,r=this.bigTiff?20:12,i=[];for(;0!==e;){let n=await this.getSlice(e);const o=this.bigTiff?n.readUint64(e):n.readUint16(e),s=o*r+(this.bigTiff?16:6);n.covers(e,s)||(n=await this.getSlice(e,s));const a={};let c=e+(this.bigTiff?8:2);for(let e=0;e<o;c+=r,++e){const e=n.readUint16(c),t=n.readUint16(c+2),r=this.bigTiff?n.readUint64(c+4):n.readUint32(c+4);let i,o;const s=p(t),f=c+(this.bigTiff?12:8);if(s*r<=(this.bigTiff?8:4))i=m(n,t,r,f);else{const e=n.readOffset(f),o=p(t)*r;i=n.covers(e,o)?m(n,t,r,e):m(await this.getSlice(e,o),t,r,e)}o=1===r&&-1===l.arrayFields.indexOf(e)&&t!==l.fieldTypes.RATIONAL&&t!==l.fieldTypes.SRATIONAL?i[0]:i,a[l.fieldTagNames[e]]=o}i.push([a,g(a)]),e=n.readOffset(e+t+r*o)}return i}async getImage(e=0){this.fileDirectories||(this.fileDirectoriesParsing||(this.fileDirectoriesParsing=this.parseFileDirectories()),this.fileDirectories=await this.fileDirectoriesParsing);const t=this.fileDirectories[e];if(!t)throw new RangeError("Invalid image index");return new i.default(t[0],t[1],this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){return this.fileDirectories||(this.fileDirectoriesParsing||(this.fileDirectoriesParsing=this.parseFileDirectories()),this.fileDirectories=await this.fileDirectoriesParsing),this.fileDirectories.length}async getGhostValues(){const e=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const t="GDAL_STRUCTURAL_METADATA_SIZE=",r=t.length+100;let i=await this.getSlice(e,r);if(t===m(i,l.fieldTypes.ASCII,t.length,e)){const t=m(i,l.fieldTypes.ASCII,r,e).split("\n")[0],n=Number(t.split("=")[1].split(" ")[0])+t.length;n>r&&(i=await this.getSlice(e,n));const o=m(i,l.fieldTypes.ASCII,n,e);this.ghostValues={},o.split("\n").filter(e=>e.length>0).map(e=>e.split("=")).forEach(([e,t])=>{this.ghostValues[e]=t})}return this.ghostValues}static async fromSource(e,t){const r=await e.fetch(0,1024),i=new n.default(r),o=i.getUint16(0,0);let s;if(18761===o)s=!0;else{if(19789!==o)throw new TypeError("Invalid byte order value.");s=!1}const a=i.getUint16(2,s);let l;if(42===a)l=!1;else{if(43!==a)throw new TypeError("Invalid magic number.");if(l=!0,8!==i.getUint16(4,s))throw new Error("Unsupported offset byte-size.")}const c=l?i.getUint64(8,s):i.getUint32(4,s);return new w(e,s,l,c,t)}}r.GeoTIFF=w;var b=w;r.default=b;class v extends y{constructor(e,t){super(),this.mainFile=e,this.overviewFiles=t,this.imageFiles=[e].concat(t),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const e=[this.mainFile.parseFileDirectories()].concat(this.overviewFiles.map(e=>e.parseFileDirectories()));return this.fileDirectoriesPerFile=await Promise.all(e),this.fileDirectoriesPerFile}async getImage(e=0){this.fileDirectoriesPerFile||(this.fileDirectoriesPerFileParsing||(this.fileDirectoriesPerFileParsing=this.parseFileDirectoriesPerFile()),this.fileDirectoriesPerFile=await this.fileDirectoriesPerFileParsing);let t=e;for(let e=0;e<this.fileDirectoriesPerFile.length;++e){const r=this.fileDirectoriesPerFile[e];if(t<r.length){const n=this.imageFiles[e];return new i.default(r[t][0],r[t][1],n.dataView,n.littleEndian,n.cache,n.source)}t-=r.length}throw new RangeError("Invalid image index")}async getImageCount(){return this.fileDirectoriesPerFile||(this.fileDirectoriesPerFileParsing||(this.fileDirectoriesPerFileParsing=this.parseFileDirectoriesPerFile()),this.fileDirectoriesPerFile=await this.fileDirectoriesPerFileParsing),this.fileDirectoriesPerFile.reduce((e,t)=>e+t.length,0)}}r.MultiGeoTIFF=v},{"./geotiffimage":"eOWo","./dataview64":"dqpX","./dataslice":"dGLV","./pool":"dHPO","./source":"cUx7","./globals":"j27V","./geotiffwriter":"BGyE","./rgb":"fpBl"}],epB2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("./geotiff");Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return i[e]}})}))},{"./geotiff":"bsJs"}]},{},["epB2"])},function(e,t){function r(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=41},function(e,t,r){var i=r(43).Transform,n=r(3).inherits;function o(e){i.call(this,e),this._destroyed=!1}function s(e,t,r){r(null,e)}function a(e){return function(t,r,i){return"function"==typeof t&&(i=r,r=t,t={}),"function"!=typeof r&&(r=s),"function"!=typeof i&&(i=null),e(t,r,i)}}n(o,i),o.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var t=this;process.nextTick((function(){e&&t.emit("error",e),t.emit("close")}))}},e.exports=a((function(e,t,r){var i=new o(e);return i._transform=t,r&&(i._flush=r),i})),e.exports.ctor=a((function(e,t,r){function i(t){if(!(this instanceof i))return new i(t);this.options=Object.assign({},e,t),o.call(this,this.options)}return n(i,o),i.prototype._transform=t,r&&(i.prototype._flush=r),i})),e.exports.obj=a((function(e,t,r){var i=new o(Object.assign({objectMode:!0,highWaterMark:16},e));return i._transform=t,r&&(i._flush=r),i}))},function(e,t,r){var i=r(19);"disable"===process.env.READABLE_STREAM&&i?(e.exports=i,(t=e.exports=i.Readable).Readable=i.Readable,t.Writable=i.Writable,t.Duplex=i.Duplex,t.Transform=i.Transform,t.PassThrough=i.PassThrough,t.Stream=i):((t=e.exports=r(20)).Stream=i||t,t.Readable=t,t.Writable=r(23),t.Duplex=r(4),t.Transform=r(25),t.PassThrough=r(48))},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},function(e,t,r){"use strict";var i=r(10).Buffer,n=r(3);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return i.alloc(0);if(1===this.length)return this.head.data;for(var t,r,n,o=i.allocUnsafe(e>>>0),s=this.head,a=0;s;)t=s.data,r=o,n=a,t.copy(r,n),a+=s.data.length,s=s.next;return o},e}(),n&&n.inspect&&n.inspect.custom&&(e.exports.prototype[n.inspect.custom]=function(){var e=n.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t,r){e.exports=r(3).deprecate},function(e,t,r){"use strict";e.exports=o;var i=r(25),n=Object.create(r(5));function o(e){if(!(this instanceof o))return new o(e);i.call(this,e)}n.inherits=r(6),n.inherits(o,i),o.prototype._transform=function(e,t,r){r(null,e)}},function(e,t,r){"use strict";var i=r(11),n=r(50),o=r(51),s=r(52),a=r(53);function l(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function c(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function f(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new i.Buf32(852),t.distcode=t.distdyn=new i.Buf32(592),t.sane=1,t.back=-1,0):-2}function u(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,f(e)):-2}function h(e,t){var r,i;return e&&e.state?(i=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?-2:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=r,i.wbits=t,u(e))):-2}function d(e,t){var r,i;return e?(i=new c,e.state=i,i.window=null,0!==(r=h(e,t))&&(e.state=null),r):-2}var p,g,m=!0;function y(e){if(m){var t;for(p=new i.Buf32(512),g=new i.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(a(1,e.lens,0,288,p,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;a(2,e.lens,0,32,g,0,e.work,{bits:5}),m=!1}e.lencode=p,e.lenbits=9,e.distcode=g,e.distbits=5}function w(e,t,r,n){var o,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new i.Buf8(s.wsize)),n>=s.wsize?(i.arraySet(s.window,t,r-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((o=s.wsize-s.wnext)>n&&(o=n),i.arraySet(s.window,t,r-n,o,s.wnext),(n-=o)?(i.arraySet(s.window,t,r-n,n,0),s.wnext=n,s.whave=s.wsize):(s.wnext+=o,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=o))),0}t.inflateReset=u,t.inflateReset2=h,t.inflateResetKeep=f,t.inflateInit=function(e){return d(e,15)},t.inflateInit2=d,t.inflate=function(e,t){var r,c,f,u,h,d,p,g,m,b,v,S,_,T,k,P,I,O,A,C,E,D,x,M,R=0,F=new i.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(r=e.state).mode&&(r.mode=13),h=e.next_out,f=e.output,p=e.avail_out,u=e.next_in,c=e.input,d=e.avail_in,g=r.hold,m=r.bits,b=d,v=p,D=0;e:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;m<16;){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}if(2&r.wrap&&35615===g){r.check=0,F[0]=255&g,F[1]=g>>>8&255,r.check=o(r.check,F,2,0),g=0,m=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&g)<<8)+(g>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&g)){e.msg="unknown compression method",r.mode=30;break}if(m-=4,E=8+(15&(g>>>=4)),0===r.wbits)r.wbits=E;else if(E>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<E,e.adler=r.check=1,r.mode=512&g?10:12,g=0,m=0;break;case 2:for(;m<16;){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}if(r.flags=g,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=g>>8&1),512&r.flags&&(F[0]=255&g,F[1]=g>>>8&255,r.check=o(r.check,F,2,0)),g=0,m=0,r.mode=3;case 3:for(;m<32;){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}r.head&&(r.head.time=g),512&r.flags&&(F[0]=255&g,F[1]=g>>>8&255,F[2]=g>>>16&255,F[3]=g>>>24&255,r.check=o(r.check,F,4,0)),g=0,m=0,r.mode=4;case 4:for(;m<16;){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}r.head&&(r.head.xflags=255&g,r.head.os=g>>8),512&r.flags&&(F[0]=255&g,F[1]=g>>>8&255,r.check=o(r.check,F,2,0)),g=0,m=0,r.mode=5;case 5:if(1024&r.flags){for(;m<16;){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}r.length=g,r.head&&(r.head.extra_len=g),512&r.flags&&(F[0]=255&g,F[1]=g>>>8&255,r.check=o(r.check,F,2,0)),g=0,m=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&((S=r.length)>d&&(S=d),S&&(r.head&&(E=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),i.arraySet(r.head.extra,c,u,S,E)),512&r.flags&&(r.check=o(r.check,c,S,u)),d-=S,u+=S,r.length-=S),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===d)break e;S=0;do{E=c[u+S++],r.head&&E&&r.length<65536&&(r.head.name+=String.fromCharCode(E))}while(E&&S<d);if(512&r.flags&&(r.check=o(r.check,c,S,u)),d-=S,u+=S,E)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===d)break e;S=0;do{E=c[u+S++],r.head&&E&&r.length<65536&&(r.head.comment+=String.fromCharCode(E))}while(E&&S<d);if(512&r.flags&&(r.check=o(r.check,c,S,u)),d-=S,u+=S,E)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;m<16;){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}if(g!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}g=0,m=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;m<32;){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}e.adler=r.check=l(g),g=0,m=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=h,e.avail_out=p,e.next_in=u,e.avail_in=d,r.hold=g,r.bits=m,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){g>>>=7&m,m-=7&m,r.mode=27;break}for(;m<3;){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}switch(r.last=1&g,m-=1,3&(g>>>=1)){case 0:r.mode=14;break;case 1:if(y(r),r.mode=20,6===t){g>>>=2,m-=2;break e}break;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}g>>>=2,m-=2;break;case 14:for(g>>>=7&m,m-=7&m;m<32;){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}if((65535&g)!=(g>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&g,g=0,m=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(S=r.length){if(S>d&&(S=d),S>p&&(S=p),0===S)break e;i.arraySet(f,c,u,S,h),d-=S,u+=S,p-=S,h+=S,r.length-=S;break}r.mode=12;break;case 17:for(;m<14;){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}if(r.nlen=257+(31&g),g>>>=5,m-=5,r.ndist=1+(31&g),g>>>=5,m-=5,r.ncode=4+(15&g),g>>>=4,m-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;m<3;){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}r.lens[U[r.have++]]=7&g,g>>>=3,m-=3}for(;r.have<19;)r.lens[U[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,x={bits:r.lenbits},D=a(0,r.lens,0,19,r.lencode,0,r.work,x),r.lenbits=x.bits,D){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;P=(R=r.lencode[g&(1<<r.lenbits)-1])>>>16&255,I=65535&R,!((k=R>>>24)<=m);){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}if(I<16)g>>>=k,m-=k,r.lens[r.have++]=I;else{if(16===I){for(M=k+2;m<M;){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}if(g>>>=k,m-=k,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}E=r.lens[r.have-1],S=3+(3&g),g>>>=2,m-=2}else if(17===I){for(M=k+3;m<M;){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}m-=k,E=0,S=3+(7&(g>>>=k)),g>>>=3,m-=3}else{for(M=k+7;m<M;){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}m-=k,E=0,S=11+(127&(g>>>=k)),g>>>=7,m-=7}if(r.have+S>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;S--;)r.lens[r.have++]=E}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,x={bits:r.lenbits},D=a(1,r.lens,0,r.nlen,r.lencode,0,r.work,x),r.lenbits=x.bits,D){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,x={bits:r.distbits},D=a(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,x),r.distbits=x.bits,D){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(d>=6&&p>=258){e.next_out=h,e.avail_out=p,e.next_in=u,e.avail_in=d,r.hold=g,r.bits=m,s(e,v),h=e.next_out,f=e.output,p=e.avail_out,u=e.next_in,c=e.input,d=e.avail_in,g=r.hold,m=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;P=(R=r.lencode[g&(1<<r.lenbits)-1])>>>16&255,I=65535&R,!((k=R>>>24)<=m);){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}if(P&&0==(240&P)){for(O=k,A=P,C=I;P=(R=r.lencode[C+((g&(1<<O+A)-1)>>O)])>>>16&255,I=65535&R,!(O+(k=R>>>24)<=m);){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}g>>>=O,m-=O,r.back+=O}if(g>>>=k,m-=k,r.back+=k,r.length=I,0===P){r.mode=26;break}if(32&P){r.back=-1,r.mode=12;break}if(64&P){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&P,r.mode=22;case 22:if(r.extra){for(M=r.extra;m<M;){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}r.length+=g&(1<<r.extra)-1,g>>>=r.extra,m-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;P=(R=r.distcode[g&(1<<r.distbits)-1])>>>16&255,I=65535&R,!((k=R>>>24)<=m);){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}if(0==(240&P)){for(O=k,A=P,C=I;P=(R=r.distcode[C+((g&(1<<O+A)-1)>>O)])>>>16&255,I=65535&R,!(O+(k=R>>>24)<=m);){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}g>>>=O,m-=O,r.back+=O}if(g>>>=k,m-=k,r.back+=k,64&P){e.msg="invalid distance code",r.mode=30;break}r.offset=I,r.extra=15&P,r.mode=24;case 24:if(r.extra){for(M=r.extra;m<M;){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}r.offset+=g&(1<<r.extra)-1,g>>>=r.extra,m-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===p)break e;if(S=v-p,r.offset>S){if((S=r.offset-S)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}S>r.wnext?(S-=r.wnext,_=r.wsize-S):_=r.wnext-S,S>r.length&&(S=r.length),T=r.window}else T=f,_=h-r.offset,S=r.length;S>p&&(S=p),p-=S,r.length-=S;do{f[h++]=T[_++]}while(--S);0===r.length&&(r.mode=21);break;case 26:if(0===p)break e;f[h++]=r.length,p--,r.mode=21;break;case 27:if(r.wrap){for(;m<32;){if(0===d)break e;d--,g|=c[u++]<<m,m+=8}if(v-=p,e.total_out+=v,r.total+=v,v&&(e.adler=r.check=r.flags?o(r.check,f,v,h-v):n(r.check,f,v,h-v)),v=p,(r.flags?g:l(g))!==r.check){e.msg="incorrect data check",r.mode=30;break}g=0,m=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;m<32;){if(0===d)break e;d--,g+=c[u++]<<m,m+=8}if(g!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}g=0,m=0}r.mode=29;case 29:D=1;break e;case 30:D=-3;break e;case 31:return-4;case 32:default:return-2}return e.next_out=h,e.avail_out=p,e.next_in=u,e.avail_in=d,r.hold=g,r.bits=m,(r.wsize||v!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&w(e,e.output,e.next_out,v-e.avail_out)?(r.mode=31,-4):(b-=e.avail_in,v-=e.avail_out,e.total_in+=b,e.total_out+=v,r.total+=v,r.wrap&&v&&(e.adler=r.check=r.flags?o(r.check,f,v,e.next_out-v):n(r.check,f,v,e.next_out-v)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0===b&&0===v||4===t)&&0===D&&(D=-5),D)},t.inflateEnd=function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},t.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?-2:(r.head=t,t.done=!1,0):-2},t.inflateSetDictionary=function(e,t){var r,i=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?-2:11===r.mode&&n(1,t,i,0)!==r.check?-3:w(e,t,i,i)?(r.mode=31,-4):(r.havedict=1,0):-2},t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,r){"use strict";e.exports=function(e,t,r,i){for(var n=65535&e|0,o=e>>>16&65535|0,s=0;0!==r;){r-=s=r>2e3?2e3:r;do{o=o+(n=n+t[i++]|0)|0}while(--s);n%=65521,o%=65521}return n|o<<16|0}},function(e,t,r){"use strict";var i=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();e.exports=function(e,t,r,n){var o=i,s=n+r;e^=-1;for(var a=n;a<s;a++)e=e>>>8^o[255&(e^t[a])];return-1^e}},function(e,t,r){"use strict";e.exports=function(e,t){var r,i,n,o,s,a,l,c,f,u,h,d,p,g,m,y,w,b,v,S,_,T,k,P,I;r=e.state,i=e.next_in,P=e.input,n=i+(e.avail_in-5),o=e.next_out,I=e.output,s=o-(t-e.avail_out),a=o+(e.avail_out-257),l=r.dmax,c=r.wsize,f=r.whave,u=r.wnext,h=r.window,d=r.hold,p=r.bits,g=r.lencode,m=r.distcode,y=(1<<r.lenbits)-1,w=(1<<r.distbits)-1;e:do{p<15&&(d+=P[i++]<<p,p+=8,d+=P[i++]<<p,p+=8),b=g[d&y];t:for(;;){if(d>>>=v=b>>>24,p-=v,0===(v=b>>>16&255))I[o++]=65535&b;else{if(!(16&v)){if(0==(64&v)){b=g[(65535&b)+(d&(1<<v)-1)];continue t}if(32&v){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}S=65535&b,(v&=15)&&(p<v&&(d+=P[i++]<<p,p+=8),S+=d&(1<<v)-1,d>>>=v,p-=v),p<15&&(d+=P[i++]<<p,p+=8,d+=P[i++]<<p,p+=8),b=m[d&w];r:for(;;){if(d>>>=v=b>>>24,p-=v,!(16&(v=b>>>16&255))){if(0==(64&v)){b=m[(65535&b)+(d&(1<<v)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(_=65535&b,p<(v&=15)&&(d+=P[i++]<<p,(p+=8)<v&&(d+=P[i++]<<p,p+=8)),(_+=d&(1<<v)-1)>l){e.msg="invalid distance too far back",r.mode=30;break e}if(d>>>=v,p-=v,_>(v=o-s)){if((v=_-v)>f&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(T=0,k=h,0===u){if(T+=c-v,v<S){S-=v;do{I[o++]=h[T++]}while(--v);T=o-_,k=I}}else if(u<v){if(T+=c+u-v,(v-=u)<S){S-=v;do{I[o++]=h[T++]}while(--v);if(T=0,u<S){S-=v=u;do{I[o++]=h[T++]}while(--v);T=o-_,k=I}}}else if(T+=u-v,v<S){S-=v;do{I[o++]=h[T++]}while(--v);T=o-_,k=I}for(;S>2;)I[o++]=k[T++],I[o++]=k[T++],I[o++]=k[T++],S-=3;S&&(I[o++]=k[T++],S>1&&(I[o++]=k[T++]))}else{T=o-_;do{I[o++]=I[T++],I[o++]=I[T++],I[o++]=I[T++],S-=3}while(S>2);S&&(I[o++]=I[T++],S>1&&(I[o++]=I[T++]))}break}}break}}while(i<n&&o<a);i-=S=p>>3,d&=(1<<(p-=S<<3))-1,e.next_in=i,e.next_out=o,e.avail_in=i<n?n-i+5:5-(i-n),e.avail_out=o<a?a-o+257:257-(o-a),r.hold=d,r.bits=p}},function(e,t,r){"use strict";var i=r(11),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,r,l,c,f,u,h){var d,p,g,m,y,w,b,v,S,_=h.bits,T=0,k=0,P=0,I=0,O=0,A=0,C=0,E=0,D=0,x=0,M=null,R=0,F=new i.Buf16(16),U=new i.Buf16(16),G=null,L=0;for(T=0;T<=15;T++)F[T]=0;for(k=0;k<l;k++)F[t[r+k]]++;for(O=_,I=15;I>=1&&0===F[I];I--);if(O>I&&(O=I),0===I)return c[f++]=20971520,c[f++]=20971520,h.bits=1,0;for(P=1;P<I&&0===F[P];P++);for(O<P&&(O=P),E=1,T=1;T<=15;T++)if(E<<=1,(E-=F[T])<0)return-1;if(E>0&&(0===e||1!==I))return-1;for(U[1]=0,T=1;T<15;T++)U[T+1]=U[T]+F[T];for(k=0;k<l;k++)0!==t[r+k]&&(u[U[t[r+k]]++]=k);if(0===e?(M=G=u,w=19):1===e?(M=n,R-=257,G=o,L-=257,w=256):(M=s,G=a,w=-1),x=0,k=0,T=P,y=f,A=O,C=0,g=-1,m=(D=1<<O)-1,1===e&&D>852||2===e&&D>592)return 1;for(;;){b=T-C,u[k]<w?(v=0,S=u[k]):u[k]>w?(v=G[L+u[k]],S=M[R+u[k]]):(v=96,S=0),d=1<<T-C,P=p=1<<A;do{c[y+(x>>C)+(p-=d)]=b<<24|v<<16|S|0}while(0!==p);for(d=1<<T-1;x&d;)d>>=1;if(0!==d?(x&=d-1,x+=d):x=0,k++,0==--F[T]){if(T===I)break;T=t[r+u[k]]}if(T>O&&(x&m)!==g){for(0===C&&(C=O),y+=P,E=1<<(A=T-C);A+C<I&&!((E-=F[A+C])<=0);)A++,E<<=1;if(D+=1<<A,1===e&&D>852||2===e&&D>592)return 1;c[g=x&m]=O<<24|A<<16|y-f|0}}return 0!==x&&(c[y+x]=T-C<<24|64<<16|0),h.bits=O,0}},function(e,t,r){"use strict";var i=r(11),n=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(e){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){o=!1}for(var s=new i.Buf8(256),a=0;a<256;a++)s[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1;function l(e,t){if(t<65534&&(e.subarray&&o||!e.subarray&&n))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var r="",s=0;s<t;s++)r+=String.fromCharCode(e[s]);return r}s[254]=s[254]=1,t.string2buf=function(e){var t,r,n,o,s,a=e.length,l=0;for(o=0;o<a;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(n=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(n-56320),o++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new i.Buf8(l),s=0,o=0;s<l;o++)55296==(64512&(r=e.charCodeAt(o)))&&o+1<a&&56320==(64512&(n=e.charCodeAt(o+1)))&&(r=65536+(r-55296<<10)+(n-56320),o++),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|63&r):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|63&r):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|63&r);return t},t.buf2binstring=function(e){return l(e,e.length)},t.binstring2buf=function(e){for(var t=new i.Buf8(e.length),r=0,n=t.length;r<n;r++)t[r]=e.charCodeAt(r);return t},t.buf2string=function(e,t){var r,i,n,o,a=t||e.length,c=new Array(2*a);for(i=0,r=0;r<a;)if((n=e[r++])<128)c[i++]=n;else if((o=s[n])>4)c[i++]=65533,r+=o-1;else{for(n&=2===o?31:3===o?15:7;o>1&&r<a;)n=n<<6|63&e[r++],o--;o>1?c[i++]=65533:n<65536?c[i++]=n:(n-=65536,c[i++]=55296|n>>10&1023,c[i++]=56320|1023&n)}return l(c,i)},t.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;r>=0&&128==(192&e[r]);)r--;return r<0||0===r?t:r+s[e[r]]>t?r:t}},function(e,t,r){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,r){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(e,t,r){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(e,t,r){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},function(e,t){function r(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}r.keys=function(){return[]},r.resolve=r,e.exports=r,r.id=59},function(e,t,r){"use strict";(function(t){var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=r(7),s=r(61).fork,a=o.join(t,"worker.js"),l=/^(error|message)$/,c={inspect:9229,debug:5858},f={min:1,max:300},u=function(){function e(t){var r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{cwd:process.cwd()};n(this,e);var l="function"==typeof t,u=l?t.toString():t;o.cwd||(o.cwd=process.cwd());var h=process.execArgv.filter((function(e){return/(debug|inspect)/.test(e)}));if(h.length>0&&!o.noDebugRedirection){o.execArgv||(h=Array.from(process.execArgv),o.execArgv=[]);var d=h.findIndex((function(e){return/^--inspect(-brk)?(=\d+)?$/.test(e)})),p=h.findIndex((function(e){return/^--debug(-brk)?(=\d+)?$/.test(e)})),g=d>=0?d:p;if(g>=0){var m=/^--(debug|inspect)(?:-brk)?(?:=(\d+))?$/.exec(h[g]),y=c[m[1]];m[2]&&(y=parseInt(m[2])),h[g]="--"+m[1]+"="+(y+f.min+Math.floor(Math.random()*(f.max-f.min))),p>=0&&p!==g&&(m=/^(--debug)(?:-brk)?(.*)/.exec(h[p]),h[p]=m[1]+(m[2]?m[2]:""))}o.execArgv=o.execArgv.concat(h)}delete o.noDebugRedirection,this.child=s(a,i,o),this.onerror=void 0,this.onmessage=void 0,this.child.on("error",(function(e){r.onerror&&r.onerror.call(r,e)})),this.child.on("message",(function(e){var t=JSON.parse(e),i=void 0;!t.error&&r.onmessage&&r.onmessage.call(r,t),t.error&&r.onerror&&((i=new Error(t.error)).stack=t.stack,r.onerror.call(r,i))})),this.child.send({input:u,isfn:l,cwd:o.cwd,esm:o.esm})}return i(e,[{key:"addEventListener",value:function(e,t){l.test(e)&&(this["on"+e]=t)}},{key:"postMessage",value:function(e){this.child.send(JSON.stringify({data:e},null,0))}},{key:"terminate",value:function(){this.child.kill("SIGINT")}}],[{key:"setRange",value:function(e,t){return!(e>=t)&&(f.min=e,f.max=t,!0)}}]),e}();e.exports=u}).call(this,"/")},function(e,t){e.exports=require("child_process")},function(e,t,r){t.log=function(...e){return"object"==typeof console&&console.log&&console.log(...e)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let i=0,n=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(i++,"%c"===e&&(n=i))}),t.splice(n,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=r(26)(t);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},function(e,t){var r=1e3,i=6e4,n=60*i,o=24*n;function s(e,t,r,i){var n=t>=1.5*r;return Math.round(e/r)+" "+i+(n?"s":"")}e.exports=function(e,t){t=t||{};var a=typeof e;if("string"===a&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*n;case"minutes":case"minute":case"mins":case"min":case"m":return s*i;case"seconds":case"second":case"secs":case"sec":case"s":return s*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===a&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=o)return s(e,t,o,"day");if(t>=n)return s(e,t,n,"hour");if(t>=i)return s(e,t,i,"minute");if(t>=r)return s(e,t,r,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=o)return Math.round(e/o)+"d";if(t>=n)return Math.round(e/n)+"h";if(t>=i)return Math.round(e/i)+"m";if(t>=r)return Math.round(e/r)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,r){const i=r(65),n=r(3);t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let i=0;i<r.length;i++)e.inspectOpts[r[i]]=t.inspectOpts[r[i]]},t.log=function(...e){return process.stderr.write(n.format(...e)+"\n")},t.formatArgs=function(r){const{namespace:i,useColors:n}=this;if(n){const t=this.color,n="[3"+(t<8?t:"8;5;"+t),o=`  ${n};1m${i} [0m`;r[0]=o+r[0].split("\n").join("\n"+o),r.push(n+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+i+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):i.isatty(process.stderr.fd)},t.colors=[6,2,3,4,5,1];try{const e=r(66);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter(e=>/^debug_/i.test(e)).reduce((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,(e,t)=>t.toUpperCase());let i=process.env[t];return i=!!/^(yes|on|true|enabled)$/i.test(i)||!/^(no|off|false|disabled)$/i.test(i)&&("null"===i?null:Number(i)),e[r]=i,e},{}),e.exports=r(26)(t);const{formatters:o}=e.exports;o.o=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts).replace(/\s*\n\s*/g," ")},o.O=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts)}},function(e,t){e.exports=require("tty")},function(e,t,r){"use strict";const i=r(16),n=r(67),{env:o}=process;let s;function a(e){return function(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}(function(e){if(0===s)return 0;if(n("color=16m")||n("color=full")||n("color=truecolor"))return 3;if(n("color=256"))return 2;if(e&&!e.isTTY&&void 0===s)return 0;const t=s||0;if("dumb"===o.TERM)return t;if("win32"===process.platform){const e=i.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in o)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(e=>e in o)||"codeship"===o.CI_NAME?1:t;if("TEAMCITY_VERSION"in o)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION)?1:0;if("truecolor"===o.COLORTERM)return 3;if("TERM_PROGRAM"in o){const e=parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(o.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)||"COLORTERM"in o?1:t}(e))}n("no-color")||n("no-colors")||n("color=false")||n("color=never")?s=0:(n("color")||n("colors")||n("color=true")||n("color=always"))&&(s=1),"FORCE_COLOR"in o&&(s=!0===o.FORCE_COLOR||"true"===o.FORCE_COLOR?1:!1===o.FORCE_COLOR||"false"===o.FORCE_COLOR?0:0===o.FORCE_COLOR.length?1:Math.min(parseInt(o.FORCE_COLOR,10),3)),e.exports={supportsColor:a,stdout:a(process.stdout),stderr:a(process.stderr)}},function(e,t,r){"use strict";e.exports=(e,t)=>{t=t||process.argv;const r=e.startsWith("-")?"":1===e.length?"-":"--",i=t.indexOf(r+e),n=t.indexOf("--");return-1!==i&&(-1===n||i<n)}},function(e,t,r){"use strict";function i(e,t){if("undefined"==typeof ImageData)throw"toCanvas is not supported in your environment";{const r=document.createElement("CANVAS"),i=t&&t.height?Math.min(e.height,t.height):Math.min(e.height,100),n=t&&t.width?Math.min(e.width,t.width):Math.min(e.width,100);r.height=i,r.width=n,r.style.minHeight="200px",r.style.minWidth="400px",r.style.maxWidth="100%";const o=r.getContext("2d"),s=function(e,t,r){if(e.values){const{noDataValue:i,mins:n,ranges:o,values:s}=e,a=s.length,l=e.width/t,c=e.height/r,f=new Uint8ClampedArray(t*r*4);for(let e=0;e<r;e++)for(let r=0;r<t;r++){const u=Math.round(e*c),h=Math.round(r*l),d=s.map(e=>{try{return e[u][h]}catch(e){console.error(e)}});if(d.every(e=>void 0!==e&&e!==i)){const i=e*(4*t)+4*r;if(1===a){const e=Math.round(d[0]),t=Math.round((e-n[0])/o[0]*255);f[i]=t,f[i+1]=t,f[i+2]=t,f[i+3]=255}else if(3===a)try{const[e,t,r]=d;f[i]=e,f[i+1]=t,f[i+2]=r,f[i+3]=255}catch(e){console.error(e)}else if(4===a)try{const[e,t,r,n]=d;f[i]=e,f[i+1]=t,f[i+2]=r,f[i+3]=n}catch(e){console.error(e)}}}return new ImageData(f,t,r)}}(e,n,i);return o.putImageData(s,0,0),r}}r.r(t),r.d(t,"default",(function(){return i}))},function(e,t,r){"use strict";r.r(t),r.d(t,"globals",(function(){return i})),r.d(t,"rgb",(function(){return n})),r.d(t,"GeoTIFF",(function(){return Ft})),r.d(t,"MultiGeoTIFF",(function(){return Ut})),r.d(t,"fromUrl",(function(){return Gt})),r.d(t,"fromArrayBuffer",(function(){return Lt})),r.d(t,"fromFile",(function(){return jt})),r.d(t,"fromBlob",(function(){return Nt})),r.d(t,"fromUrls",(function(){return Bt})),r.d(t,"writeArrayBuffer",(function(){return Kt})),r.d(t,"Pool",(function(){return at}));var i={};r.r(i),r.d(i,"fieldTagNames",(function(){return l})),r.d(i,"fieldTags",(function(){return c})),r.d(i,"fieldTagTypes",(function(){return f})),r.d(i,"arrayFields",(function(){return u})),r.d(i,"fieldTypeNames",(function(){return h})),r.d(i,"fieldTypes",(function(){return d})),r.d(i,"photometricInterpretations",(function(){return p})),r.d(i,"ExtraSamplesValues",(function(){return g})),r.d(i,"geoKeyNames",(function(){return m})),r.d(i,"geoKeys",(function(){return y}));var n={};r.r(n),r.d(n,"fromWhiteIsZero",(function(){return w})),r.d(n,"fromBlackIsZero",(function(){return b})),r.d(n,"fromPalette",(function(){return v})),r.d(n,"fromCMYK",(function(){return S})),r.d(n,"fromYCbCr",(function(){return _})),r.d(n,"fromCIELab",(function(){return T}));var o={};r.r(o),r.d(o,"defaultPoolSize",(function(){return X})),r.d(o,"selectWorkerImplementation",(function(){return ee}));var s=r(27),a=r.n(s);const l={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams"},c={};for(const e in l)l.hasOwnProperty(e)&&(c[l[e]]=parseInt(e,10));const f={256:"SHORT",257:"SHORT",258:"SHORT",259:"SHORT",262:"SHORT",273:"LONG",274:"SHORT",277:"SHORT",278:"LONG",279:"LONG",282:"RATIONAL",283:"RATIONAL",284:"SHORT",286:"SHORT",287:"RATIONAL",296:"SHORT",305:"ASCII",306:"ASCII",338:"SHORT",339:"SHORT",513:"LONG",514:"LONG",1024:"SHORT",1025:"SHORT",2048:"SHORT",2049:"ASCII",33550:"DOUBLE",33922:"DOUBLE",34665:"LONG",34735:"SHORT",34737:"ASCII",42113:"ASCII"},u=[c.BitsPerSample,c.ExtraSamples,c.SampleFormat,c.StripByteCounts,c.StripOffsets,c.StripRowCounts,c.TileByteCounts,c.TileOffsets],h={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},d={};for(const e in h)h.hasOwnProperty(e)&&(d[h[e]]=parseInt(e,10));const p={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},g={Unspecified:0,Assocalpha:1,Unassalpha:2},m={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},y={};for(const e in m)m.hasOwnProperty(e)&&(y[m[e]]=parseInt(e,10));function w(e,t){const{width:r,height:i}=e,n=new Uint8Array(r*i*3);let o;for(let r=0,i=0;r<e.length;++r,i+=3)o=256-e[r]/t*256,n[i]=o,n[i+1]=o,n[i+2]=o;return n}function b(e,t){const{width:r,height:i}=e,n=new Uint8Array(r*i*3);let o;for(let r=0,i=0;r<e.length;++r,i+=3)o=e[r]/t*256,n[i]=o,n[i+1]=o,n[i+2]=o;return n}function v(e,t){const{width:r,height:i}=e,n=new Uint8Array(r*i*3),o=t.length/3,s=t.length/3*2;for(let r=0,i=0;r<e.length;++r,i+=3){const a=e[r];n[i]=t[a]/65536*256,n[i+1]=t[a+o]/65536*256,n[i+2]=t[a+s]/65536*256}return n}function S(e){const{width:t,height:r}=e,i=new Uint8Array(t*r*3);for(let t=0,r=0;t<e.length;t+=4,r+=3){const n=e[t],o=e[t+1],s=e[t+2],a=e[t+3];i[r]=(255-n)/256*255*((255-a)/256),i[r+1]=(255-o)/256*255*((255-a)/256),i[r+2]=(255-s)/256*255*((255-a)/256)}return i}function _(e){const{width:t,height:r}=e,i=new Uint8ClampedArray(t*r*3);for(let t=0,r=0;t<e.length;t+=3,r+=3){const n=e[t],o=e[t+1],s=e[t+2];i[r]=n+1.402*(s-128),i[r+1]=n-.34414*(o-128)-.71414*(s-128),i[r+2]=n+1.772*(o-128)}return i}function T(e){const{width:t,height:r}=e,i=new Uint8Array(t*r*3);for(let t=0,r=0;t<e.length;t+=3,r+=3){let n,o,s,a=(e[t+0]+16)/116,l=(e[t+1]<<24>>24)/500+a,c=a-(e[t+2]<<24>>24)/200;l=.95047*(l*l*l>.008856?l*l*l:(l-16/116)/7.787),a=1*(a*a*a>.008856?a*a*a:(a-16/116)/7.787),c=1.08883*(c*c*c>.008856?c*c*c:(c-16/116)/7.787),n=3.2406*l+-1.5372*a+-.4986*c,o=-.9689*l+1.8758*a+.0415*c,s=.0557*l+-.204*a+1.057*c,n=n>.0031308?1.055*n**(1/2.4)-.055:12.92*n,o=o>.0031308?1.055*o**(1/2.4)-.055:12.92*o,s=s>.0031308?1.055*s**(1/2.4)-.055:12.92*s,i[r]=255*Math.max(0,Math.min(1,n)),i[r+1]=255*Math.max(0,Math.min(1,o)),i[r+2]=255*Math.max(0,Math.min(1,s))}return i}function k(e,t){let r=e.length-t,i=0;do{for(let r=t;r>0;r--)e[i+t]+=e[i],i++;r-=t}while(r>0)}function P(e,t,r){let i=0,n=e.length;const o=n/r;for(;n>t;){for(let r=t;r>0;--r)e[i+t]+=e[i],++i;n-=t}const s=e.slice();for(let t=0;t<o;++t)for(let i=0;i<r;++i)e[r*t+i]=s[(r-i-1)*o+t]}class I{decode(e,t){const r=this.decodeBlock(t),i=e.Predictor||1;if(1!==i){const t=!e.StripOffsets;return function(e,t,r,i,n,o){if(!t||1===t)return e;for(let e=0;e<n.length;++e){if(n[e]%8!=0)throw new Error("When decoding with predictor, only multiple of 8 bits are supported.");if(n[e]!==n[0])throw new Error("When decoding with predictor, all samples must have the same size.")}const s=n[0]/8,a=2===o?1:n.length;for(let o=0;o<i&&!(o*a*r*s>=e.byteLength);++o){let i;if(2===t){switch(n[0]){case 8:i=new Uint8Array(e,o*a*r*s,a*r*s);break;case 16:i=new Uint16Array(e,o*a*r*s,a*r*s/2);break;case 32:i=new Uint32Array(e,o*a*r*s,a*r*s/4);break;default:throw new Error(`Predictor 2 not allowed with ${n[0]} bits per sample.`)}k(i,a)}else 3===t&&(i=new Uint8Array(e,o*a*r*s,a*r*s),P(i,a,s))}return e}(r,i,t?e.TileWidth:e.ImageWidth,t?e.TileLength:e.RowsPerStrip||e.ImageLength,e.BitsPerSample,e.PlanarConfiguration)}return r}}class O extends I{decodeBlock(e){return e}}function A(e,t){for(let r=t.length-1;r>=0;r--)e.push(t[r]);return e}function C(e){const t=new Uint16Array(4093),r=new Uint8Array(4093);for(let e=0;e<=257;e++)t[e]=4096,r[e]=e;let i=258,n=9,o=0;function s(){i=258,n=9}function a(e){const t=function(e,t,r){const i=t%8,n=Math.floor(t/8),o=8-i,s=t+r-8*(n+1);let a=8*(n+2)-(t+r);const l=8*(n+2)-t;if(a=Math.max(0,a),n>=e.length)return console.warn("ran off the end of the buffer before finding EOI_CODE (end on input code)"),257;let c=e[n]&2**(8-i)-1;c<<=r-o;let f=c;if(n+1<e.length){let t=e[n+1]>>>a;t<<=Math.max(0,r-l),f+=t}if(s>8&&n+2<e.length){const i=8*(n+3)-(t+r);f+=e[n+2]>>>i}return f}(e,o,n);return o+=n,t}function l(e,n){return r[i]=n,t[i]=e,i++,i-1}function c(e){const i=[];for(let n=e;4096!==n;n=t[n])i.push(r[n]);return i}const f=[];s();const u=new Uint8Array(e);let h,d=a(u);for(;257!==d;){if(256===d){for(s(),d=a(u);256===d;)d=a(u);if(257===d)break;if(d>256)throw new Error(`corrupted code at scanline ${d}`);A(f,c(d)),h=d}else if(d<i){const e=c(d);A(f,e),l(h,e[e.length-1]),h=d}else{const e=c(h);if(!e)throw new Error(`Bogus entry. Not in dictionary, ${h} / ${i}, position: ${o}`);A(f,e),f.push(e[e.length-1]),l(h,e[e.length-1]),h=d}i+1>=2**n&&(12===n?h=void 0:n++),d=a(u)}return new Uint8Array(f)}class E extends I{decodeBlock(e){return C(e).buffer}}const D=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);function x(e,t){let r=0;const i=[];let n=16;for(;n>0&&!e[n-1];)--n;i.push({children:[],index:0});let o,s=i[0];for(let a=0;a<n;a++){for(let n=0;n<e[a];n++){for(s=i.pop(),s.children[s.index]=t[r];s.index>0;)s=i.pop();for(s.index++,i.push(s);i.length<=a;)i.push(o={children:[],index:0}),s.children[s.index]=o.children,s=o;r++}a+1<n&&(i.push(o={children:[],index:0}),s.children[s.index]=o.children,s=o)}return i[0].children}function M(e,t,r,i,n,o,s,a,l){const{mcusPerLine:c,progressive:f}=r,u=t;let h=t,d=0,p=0;function g(){if(p>0)return p--,d>>p&1;if(d=e[h++],255===d){const t=e[h++];if(t)throw new Error(`unexpected marker: ${(d<<8|t).toString(16)}`)}return p=7,d>>>7}function m(e){let t,r=e;for(;null!==(t=g());){if(r=r[t],"number"==typeof r)return r;if("object"!=typeof r)throw new Error("invalid huffman sequence")}return null}function y(e){let t=e,r=0;for(;t>0;){const e=g();if(null===e)return;r=r<<1|e,--t}return r}function w(e){const t=y(e);return t>=1<<e-1?t:t+(-1<<e)+1}let b=0;let v,S=0;function _(e,t,r,i,n){const o=r%c,s=(r/c|0)*e.v+i,a=o*e.h+n;t(e,e.blocks[s][a])}function T(e,t,r){const i=r/e.blocksPerLine|0,n=r%e.blocksPerLine;t(e,e.blocks[i][n])}const k=i.length;let P,I,O,A,C,E;E=f?0===o?0===a?function(e,t){const r=m(e.huffmanTableDC),i=0===r?0:w(r)<<l;e.pred+=i,t[0]=e.pred}:function(e,t){t[0]|=g()<<l}:0===a?function(e,t){if(b>0)return void b--;let r=o;const i=s;for(;r<=i;){const i=m(e.huffmanTableAC),n=15&i,o=i>>4;if(0===n){if(o<15){b=y(o)+(1<<o)-1;break}r+=16}else{r+=o,t[D[r]]=w(n)*(1<<l),r++}}}:function(e,t){let r=o;const i=s;let n=0;for(;r<=i;){const i=D[r],o=t[i]<0?-1:1;switch(S){case 0:{const t=m(e.huffmanTableAC),r=15&t;if(n=t>>4,0===r)n<15?(b=y(n)+(1<<n),S=4):(n=16,S=1);else{if(1!==r)throw new Error("invalid ACn encoding");v=w(r),S=n?2:3}continue}case 1:case 2:t[i]?t[i]+=(g()<<l)*o:(n--,0===n&&(S=2===S?3:0));break;case 3:t[i]?t[i]+=(g()<<l)*o:(t[i]=v<<l,S=0);break;case 4:t[i]&&(t[i]+=(g()<<l)*o)}r++}4===S&&(b--,0===b&&(S=0))}:function(e,t){const r=m(e.huffmanTableDC),i=0===r?0:w(r);e.pred+=i,t[0]=e.pred;let n=1;for(;n<64;){const r=m(e.huffmanTableAC),i=15&r,o=r>>4;if(0===i){if(o<15)break;n+=16}else{n+=o,t[D[n]]=w(i),n++}}};let x,M,R=0;M=1===k?i[0].blocksPerLine*i[0].blocksPerColumn:c*r.mcusPerColumn;const F=n||M;for(;R<M;){for(I=0;I<k;I++)i[I].pred=0;if(b=0,1===k)for(P=i[0],C=0;C<F;C++)T(P,E,R),R++;else for(C=0;C<F;C++){for(I=0;I<k;I++){P=i[I];const{h:e,v:t}=P;for(O=0;O<t;O++)for(A=0;A<e;A++)_(P,E,R,O,A)}if(R++,R===M)break}if(p=0,x=e[h]<<8|e[h+1],x<65280)throw new Error("marker was not found");if(!(x>=65488&&x<=65495))break;h+=2}return h-u}function R(e,t){const r=[],{blocksPerLine:i,blocksPerColumn:n}=t,o=i<<3,s=new Int32Array(64),a=new Uint8Array(64);function l(e,r,i){const n=t.quantizationTable;let o,s,a,l,c,f,u,h,d;const p=i;let g;for(g=0;g<64;g++)p[g]=e[g]*n[g];for(g=0;g<8;++g){const e=8*g;0!==p[1+e]||0!==p[2+e]||0!==p[3+e]||0!==p[4+e]||0!==p[5+e]||0!==p[6+e]||0!==p[7+e]?(o=5793*p[0+e]+128>>8,s=5793*p[4+e]+128>>8,a=p[2+e],l=p[6+e],c=2896*(p[1+e]-p[7+e])+128>>8,h=2896*(p[1+e]+p[7+e])+128>>8,f=p[3+e]<<4,u=p[5+e]<<4,d=o-s+1>>1,o=o+s+1>>1,s=d,d=3784*a+1567*l+128>>8,a=1567*a-3784*l+128>>8,l=d,d=c-u+1>>1,c=c+u+1>>1,u=d,d=h+f+1>>1,f=h-f+1>>1,h=d,d=o-l+1>>1,o=o+l+1>>1,l=d,d=s-a+1>>1,s=s+a+1>>1,a=d,d=2276*c+3406*h+2048>>12,c=3406*c-2276*h+2048>>12,h=d,d=799*f+4017*u+2048>>12,f=4017*f-799*u+2048>>12,u=d,p[0+e]=o+h,p[7+e]=o-h,p[1+e]=s+u,p[6+e]=s-u,p[2+e]=a+f,p[5+e]=a-f,p[3+e]=l+c,p[4+e]=l-c):(d=5793*p[0+e]+512>>10,p[0+e]=d,p[1+e]=d,p[2+e]=d,p[3+e]=d,p[4+e]=d,p[5+e]=d,p[6+e]=d,p[7+e]=d)}for(g=0;g<8;++g){const e=g;0!==p[8+e]||0!==p[16+e]||0!==p[24+e]||0!==p[32+e]||0!==p[40+e]||0!==p[48+e]||0!==p[56+e]?(o=5793*p[0+e]+2048>>12,s=5793*p[32+e]+2048>>12,a=p[16+e],l=p[48+e],c=2896*(p[8+e]-p[56+e])+2048>>12,h=2896*(p[8+e]+p[56+e])+2048>>12,f=p[24+e],u=p[40+e],d=o-s+1>>1,o=o+s+1>>1,s=d,d=3784*a+1567*l+2048>>12,a=1567*a-3784*l+2048>>12,l=d,d=c-u+1>>1,c=c+u+1>>1,u=d,d=h+f+1>>1,f=h-f+1>>1,h=d,d=o-l+1>>1,o=o+l+1>>1,l=d,d=s-a+1>>1,s=s+a+1>>1,a=d,d=2276*c+3406*h+2048>>12,c=3406*c-2276*h+2048>>12,h=d,d=799*f+4017*u+2048>>12,f=4017*f-799*u+2048>>12,u=d,p[0+e]=o+h,p[56+e]=o-h,p[8+e]=s+u,p[48+e]=s-u,p[16+e]=a+f,p[40+e]=a-f,p[24+e]=l+c,p[32+e]=l-c):(d=5793*i[g+0]+8192>>14,p[0+e]=d,p[8+e]=d,p[16+e]=d,p[24+e]=d,p[32+e]=d,p[40+e]=d,p[48+e]=d,p[56+e]=d)}for(g=0;g<64;++g){const e=128+(p[g]+8>>4);r[g]=e<0?0:e>255?255:e}}for(let e=0;e<n;e++){const n=e<<3;for(let e=0;e<8;e++)r.push(new Uint8Array(o));for(let o=0;o<i;o++){l(t.blocks[e][o],a,s);let i=0;const c=o<<3;for(let e=0;e<8;e++){const t=r[n+e];for(let e=0;e<8;e++)t[c+e]=a[i++]}}}return r}class F{constructor(){this.jfif=null,this.adobe=null,this.quantizationTables=[],this.huffmanTablesAC=[],this.huffmanTablesDC=[],this.resetFrames()}resetFrames(){this.frames=[]}parse(e){let t=0;function r(){const r=e[t]<<8|e[t+1];return t+=2,r}function i(){const i=r(),n=e.subarray(t,t+i-2);return t+=n.length,n}function n(e){let t,r,i=0,n=0;for(r in e.components)e.components.hasOwnProperty(r)&&(t=e.components[r],i<t.h&&(i=t.h),n<t.v&&(n=t.v));const o=Math.ceil(e.samplesPerLine/8/i),s=Math.ceil(e.scanLines/8/n);for(r in e.components)if(e.components.hasOwnProperty(r)){t=e.components[r];const a=Math.ceil(Math.ceil(e.samplesPerLine/8)*t.h/i),l=Math.ceil(Math.ceil(e.scanLines/8)*t.v/n),c=o*t.h,f=s*t.v,u=[];for(let e=0;e<f;e++){const e=[];for(let t=0;t<c;t++)e.push(new Int32Array(64));u.push(e)}t.blocksPerLine=a,t.blocksPerColumn=l,t.blocks=u}e.maxH=i,e.maxV=n,e.mcusPerLine=o,e.mcusPerColumn=s}let o=r();if(65496!==o)throw new Error("SOI not found");for(o=r();65497!==o;){switch(o){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:{const e=i();65504===o&&74===e[0]&&70===e[1]&&73===e[2]&&70===e[3]&&0===e[4]&&(this.jfif={version:{major:e[5],minor:e[6]},densityUnits:e[7],xDensity:e[8]<<8|e[9],yDensity:e[10]<<8|e[11],thumbWidth:e[12],thumbHeight:e[13],thumbData:e.subarray(14,14+3*e[12]*e[13])}),65518===o&&65===e[0]&&100===e[1]&&111===e[2]&&98===e[3]&&101===e[4]&&0===e[5]&&(this.adobe={version:e[6],flags0:e[7]<<8|e[8],flags1:e[9]<<8|e[10],transformCode:e[11]});break}case 65499:{const i=r()+t-2;for(;t<i;){const i=e[t++],n=new Int32Array(64);if(i>>4==0)for(let r=0;r<64;r++){n[D[r]]=e[t++]}else{if(i>>4!=1)throw new Error("DQT: invalid table spec");for(let e=0;e<64;e++){n[D[e]]=r()}}this.quantizationTables[15&i]=n}break}case 65472:case 65473:case 65474:{r();const i={extended:65473===o,progressive:65474===o,precision:e[t++],scanLines:r(),samplesPerLine:r(),components:{},componentsOrder:[]},s=e[t++];let a;for(let r=0;r<s;r++){a=e[t];const r=e[t+1]>>4,n=15&e[t+1],o=e[t+2];i.componentsOrder.push(a),i.components[a]={h:r,v:n,quantizationIdx:o},t+=3}n(i),this.frames.push(i);break}case 65476:{const i=r();for(let r=2;r<i;){const i=e[t++],n=new Uint8Array(16);let o=0;for(let r=0;r<16;r++,t++)n[r]=e[t],o+=n[r];const s=new Uint8Array(o);for(let r=0;r<o;r++,t++)s[r]=e[t];r+=17+o,i>>4==0?this.huffmanTablesDC[15&i]=x(n,s):this.huffmanTablesAC[15&i]=x(n,s)}break}case 65501:r(),this.resetInterval=r();break;case 65498:{r();const i=e[t++],n=[],o=this.frames[0];for(let r=0;r<i;r++){const r=o.components[e[t++]],i=e[t++];r.huffmanTableDC=this.huffmanTablesDC[i>>4],r.huffmanTableAC=this.huffmanTablesAC[15&i],n.push(r)}const s=e[t++],a=e[t++],l=e[t++],c=M(e,t,o,n,this.resetInterval,s,a,l>>4,15&l);t+=c;break}case 65535:255!==e[t]&&t--;break;default:if(255===e[t-3]&&e[t-2]>=192&&e[t-2]<=254){t-=3;break}throw new Error(`unknown JPEG marker ${o.toString(16)}`)}o=r()}}getResult(){const{frames:e}=this;if(0===this.frames.length)throw new Error("no frames were decoded");this.frames.length>1&&console.warn("more than one frame is not supported");for(let e=0;e<this.frames.length;e++){const t=this.frames[e].components;for(const e of Object.keys(t))t[e].quantizationTable=this.quantizationTables[t[e].quantizationIdx],delete t[e].quantizationIdx}const t=e[0],{components:r,componentsOrder:i}=t,n=[],o=t.samplesPerLine,s=t.scanLines;for(let e=0;e<i.length;e++){const o=r[i[e]];n.push({lines:R(0,o),scaleX:o.h/t.maxH,scaleY:o.v/t.maxV})}const a=new Uint8Array(o*s*n.length);let l=0;for(let e=0;e<s;++e)for(let t=0;t<o;++t)for(let r=0;r<n.length;++r){const i=n[r];a[l]=i.lines[0|e*i.scaleY][0|t*i.scaleX],++l}return a}}class U extends I{constructor(e){super(),this.reader=new F,e.JPEGTables&&this.reader.parse(e.JPEGTables)}decodeBlock(e){return this.reader.resetFrames(),this.reader.parse(new Uint8Array(e)),this.reader.getResult().buffer}}var G=r(28);class L extends I{decodeBlock(e){return Object(G.inflate)(new Uint8Array(e)).buffer}}class j extends I{decodeBlock(e){const t=new DataView(e),r=[];for(let i=0;i<e.byteLength;++i){let e=t.getInt8(i);if(e<0){const n=t.getUint8(i+1);e=-e;for(let t=0;t<=e;++t)r.push(n);i+=1}else{for(let n=0;n<=e;++n)r.push(t.getUint8(i+n+1));i+=e+1}}return new Uint8Array(r).buffer}}function N(e,t,r,i=1){return new(Object.getPrototypeOf(e).constructor)(t*r*i)}function B(e,t,r){return(1-r)*e+r*t}function K(e,t,r,i,n,o="nearest"){switch(o.toLowerCase()){case"nearest":return function(e,t,r,i,n){const o=t/i,s=r/n;return e.map(e=>{const a=N(e,i,n);for(let l=0;l<n;++l){const n=Math.min(Math.round(s*l),r-1);for(let r=0;r<i;++r){const s=Math.min(Math.round(o*r),t-1),c=e[n*t+s];a[l*i+r]=c}}return a})}(e,t,r,i,n);case"bilinear":case"linear":return function(e,t,r,i,n){const o=t/i,s=r/n;return e.map(e=>{const a=N(e,i,n);for(let l=0;l<n;++l){const n=s*l,c=Math.floor(n),f=Math.min(Math.ceil(n),r-1);for(let r=0;r<i;++r){const s=o*r,u=s%1,h=Math.floor(s),d=Math.min(Math.ceil(s),t-1),p=e[c*t+h],g=e[c*t+d],m=e[f*t+h],y=e[f*t+d],w=B(B(p,g,u),B(m,y,u),n%1);a[l*i+r]=w}}return a})}(e,t,r,i,n);default:throw new Error(`Unsupported resampling method: '${o}'`)}}function W(e,t,r,i,n,o,s="nearest"){switch(s.toLowerCase()){case"nearest":return function(e,t,r,i,n,o){const s=t/i,a=r/n,l=N(e,i,n,o);for(let c=0;c<n;++c){const n=Math.min(Math.round(a*c),r-1);for(let r=0;r<i;++r){const a=Math.min(Math.round(s*r),t-1);for(let s=0;s<o;++s){const f=e[n*t*o+a*o+s];l[c*i*o+r*o+s]=f}}}return l}(e,t,r,i,n,o);case"bilinear":case"linear":return function(e,t,r,i,n,o){const s=t/i,a=r/n,l=N(e,i,n,o);for(let c=0;c<n;++c){const n=a*c,f=Math.floor(n),u=Math.min(Math.ceil(n),r-1);for(let r=0;r<i;++r){const a=s*r,h=a%1,d=Math.floor(a),p=Math.min(Math.ceil(a),t-1);for(let s=0;s<o;++s){const a=e[f*t*o+d*o+s],g=e[f*t*o+p*o+s],m=e[u*t*o+d*o+s],y=e[u*t*o+p*o+s],w=B(B(a,g,h),B(m,y,h),n%1);l[c*i*o+r*o+s]=w}}}return l}(e,t,r,i,n,o);default:throw new Error(`Unsupported resampling method: '${s}'`)}}function V(e,t,r){let i=0;for(let n=t;n<r;++n)i+=e[n];return i}function H(e,t,r){switch(e){case 1:switch(t){case 8:return new Uint8Array(r);case 16:return new Uint16Array(r);case 32:return new Uint32Array(r)}break;case 2:switch(t){case 8:return new Int8Array(r);case 16:return new Int16Array(r);case 32:return new Int32Array(r)}break;case 3:switch(t){case 32:return new Float32Array(r);case 64:return new Float64Array(r)}}throw Error("Unsupported data format/bitsPerSample")}var q=class{constructor(e,t,r,i,n,o){this.fileDirectory=e,this.geoKeys=t,this.dataView=r,this.littleEndian=i,this.tiles=n?{}:null,this.isTiled=!e.StripOffsets;const s=e.PlanarConfiguration;if(this.planarConfiguration=void 0===s?1:s,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.");this.source=o}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return this.fileDirectory.SamplesPerPixel}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:void 0!==this.fileDirectory.RowsPerStrip?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBytesPerPixel(){let e=0;for(let t=0;t<this.fileDirectory.BitsPerSample.length;++t){const r=this.fileDirectory.BitsPerSample[t];if(r%8!=0)throw new Error(`Sample bit-width of ${r} is not supported.`);if(r!==this.fileDirectory.BitsPerSample[0])throw new Error("Differing size of samples in a pixel are not supported.");e+=r}return e/8}getSampleByteSize(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${e} is out of range.`);const t=this.fileDirectory.BitsPerSample[e];if(t%8!=0)throw new Error(`Sample bit-width of ${t} is not supported.`);return t/8}getReaderForSample(e){const t=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,r=this.fileDirectory.BitsPerSample[e];switch(t){case 1:switch(r){case 8:return DataView.prototype.getUint8;case 16:return DataView.prototype.getUint16;case 32:return DataView.prototype.getUint32}break;case 2:switch(r){case 8:return DataView.prototype.getInt8;case 16:return DataView.prototype.getInt16;case 32:return DataView.prototype.getInt32}break;case 3:switch(r){case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}throw Error("Unsupported data format/bitsPerSample")}getArrayForSample(e,t){return H(this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,this.fileDirectory.BitsPerSample[e],t)}async getTileOrStrip(e,t,r,i){const n=Math.ceil(this.getWidth()/this.getTileWidth()),o=Math.ceil(this.getHeight()/this.getTileHeight());let s;const{tiles:a}=this;let l,c;1===this.planarConfiguration?s=t*n+e:2===this.planarConfiguration&&(s=r*n*o+t*n+e),this.isTiled?(l=this.fileDirectory.TileOffsets[s],c=this.fileDirectory.TileByteCounts[s]):(l=this.fileDirectory.StripOffsets[s],c=this.fileDirectory.StripByteCounts[s]);const f=await this.source.fetch(l,c);let u;return null===a?u=i.decode(this.fileDirectory,f):a[s]||(u=i.decode(this.fileDirectory,f),a[s]=u),{x:e,y:t,sample:r,data:await u}}async _readRaster(e,t,r,i,n,o,s,a){const l=this.getTileWidth(),c=this.getTileHeight(),f=Math.max(Math.floor(e[0]/l),0),u=Math.min(Math.ceil(e[2]/l),Math.ceil(this.getWidth()/this.getTileWidth())),h=Math.max(Math.floor(e[1]/c),0),d=Math.min(Math.ceil(e[3]/c),Math.ceil(this.getHeight()/this.getTileHeight())),p=e[2]-e[0];let g=this.getBytesPerPixel();const m=[],y=[];for(let e=0;e<t.length;++e)1===this.planarConfiguration?m.push(V(this.fileDirectory.BitsPerSample,0,t[e])/8):m.push(0),y.push(this.getReaderForSample(t[e]));const w=[],{littleEndian:b}=this;for(let o=h;o<d;++o)for(let s=f;s<u;++s)for(let a=0;a<t.length;++a){const f=a,u=t[a];2===this.planarConfiguration&&(g=this.getSampleByteSize(u));const h=this.getTileOrStrip(s,o,u,n);w.push(h),h.then(n=>{const o=n.data,s=new DataView(o),a=n.y*c,u=n.x*l,h=(n.y+1)*c,d=(n.x+1)*l,w=y[f],v=Math.min(c,c-(h-e[3])),S=Math.min(l,l-(d-e[2]));for(let n=Math.max(0,e[1]-a);n<v;++n)for(let o=Math.max(0,e[0]-u);o<S;++o){const c=(n*l+o)*g,h=w.call(s,c+m[f],b);let d;i?(d=(n+a-e[1])*p*t.length+(o+u-e[0])*t.length+f,r[d]=h):(d=(n+a-e[1])*p+o+u-e[0],r[f][d]=h)}})}if(await Promise.all(w),o&&e[2]-e[0]!==o||s&&e[3]-e[1]!==s){let n;return n=i?W(r,e[2]-e[0],e[3]-e[1],o,s,t.length,a):K(r,e[2]-e[0],e[3]-e[1],o,s,a),n.width=o,n.height=s,n}return r.width=o||e[2]-e[0],r.height=s||e[3]-e[1],r}async readRasters({window:e,samples:t=[],interleave:r,pool:i=null,width:n,height:o,resampleMethod:s,fillValue:a}={}){const l=e||[0,0,this.getWidth(),this.getHeight()];if(l[0]>l[2]||l[1]>l[3])throw new Error("Invalid subsets");const c=(l[2]-l[0])*(l[3]-l[1]);if(t&&t.length){for(let e=0;e<t.length;++e)if(t[e]>=this.fileDirectory.SamplesPerPixel)return Promise.reject(new RangeError(`Invalid sample index '${t[e]}'.`))}else for(let e=0;e<this.fileDirectory.SamplesPerPixel;++e)t.push(e);let f;if(r){f=H(this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,Math.max.apply(null,this.fileDirectory.BitsPerSample),c*t.length),a&&f.fill(a)}else{f=[];for(let e=0;e<t.length;++e){const r=this.getArrayForSample(t[e],c);Array.isArray(a)&&e<a.length?r.fill(a[e]):a&&!Array.isArray(a)&&r.fill(a),f.push(r)}}const u=i||function(e){switch(e.Compression){case void 0:case 1:return new O;case 5:return new E;case 6:throw new Error("old style JPEG compression is not supported.");case 7:return new U(e);case 8:case 32946:return new L;case 32773:return new j;default:throw new Error(`Unknown compression method identifier: ${e.Compression}`)}}(this.fileDirectory);return await this._readRaster(l,t,f,r,u,n,o,s)}async readRGB({window:e,pool:t=null,width:r,height:i,resampleMethod:n,enableAlpha:o=!1}={}){const s=e||[0,0,this.getWidth(),this.getHeight()];if(s[0]>s[2]||s[1]>s[3])throw new Error("Invalid subsets");const a=this.fileDirectory.PhotometricInterpretation;if(a===p.RGB){let n=[0,1,2];if(this.fileDirectory.ExtraSamples!==g.Unspecified&&o){n=[];for(let e=0;e<this.fileDirectory.BitsPerSample.length;e+=1)n.push(e)}return this.readRasters({window:e,interleave:!0,samples:n,pool:t,width:r,height:i})}let l;switch(a){case p.WhiteIsZero:case p.BlackIsZero:case p.Palette:l=[0];break;case p.CMYK:l=[0,1,2,3];break;case p.YCbCr:case p.CIELab:l=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const c={window:s,interleave:!0,samples:l,pool:t,width:r,height:i,resampleMethod:n},{fileDirectory:f}=this,u=await this.readRasters(c),h=2**this.fileDirectory.BitsPerSample[0];let d;switch(a){case p.WhiteIsZero:d=w(u,h);break;case p.BlackIsZero:d=b(u,h);break;case p.Palette:d=v(u,f.ColorMap);break;case p.CMYK:d=S(u);break;case p.YCbCr:d=_(u);break;case p.CIELab:d=T(u);break;default:throw new Error("Unsupported photometric interpretation.")}return d.width=u.width,d.height=u.height,d}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const e=[];for(let t=0;t<this.fileDirectory.ModelTiepoint.length;t+=6)e.push({i:this.fileDirectory.ModelTiepoint[t],j:this.fileDirectory.ModelTiepoint[t+1],k:this.fileDirectory.ModelTiepoint[t+2],x:this.fileDirectory.ModelTiepoint[t+3],y:this.fileDirectory.ModelTiepoint[t+4],z:this.fileDirectory.ModelTiepoint[t+5]});return e}getGDALMetadata(e=null){const t={};if(!this.fileDirectory.GDAL_METADATA)return null;const r=this.fileDirectory.GDAL_METADATA,i=a()(r.substring(0,r.length-1));if(!i[0].tagName)throw new Error("Failed to parse GDAL metadata XML.");const n=i[0];if("GDALMetadata"!==n.tagName)throw new Error("Unexpected GDAL metadata XML tag.");let o=n.children.filter(e=>"Item"===e.tagName);e&&(o=o.filter(t=>Number(t.attributes.sample)===e));for(let e=0;e<o.length;++e){const r=o[e];t[r.attributes.name]=r.children[0]}return t}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const e=this.fileDirectory.GDAL_NODATA;return Number(e.substring(0,e.length-1))}getOrigin(){const e=this.fileDirectory.ModelTiepoint,t=this.fileDirectory.ModelTransformation;if(e&&6===e.length)return[e[3],e[4],e[5]];if(t)return[t[3],t[7],t[11]];throw new Error("The image does not have an affine transformation.")}getResolution(e=null){const t=this.fileDirectory.ModelPixelScale,r=this.fileDirectory.ModelTransformation;if(t)return[t[0],-t[1],t[2]];if(r)return[r[0],r[5],r[10]];if(e){const[t,r,i]=e.getResolution();return[t*e.getWidth()/this.getWidth(),r*e.getHeight()/this.getHeight(),i*e.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return 1===this.geoKeys.GTRasterTypeGeoKey}getBoundingBox(){const e=this.getOrigin(),t=this.getResolution(),r=e[0],i=e[1],n=r+t[0]*this.getWidth(),o=i+t[1]*this.getHeight();return[Math.min(r,n),Math.min(i,o),Math.max(r,n),Math.max(i,o)]}};class z{constructor(e){this._dataView=new DataView(e)}get buffer(){return this._dataView.buffer}getUint64(e,t){const r=this.getUint32(e,t),i=this.getUint32(e+4,t);return t?r<<32|i:i<<32|r}getInt64(e,t){let r,i;return t?(r=this.getInt32(e,t),i=this.getUint32(e+4,t),r<<32|i):(r=this.getUint32(e,t),i=this.getInt32(e+4,t),i<<32|r)}getUint8(e,t){return this._dataView.getUint8(e,t)}getInt8(e,t){return this._dataView.getInt8(e,t)}getUint16(e,t){return this._dataView.getUint16(e,t)}getInt16(e,t){return this._dataView.getInt16(e,t)}getUint32(e,t){return this._dataView.getUint32(e,t)}getInt32(e,t){return this._dataView.getInt32(e,t)}getFloat32(e,t){return this._dataView.getFloat32(e,t)}getFloat64(e,t){return this._dataView.getFloat64(e,t)}}class ${constructor(e,t,r,i){this._dataView=new DataView(e),this._sliceOffset=t,this._littleEndian=r,this._bigTiff=i}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(e,t){return this.sliceOffset<=e&&this.sliceTop>=e+t}readUint8(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}readInt8(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}readUint16(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}readInt16(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}readUint32(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}readInt32(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}readFloat32(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}readFloat64(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}readUint64(e){const t=this.readUint32(e),r=this.readUint32(e+4);let i;if(this._littleEndian){if(i=t+2**32*r,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}if(i=2**32*t+r,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}readInt64(e){let t,r;if(this._littleEndian){if(t=this.readInt32(e),r=this.readUint32(e+4),combined=t+2**32*r,!Number.isSafeInteger(combined))throw new Error(`${combined} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return combined}if(t=this.readUint32(e-this._sliceOffset),r=this.readInt32(e-this._sliceOffset+4),combined=2**32*t+r,!Number.isSafeInteger(combined))throw new Error(`${combined} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return combined}readOffset(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}let Y;function Z(){return Y||(Y=function(){try{throw new Error}catch(e){const t=(""+e.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(t)return(""+t[0]).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/,"$1")+"/"}return"/"}()),Y}const X="undefined"!=typeof navigator&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:4,J=e=>/^(file|https?:)?\/\//i.test(e);function Q(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function ee(){return"undefined"==typeof Worker?class{constructor(){throw Error("No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.")}}:class extends Worker{constructor(e,t){"string"==typeof e&&t&&t._baseURL?e=new URL(e,t._baseURL):"string"==typeof e&&!J(e)&&Z().match(/^file:\/\//i)&&(e=new URL(e,Z().replace(/\/[^\/]+$/,"/")),e=Q(`importScripts(${JSON.stringify(e)});`)),"string"==typeof e&&J(e)&&(e=Q(`importScripts(${JSON.stringify(e)});`)),super(e,t)}}}var te=r(29);const re="undefined"!=typeof process&&"browser"!==process.arch&&"pid"in process?te:o,ie=re.defaultPoolSize,ne=(0,re.selectWorkerImplementation)();"undefined"!=typeof global?global.Worker=ne:"undefined"!=typeof window&&(window.Worker=ne);var oe=r(1),se=r.n(oe);const ae=()=>"function"==typeof Symbol,le=e=>ae()&&Boolean(Symbol[e]),ce=e=>le(e)?Symbol[e]:"@@"+e;le("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"));const fe=ce("iterator"),ue=ce("observable"),he=ce("species");function de(e,t){const r=e[t];if(null!=r){if("function"!=typeof r)throw new TypeError(r+" is not a function");return r}}function pe(e){let t=e.constructor;return void 0!==t&&(t=t[he],null===t&&(t=void 0)),void 0!==t?t:Te}function ge(e){ge.log?ge.log(e):setTimeout(()=>{throw e},0)}function me(e){Promise.resolve().then(()=>{try{e()}catch(e){ge(e)}})}function ye(e){const t=e._cleanup;if(void 0!==t&&(e._cleanup=void 0,t))try{if("function"==typeof t)t();else{const e=de(t,"unsubscribe");e&&e.call(t)}}catch(e){ge(e)}}function we(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function be(e,t,r){e._state="running";const i=e._observer;try{const n=i?de(i,t):void 0;switch(t){case"next":n&&n.call(i,r);break;case"error":if(we(e),!n)throw r;n.call(i,r);break;case"complete":we(e),n&&n.call(i)}}catch(e){ge(e)}"closed"===e._state?ye(e):"running"===e._state&&(e._state="ready")}function ve(e,t,r){if("closed"!==e._state)return"buffering"===e._state?(e._queue=e._queue||[],void e._queue.push({type:t,value:r})):"ready"!==e._state?(e._state="buffering",e._queue=[{type:t,value:r}],void me(()=>function(e){const t=e._queue;if(t){e._queue=void 0,e._state="ready";for(const r of t)if(be(e,r.type,r.value),"closed"===e._state)break}}(e))):void be(e,t,r)}class Se{constructor(e,t){this._cleanup=void 0,this._observer=e,this._queue=void 0,this._state="initializing";const r=new _e(this);try{this._cleanup=t.call(void 0,r)}catch(e){r.error(e)}"initializing"===this._state&&(this._state="ready")}get closed(){return"closed"===this._state}unsubscribe(){"closed"!==this._state&&(we(this),ye(this))}}class _e{constructor(e){this._subscription=e}get closed(){return"closed"===this._subscription._state}next(e){ve(this._subscription,"next",e)}error(e){ve(this._subscription,"error",e)}complete(){ve(this._subscription,"complete")}}class Te{constructor(e){if(!(this instanceof Te))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof e)throw new TypeError("Observable initializer must be a function");this._subscriber=e}subscribe(e,t,r){return"object"==typeof e&&null!==e||(e={next:e,error:t,complete:r}),new Se(e,this._subscriber)}pipe(e,...t){let r=this;for(const i of[e,...t])r=i(r);return r}tap(e,t,r){const i="object"!=typeof e||null===e?{next:e,error:t,complete:r}:e;return new Te(e=>this.subscribe({next(t){i.next&&i.next(t),e.next(t)},error(t){i.error&&i.error(t),e.error(t)},complete(){i.complete&&i.complete(),e.complete()},start(e){i.start&&i.start(e)}}))}forEach(e){return new Promise((t,r)=>{if("function"!=typeof e)return void r(new TypeError(e+" is not a function"));function i(){n.unsubscribe(),t()}const n=this.subscribe({next(t){try{e(t,i)}catch(e){r(e),n.unsubscribe()}},error:r,complete:t})})}map(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(pe(this))(t=>this.subscribe({next(r){let i=r;try{i=e(r)}catch(e){return t.error(e)}t.next(i)},error(e){t.error(e)},complete(){t.complete()}}))}filter(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(pe(this))(t=>this.subscribe({next(r){try{if(!e(r))return}catch(e){return t.error(e)}t.next(r)},error(e){t.error(e)},complete(){t.complete()}}))}reduce(e,t){if("function"!=typeof e)throw new TypeError(e+" is not a function");const r=pe(this),i=arguments.length>1;let n=!1,o=t;return new r(t=>this.subscribe({next(r){const s=!n;if(n=!0,!s||i)try{o=e(o,r)}catch(e){return t.error(e)}else o=r},error(e){t.error(e)},complete(){if(!n&&!i)return t.error(new TypeError("Cannot reduce an empty sequence"));t.next(o),t.complete()}}))}concat(...e){const t=pe(this);return new t(r=>{let i,n=0;return function o(s){i=s.subscribe({next(e){r.next(e)},error(e){r.error(e)},complete(){n===e.length?(i=void 0,r.complete()):o(t.from(e[n++]))}})}(this),()=>{i&&(i.unsubscribe(),i=void 0)}})}flatMap(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");const t=pe(this);return new t(r=>{const i=[],n=this.subscribe({next(n){let s;if(e)try{s=e(n)}catch(e){return r.error(e)}else s=n;const a=t.from(s).subscribe({next(e){r.next(e)},error(e){r.error(e)},complete(){const e=i.indexOf(a);e>=0&&i.splice(e,1),o()}});i.push(a)},error(e){r.error(e)},complete(){o()}});function o(){n.closed&&0===i.length&&r.complete()}return()=>{i.forEach(e=>e.unsubscribe()),n.unsubscribe()}})}[ue](){return this}static from(e){const t="function"==typeof this?this:Te;if(null==e)throw new TypeError(e+" is not an object");const r=de(e,ue);if(r){const i=r.call(e);if(Object(i)!==i)throw new TypeError(i+" is not an object");return function(e){return e instanceof Te}(i)&&i.constructor===t?i:new t(e=>i.subscribe(e))}if(le("iterator")){const r=de(e,fe);if(r)return new t(t=>{me(()=>{if(!t.closed){for(const i of r.call(e))if(t.next(i),t.closed)return;t.complete()}})})}if(Array.isArray(e))return new t(t=>{me(()=>{if(!t.closed){for(const r of e)if(t.next(r),t.closed)return;t.complete()}})});throw new TypeError(e+" is not observable")}static of(...e){return new("function"==typeof this?this:Te)(t=>{me(()=>{if(!t.closed){for(const r of e)if(t.next(r),t.closed)return;t.complete()}})})}static get[he](){return this}}ae()&&Object.defineProperty(Te,Symbol("extensions"),{value:{symbol:ue,hostReportError:ge},configurable:!0});var ke=Te;var Pe=class extends ke{constructor(){super(e=>(this._observers.add(e),()=>this._observers.delete(e))),this._observers=new Set}next(e){for(const t of this._observers)t.next(e)}error(e){for(const t of this._observers)t.error(e)}complete(){for(const e of this._observers)e.complete()}};var Ie=function(e){"function"==typeof e?e():e&&"function"==typeof e.unsubscribe&&e.unsubscribe()};var Oe,Ae=function(e){const t=new Pe;let r,i=0;return new ke(n=>{r||(r=e.subscribe(t));const o=t.subscribe(n);return i++,()=>{i--,o.unsubscribe(),0===i&&(Ie(r),r=void 0)}})};function Ce(e){return Promise.all(e.map(e=>{const t=e=>({status:"fulfilled",value:e}),r=e=>({status:"rejected",reason:e}),i=Promise.resolve(e);try{return i.then(t,r)}catch(e){return Promise.reject(e)}}))}!function(e){e.initialized="initialized",e.taskCanceled="taskCanceled",e.taskCompleted="taskCompleted",e.taskFailed="taskFailed",e.taskQueued="taskQueued",e.taskQueueDrained="taskQueueDrained",e.taskStart="taskStart",e.terminated="terminated"}(Oe||(Oe={}));var Ee=r(0);function De(e){throw Error(e)}const xe={errors:e=>e[Ee.a]||De("Error observable not found. Make sure to pass a thread instance as returned by the spawn() promise."),events:e=>e[Ee.b]||De("Events observable not found. Make sure to pass a thread instance as returned by the spawn() promise."),terminate:e=>e[Ee.c]()};var Me=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};let Re=1;class Fe{constructor(e,t){this.eventSubject=new Pe,this.initErrors=[],this.isClosing=!1,this.nextTaskID=1,this.taskQueue=[];const r="number"==typeof t?{size:t}:t||{},{size:i=ie}=r;var n;this.debug=se()(`threads:pool:${n=r.name||String(Re++),n.replace(/\W/g," ").trim().replace(/\s+/g,"-")}`),this.options=r,this.workers=function(e,t){return function(e){const t=[];for(let r=0;r<e;r++)t.push(r);return t}(t).map(()=>({init:e(),runningTasks:[]}))}(e,i),this.eventObservable=Ae(ke.from(this.eventSubject)),Promise.all(this.workers.map(e=>e.init)).then(()=>this.eventSubject.next({type:Oe.initialized,size:this.workers.length}),e=>{this.debug("Error while initializing pool worker:",e),this.eventSubject.error(e),this.initErrors.push(e)})}findIdlingWorker(){const{concurrency:e=1}=this.options;return this.workers.find(t=>t.runningTasks.length<e)}runPoolTask(e,t){return Me(this,void 0,void 0,(function*(){const r=this.workers.indexOf(e)+1;this.debug(`Running task #${t.id} on worker #${r}...`),this.eventSubject.next({type:Oe.taskStart,taskID:t.id,workerID:r});try{const i=yield t.run(yield e.init);this.debug(`Task #${t.id} completed successfully`),this.eventSubject.next({type:Oe.taskCompleted,returnValue:i,taskID:t.id,workerID:r})}catch(e){this.debug(`Task #${t.id} failed`),this.eventSubject.next({type:Oe.taskFailed,taskID:t.id,error:e,workerID:r})}}))}run(e,t){return Me(this,void 0,void 0,(function*(){const r=(()=>Me(this,void 0,void 0,(function*(){var i;yield(i=0,new Promise(e=>setTimeout(e,i)));try{yield this.runPoolTask(e,t)}finally{e.runningTasks=e.runningTasks.filter(e=>e!==r),this.isClosing||this.scheduleWork()}})))();e.runningTasks.push(r)}))}scheduleWork(){this.debug("Attempt de-queueing a task in order to run it...");const e=this.findIdlingWorker();if(!e)return;const t=this.taskQueue.shift();if(!t)return this.debug("Task queue is empty"),void this.eventSubject.next({type:Oe.taskQueueDrained});this.run(e,t)}taskCompletion(e){return new Promise((t,r)=>{const i=this.events().subscribe(n=>{n.type===Oe.taskCompleted&&n.taskID===e?(i.unsubscribe(),t(n.returnValue)):n.type===Oe.taskFailed&&n.taskID===e?(i.unsubscribe(),r(n.error)):n.type===Oe.terminated&&(i.unsubscribe(),r(Error("Pool has been terminated before task was run.")))})})}settled(e=!1){return Me(this,void 0,void 0,(function*(){const t=()=>{return e=this.workers,t=e=>e.runningTasks,e.reduce((e,r)=>[...e,...t(r)],[]);var e,t},r=[],i=this.eventObservable.subscribe(e=>{e.type===Oe.taskFailed&&r.push(e.error)});return this.initErrors.length>0?Promise.reject(this.initErrors[0]):e&&0===this.taskQueue.length?(yield Ce(t()),r):(yield new Promise((e,t)=>{const r=this.eventObservable.subscribe({next(t){t.type===Oe.taskQueueDrained&&(r.unsubscribe(),e())},error:t})}),yield Ce(t()),i.unsubscribe(),r)}))}completed(e=!1){return Me(this,void 0,void 0,(function*(){const t=this.settled(e),r=new Promise((e,r)=>{const i=this.eventObservable.subscribe({next(n){n.type===Oe.taskQueueDrained?(i.unsubscribe(),e(t)):n.type===Oe.taskFailed&&(i.unsubscribe(),r(n.error))},error:r})}),i=yield Promise.race([t,r]);if(i.length>0)throw i[0]}))}events(){return this.eventObservable}queue(e){const{maxQueuedJobs:t=1/0}=this.options;if(this.isClosing)throw Error("Cannot schedule pool tasks after terminate() has been called.");if(this.initErrors.length>0)throw this.initErrors[0];const r=()=>this.taskCompletion(n.id);let i;const n={id:this.nextTaskID++,run:e,cancel:()=>{-1!==this.taskQueue.indexOf(n)&&(this.taskQueue=this.taskQueue.filter(e=>e!==n),this.eventSubject.next({type:Oe.taskCanceled,taskID:n.id}))},get then(){if(!i){const e=r();i=e.then.bind(e)}return i}};if(this.taskQueue.length>=t)throw Error("Maximum number of pool tasks queued. Refusing to queue another one.\nThis usually happens for one of two reasons: We are either at peak workload right now or some tasks just won't finish, thus blocking the pool.");return this.debug(`Queueing task #${n.id}...`),this.taskQueue.push(n),this.eventSubject.next({type:Oe.taskQueued,taskID:n.id}),this.scheduleWork(),n}terminate(e){return Me(this,void 0,void 0,(function*(){this.isClosing=!0,e||(yield this.completed(!0)),this.eventSubject.next({type:Oe.terminated,remainingQueue:[...this.taskQueue]}),this.eventSubject.complete(),yield Promise.all(this.workers.map(e=>Me(this,void 0,void 0,(function*(){return xe.terminate(yield e.init)}))))}))}}function Ue(e,t){return new Fe(e,t)}Fe.EventType=Oe,Ue.EventType=Oe;const Ge=Ue;var Le=r(2);const je=()=>{};var Ne;!function(e){e.internalError="internalError",e.message="message",e.termination="termination"}(Ne||(Ne={}));const Be=()=>{},Ke=e=>e,We=e=>Promise.resolve().then(e);function Ve(e){throw e}class He extends ke{constructor(e){super(t=>{const r=this,i=Object.assign(Object.assign({},t),{complete(){t.complete(),r.onCompletion()},error(e){t.error(e),r.onError(e)},next(e){t.next(e),r.onNext(e)}});try{return this.initHasRun=!0,e(i)}catch(e){i.error(e)}}),this.initHasRun=!1,this.fulfillmentCallbacks=[],this.rejectionCallbacks=[],this.firstValueSet=!1,this.state="pending"}onNext(e){this.firstValueSet||(this.firstValue=e,this.firstValueSet=!0)}onError(e){this.state="rejected",this.rejection=e;for(const t of this.rejectionCallbacks)We(()=>t(e))}onCompletion(){this.state="fulfilled";for(const e of this.fulfillmentCallbacks)We(()=>e(this.firstValue))}then(e,t){const r=e||Ke,i=t||Ve;let n=!1;return new Promise((e,t)=>{const o=r=>{if(!n){n=!0;try{e(i(r))}catch(e){t(e)}}};return this.initHasRun||this.subscribe({error:o}),"fulfilled"===this.state?e(r(this.firstValue)):"rejected"===this.state?(n=!0,e(i(this.rejection))):(this.fulfillmentCallbacks.push(t=>{try{e(r(t))}catch(e){o(e)}}),void this.rejectionCallbacks.push(o))})}catch(e){return this.then(void 0,e)}finally(e){const t=e||Be;return this.then(e=>(t(),e),()=>t())}static from(e){return function(e){return e&&"function"==typeof e.then}(e)?new He(t=>{e.then(e=>{t.next(e),t.complete()},e=>{t.error(e)})}):super.from(e)}}var qe=r(31),ze=r(8);const $e=se()("threads:master:messages");let Ye=1;function Ze(e,t){return new ke(r=>{let i;const n=o=>{var s;if($e("Message from worker:",o.data),o.data&&o.data.uid===t)if((s=o.data)&&s.type===ze.b.running)i=o.data.resultType;else if((e=>e&&e.type===ze.b.result)(o.data))"promise"===i?(void 0!==o.data.payload&&r.next(Object(Le.a)(o.data.payload)),r.complete(),e.removeEventListener("message",n)):(o.data.payload&&r.next(Object(Le.a)(o.data.payload)),o.data.complete&&(r.complete(),e.removeEventListener("message",n)));else if((e=>e&&e.type===ze.b.error)(o.data)){const t=Object(Le.a)(o.data.error);r.error(t),e.removeEventListener("message",n)}};return e.addEventListener("message",n),()=>e.removeEventListener("message",n)})}function Xe(e,t){return(...r)=>{const i=Ye++,{args:n,transferables:o}=function(e){if(0===e.length)return{args:[],transferables:[]};const t=[],r=[];for(const i of e)Object(qe.a)(i)?(t.push(Object(Le.b)(i.send)),r.push(...i.transferables)):t.push(Object(Le.b)(i));return{args:t,transferables:0===r.length?r:(i=r,Array.from(new Set(i)))};var i}(r),s={type:ze.a.run,uid:i,method:t,args:n};$e("Sending command to run function to worker:",s);try{e.postMessage(s,o)}catch(e){return He.from(Promise.reject(e))}return He.from(Ae(Ze(e,i)))}}var Je=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{l(i.next(e))}catch(e){o(e)}}function a(e){try{l(i.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}l((i=i.apply(e,t||[])).next())}))};const Qe=se()("threads:master:messages"),et=se()("threads:master:spawn"),tt=se()("threads:master:thread-utils"),rt="undefined"!=typeof process&&process.env.THREADS_WORKER_INIT_TIMEOUT?Number.parseInt(process.env.THREADS_WORKER_INIT_TIMEOUT,10):1e4;function it(e){const[t,r]=function(){let e,t=!1,r=je;return[new Promise(i=>{t?i(e):r=i}),i=>{t=!0,e=i,r()}]}();return{terminate:()=>Je(this,void 0,void 0,(function*(){tt("Terminating worker"),yield e.terminate(),r()})),termination:t}}function nt(e,t,r,i){const n=r.filter(e=>e.type===Ne.internalError).map(e=>e.error);return Object.assign(e,{[Ee.a]:n,[Ee.b]:r,[Ee.c]:i,[Ee.e]:t})}function ot(e,t){return Je(this,void 0,void 0,(function*(){et("Initializing new thread");const r=(yield function(e,t,r){return Je(this,void 0,void 0,(function*(){let i;const n=new Promise((e,n)=>{i=setTimeout(()=>n(Error(r)),t)}),o=yield Promise.race([e,n]);return clearTimeout(i),o}))}(function(e){return new Promise((t,r)=>{const i=n=>{var o;Qe("Message from worker before finishing initialization:",n.data),(o=n.data)&&"init"===o.type?(e.removeEventListener("message",i),t(n.data)):(e=>e&&"uncaughtError"===e.type)(n.data)&&(e.removeEventListener("message",i),r(Object(Le.a)(n.data.error)))};e.addEventListener("message",i)})}(e),t&&t.timeout?t.timeout:rt,`Timeout: Did not receive an init message from worker after ${rt}ms. Make sure the worker calls expose().`)).exposed,{termination:i,terminate:n}=it(e),o=function(e,t){return new ke(r=>{const i=e=>{const t={type:Ne.message,data:e.data};r.next(t)},n=e=>{tt("Unhandled promise rejection event in thread:",e);const t={type:Ne.internalError,error:Error(e.reason)};r.next(t)};e.addEventListener("message",i),e.addEventListener("unhandledrejection",n),t.then(()=>{const t={type:Ne.termination};e.removeEventListener("message",i),e.removeEventListener("unhandledrejection",n),r.next(t),r.complete()})})}(e,i);if("function"===r.type){return nt(Xe(e),e,o,n)}if("module"===r.type){return nt(function(e,t){const r={};for(const i of t)r[i]=Xe(e,i);return r}(e,r.methods),e,o,n)}{const e=r.type;throw Error(`Worker init message states unexpected type of expose(): ${e}`)}}))}const st="undefined"!=typeof navigator?navigator.hardwareConcurrency:null;var at=class{constructor(e=st){const t=new Worker("./decoder.worker.js");this.pool=Ge(()=>ot(t),e)}async decode(e,t){return new Promise((r,i)=>{this.pool.queue(async n=>{try{const i=await n(e,t);r(i)}catch(e){i(e)}})})}destroy(){this.pool.terminate(!0)}},lt=r(13),ct=r(12),ft=r(17),ut=r.n(ft),ht=r(32),dt=r.n(ht),pt=r(33),gt=r.n(pt);class mt{constructor(e,{blockSize:t=65536}={}){this.retrievalFunction=e,this.blockSize=t,this.blockRequests=new Map,this.blocks=new Map,this.blockIdsAwaitingRequest=null}async fetch(e,t,r=!1){const i=e+t,n=[],o=[],s=[];for(let t=Math.floor(e/this.blockSize)*this.blockSize;t<i;t+=this.blockSize){const e=Math.floor(t/this.blockSize);this.blocks.has(e)||this.blockRequests.has(e)||o.push(e),this.blockRequests.has(e)&&s.push(this.blockRequests.get(e)),n.push(e)}if(this.blockIdsAwaitingRequest)for(let e=0;e<o.length;++e){const t=o[e];this.blockIdsAwaitingRequest.add(t)}else this.blockIdsAwaitingRequest=new Set(o);if(r||await async function(e){return new Promise(t=>setTimeout(t,e))}(),this.blockIdsAwaitingRequest){const e=function(e){if(0===e.length)return[];const t=[];let r=[];t.push(r);for(let i=0;i<e.length;++i)0===i||e[i]===e[i-1]+1?r.push(e[i]):(r=[e[i]],t.push(r));return t}(Array.from(this.blockIdsAwaitingRequest).sort());for(const t of e){const e=this.requestData(t[0]*this.blockSize,t.length*this.blockSize);for(let r=0;r<t.length;++r){const i=t[r];this.blockRequests.set(i,(async()=>{const t=await e,n=r*this.blockSize,o=Math.min(n+this.blockSize,t.data.byteLength),s=t.data.slice(n,o);this.blockRequests.delete(i),this.blocks.set(i,{data:s,offset:t.offset+n,length:s.byteLength,top:t.offset+o})})())}}this.blockIdsAwaitingRequest=null}const a=[];for(const e of o)this.blockRequests.has(e)&&a.push(this.blockRequests.get(e));return await Promise.all(a),await Promise.all(s),function(e,t,r){const i=t+r,n=new ArrayBuffer(r),o=new Uint8Array(n);for(const r of e){const e=r.offset-t,n=r.top-i;let s,a=0,l=0;e<0?a=-e:e>0&&(l=e),n<0?s=r.length-a:n>0&&(s=i-r.offset-a);const c=new Uint8Array(r.data,a,s);o.set(c,l)}return n}(n.map(e=>this.blocks.get(e)),e,t)}async requestData(e,t){const r=await this.retrievalFunction(e,t);return r.length?r.length!==r.data.byteLength&&(r.data=r.data.slice(0,r.length)):r.length=r.data.byteLength,r.top=r.offset+r.length,r}}function yt(e,t){const{forceXHR:r}=t;if("function"==typeof fetch&&!r)return function(e,{headers:t={},blockSize:r}={}){return new mt(async(r,i)=>{const n=await fetch(e,{headers:{...t,Range:`bytes=${r}-${r+i-1}`}});if(n.ok){if(206===n.status){return{data:n.arrayBuffer?await n.arrayBuffer():(await n.buffer()).buffer,offset:r,length:i}}{const e=n.arrayBuffer?await n.arrayBuffer():(await n.buffer()).buffer;return{data:e,offset:0,length:e.byteLength}}}throw new Error("Error fetching data.")},{blockSize:r})}(e,t);if("undefined"!=typeof XMLHttpRequest)return function(e,{headers:t={},blockSize:r}={}){return new mt(async(r,i)=>new Promise((n,o)=>{const s=new XMLHttpRequest;s.open("GET",e),s.responseType="arraybuffer";const a={...t,Range:`bytes=${r}-${r+i-1}`};for(const[e,t]of Object.entries(a))s.setRequestHeader(e,t);s.onload=()=>{const e=s.response;206===s.status?n({data:e,offset:r,length:i}):n({data:e,offset:0,length:e.byteLength})},s.onerror=o,s.send()}),{blockSize:r})}(e,t);if(ut.a.get)return function(e,{headers:t={},blockSize:r}={}){return new mt(async(r,i)=>new Promise((n,o)=>{const s=gt.a.parse(e);("http:"===s.protocol?ut.a:dt.a).get({...s,headers:{...t,Range:`bytes=${r}-${r+i-1}`}},e=>{const t=[];e.on("data",e=>{t.push(e)}),e.on("end",()=>{const e=lt.Buffer.concat(t).buffer;n({data:e,offset:r,length:e.byteLength})})}).on("error",o)}),{blockSize:r})}(e,t);throw new Error("No remote source available")}function wt(e){const t=function(e,t,r){return new Promise((i,n)=>{Object(ct.open)(e,t,r,(e,t)=>{e?n(e):i(t)})})}(e,"r");return{async fetch(e,r){const i=await t,{buffer:n}=await function(...e){return new Promise((t,r)=>{Object(ct.read)(...e,(e,i,n)=>{e?r(e):t({bytesRead:i,buffer:n})})})}(i,lt.Buffer.alloc(r),0,r,e);return n.buffer}}}function bt(e,t){for(const r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}function vt(e,t){if(e.length<t.length)return!1;return e.substr(e.length-t.length)===t}function St(e){const t={};for(const r in e)if(e.hasOwnProperty(r)){t[e[r]]=r}return t}function _t(e,t){const r=[];for(let i=0;i<e;i++)r.push(t(i));return r}const Tt=St(l),kt=St(m),Pt={};bt(Pt,Tt),bt(Pt,kt);const It=St(h),Ot={nextZero:(e,t)=>{let r=t;for(;0!==e[r];)r++;return r},readUshort:(e,t)=>e[t]<<8|e[t+1],readShort:(e,t)=>{const r=Ot.ui8;return r[0]=e[t+1],r[1]=e[t+0],Ot.i16[0]},readInt:(e,t)=>{const r=Ot.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],Ot.i32[0]},readUint:(e,t)=>{const r=Ot.ui8;return r[0]=e[t+3],r[1]=e[t+2],r[2]=e[t+1],r[3]=e[t+0],Ot.ui32[0]},readASCII:(e,t,r)=>r.map(r=>String.fromCharCode(e[t+r])).join(""),readFloat:(e,t)=>{const r=Ot.ui8;return _t(4,i=>{r[i]=e[t+3-i]}),Ot.fl32[0]},readDouble:(e,t)=>{const r=Ot.ui8;return _t(8,i=>{r[i]=e[t+7-i]}),Ot.fl64[0]},writeUshort:(e,t,r)=>{e[t]=r>>8&255,e[t+1]=255&r},writeUint:(e,t,r)=>{e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=r>>0&255},writeASCII:(e,t,r)=>{_t(r.length,i=>{e[t+i]=r.charCodeAt(i)})},ui8:new Uint8Array(8)};Ot.fl64=new Float64Array(Ot.ui8.buffer),Ot.writeDouble=(e,t,r)=>{Ot.fl64[0]=r,_t(8,r=>{e[t+r]=Ot.ui8[7-r]})};const At=e=>{const t=new Uint8Array(1e3);let r=4;const i=Ot;t[0]=77,t[1]=77,t[3]=42;let n=8;if(i.writeUint(t,r,n),r+=4,e.forEach((r,o)=>{const s=((e,t,r,i)=>{let n=r;const o=Object.keys(i).filter(e=>null!=e&&"undefined"!==e);e.writeUshort(t,n,o.length),n+=2;let s=n+12*o.length+4;for(const r of o){let o=null;"number"==typeof r?o=r:"string"==typeof r&&(o=parseInt(r,10));const a=f[o],l=It[a];if(null==a||void 0===a||void 0===a)throw new Error(`unknown type of tag: ${o}`);let c=i[r];if(void 0===c)throw new Error(`failed to get value for key ${r}`);"ASCII"===a&&"string"==typeof c&&!1===vt(c,"\0")&&(c+="\0");const u=c.length;e.writeUshort(t,n,o),n+=2,e.writeUshort(t,n,l),n+=2,e.writeUint(t,n,u),n+=4;let h=[-1,1,1,2,4,8,0,0,0,0,0,0,8][l]*u,d=n;h>4&&(e.writeUint(t,n,s),d=s),"ASCII"===a?e.writeASCII(t,d,c):"SHORT"===a?_t(u,r=>{e.writeUshort(t,d+2*r,c[r])}):"LONG"===a?_t(u,r=>{e.writeUint(t,d+4*r,c[r])}):"RATIONAL"===a?_t(u,r=>{e.writeUint(t,d+8*r,Math.round(1e4*c[r])),e.writeUint(t,d+8*r+4,1e4)}):"DOUBLE"===a&&_t(u,r=>{e.writeDouble(t,d+8*r,c[r])}),h>4&&(h+=1&h,s+=h),n+=4}return[n,s]})(i,t,n,r);n=s[1],o<e.length-1&&i.writeUint(t,s[0],n)}),t.slice)return t.slice(0,n).buffer;const o=new Uint8Array(n);for(let e=0;e<n;e++)o[e]=t[e];return o.buffer},Ct=[["Compression",1],["PlanarConfiguration",1],["XPosition",0],["YPosition",0],["ResolutionUnit",1],["ExtraSamples",0],["GeoAsciiParams","WGS 84\0"],["ModelTiepoint",[0,0,0,-180,90,0]],["GTModelTypeGeoKey",2],["GTRasterTypeGeoKey",1],["GeographicTypeGeoKey",4326],["GeogCitationGeoKey","WGS 84"]];function Et(e,t){let r,i,n,o;"number"==typeof e[0]?(r=t.height||t.ImageLength,n=t.width||t.ImageWidth,i=e.length/(r*n),o=e):(i=e.length,r=e[0].length,n=e[0][0].length,o=[],_t(r,t=>{_t(n,r=>{_t(i,i=>{o.push(e[i][t][r])})})})),t.ImageLength=r,delete t.height,t.ImageWidth=n,delete t.width,t.BitsPerSample||(t.BitsPerSample=_t(i,()=>8)),Ct.forEach(e=>{const r=e[0];if(!t[r]){const i=e[1];t[r]=i}}),t.PhotometricInterpretation||(t.PhotometricInterpretation=3===t.BitsPerSample.length?2:1),t.SamplesPerPixel||(t.SamplesPerPixel=[i]),t.StripByteCounts||(t.StripByteCounts=[i*r*n]),t.ModelPixelScale||(t.ModelPixelScale=[360/n,180/r,0]),t.SampleFormat||(t.SampleFormat=_t(i,()=>1));const s=Object.keys(t).filter(e=>vt(e,"GeoKey")).sort((e,t)=>Pt[e]-Pt[t]);if(!t.GeoKeyDirectory){const e=[1,1,0,s.length];s.forEach(r=>{const i=Number(Pt[r]);let n,o,s;e.push(i),"SHORT"===f[i]?(n=1,o=0,s=t[r]):"GeogCitationGeoKey"===r?(n=t.GeoAsciiParams.length,o=Number(Pt.GeoAsciiParams),s=0):console.log(`[geotiff.js] couldn't get TIFFTagLocation for ${r}`),e.push(o),e.push(n),e.push(s)}),t.GeoKeyDirectory=e}for(const e in s)s.hasOwnProperty(e)&&delete t[e];["Compression","ExtraSamples","GeographicTypeGeoKey","GTModelTypeGeoKey","GTRasterTypeGeoKey","ImageLength","ImageWidth","PhotometricInterpretation","PlanarConfiguration","ResolutionUnit","SamplesPerPixel","XPosition","YPosition"].forEach(e=>{var r;t[e]&&(t[e]=(r=t[e],Array.isArray(r)?r:[r]))});const a=(e=>{const t={};for(const r in e)"StripOffsets"!==r&&(Pt[r]||console.error(r,"not in name2code:",Object.keys(Pt)),t[Pt[r]]=e[r]);return t})(t);return((e,t,r,i)=>{if(null==r)throw new Error(`you passed into encodeImage a width of type ${r}`);if(null==t)throw new Error(`you passed into encodeImage a width of type ${t}`);const n={256:[t],257:[r],273:[1e3],278:[r],305:"geotiff.js"};if(i)for(const e in i)i.hasOwnProperty(e)&&(n[e]=i[e]);const o=new Uint8Array(At([n])),s=new Uint8Array(e),a=n[277],l=new Uint8Array(1e3+t*r*a);return _t(o.length,e=>{l[e]=o[e]}),function(e,t){const{length:r}=e;for(let i=0;i<r;i++)t(e[i],i)}(s,(e,t)=>{l[1e3+t]=e}),l.buffer})(o,n,r,a)}function Dt(e){switch(e){case d.BYTE:case d.ASCII:case d.SBYTE:case d.UNDEFINED:return 1;case d.SHORT:case d.SSHORT:return 2;case d.LONG:case d.SLONG:case d.FLOAT:case d.IFD:return 4;case d.RATIONAL:case d.SRATIONAL:case d.DOUBLE:case d.LONG8:case d.SLONG8:case d.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${e}`)}}function xt(e){const t=e.GeoKeyDirectory;if(!t)return null;const r={};for(let i=4;i<=4*t[3];i+=4){const n=m[t[i]],o=t[i+1]?l[t[i+1]]:null,s=t[i+2],a=t[i+3];let c=null;if(o){if(c=e[o],null==c)throw new Error(`Could not get value of geoKey '${n}'.`);"string"==typeof c?c=c.substring(a,a+s-1):c.subarray&&(c=c.subarray(a,a+s-1))}else c=a;r[n]=c}return r}function Mt(e,t,r,i){let n=null,o=null;const s=Dt(t);switch(t){case d.BYTE:case d.ASCII:case d.UNDEFINED:n=new Uint8Array(r),o=e.readUint8;break;case d.SBYTE:n=new Int8Array(r),o=e.readInt8;break;case d.SHORT:n=new Uint16Array(r),o=e.readUint16;break;case d.SSHORT:n=new Int16Array(r),o=e.readInt16;break;case d.LONG:case d.IFD:n=new Uint32Array(r),o=e.readUint32;break;case d.SLONG:n=new Int32Array(r),o=e.readInt32;break;case d.LONG8:case d.IFD8:n=new Array(r),o=e.readUint64;break;case d.SLONG8:n=new Array(r),o=e.readInt64;break;case d.RATIONAL:n=new Uint32Array(2*r),o=e.readUint32;break;case d.SRATIONAL:n=new Int32Array(2*r),o=e.readInt32;break;case d.FLOAT:n=new Float32Array(r),o=e.readFloat32;break;case d.DOUBLE:n=new Float64Array(r),o=e.readFloat64;break;default:throw new RangeError(`Invalid field type: ${t}`)}if(t!==d.RATIONAL&&t!==d.SRATIONAL)for(let t=0;t<r;++t)n[t]=o.call(e,i+t*s);else for(let t=0;t<r;t+=2)n[t]=o.call(e,i+t*s),n[t+1]=o.call(e,i+(t*s+4));return t===d.ASCII?String.fromCharCode.apply(null,n):n}class Rt{async readRasters(e={}){const{window:t,width:r,height:i}=e;let{resX:n,resY:o,bbox:s}=e;const a=await this.getImage();let l=a;const c=await this.getImageCount(),f=a.getBoundingBox();if(t&&s)throw new Error('Both "bbox" and "window" passed.');if(r||i){if(t){const[e,r]=a.getOrigin(),[i,n]=a.getResolution();s=[e+t[0]*i,r+t[1]*n,e+t[2]*i,r+t[3]*n]}const e=s||f;if(r){if(n)throw new Error("Both width and resX passed");n=(e[2]-e[0])/r}if(i){if(o)throw new Error("Both width and resY passed");o=(e[3]-e[1])/i}}if(n||o){const e=[];for(let t=0;t<c;++t){const r=await this.getImage(t),{SubfileType:i,NewSubfileType:n}=r.fileDirectory;(0===t||2===i||1&n)&&e.push(r)}e.sort((e,t)=>e.getWidth()-t.getWidth());for(let t=0;t<e.length;++t){const r=e[t],i=(f[2]-f[0])/r.getWidth(),s=(f[3]-f[1])/r.getHeight();if(l=r,n&&n>i||o&&o>s)break}}let u=t;if(s){const[e,t]=a.getOrigin(),[r,i]=l.getResolution(a);u=[Math.round((s[0]-e)/r),Math.round((s[1]-t)/i),Math.round((s[2]-e)/r),Math.round((s[3]-t)/i)],u=[Math.min(u[0],u[2]),Math.min(u[1],u[3]),Math.max(u[0],u[2]),Math.max(u[1],u[3])]}return l.readRasters({...e,window:u})}}class Ft extends Rt{constructor(e,t,r,i,n={}){super(),this.source=e,this.littleEndian=t,this.bigTiff=r,this.firstIFDOffset=i,this.cache=n.cache||!1,this.fileDirectories=null,this.fileDirectoriesParsing=null,this.ghostValues=null}async getSlice(e,t){const r=this.bigTiff?4048:1024;return new $(await this.source.fetch(e,void 0!==t?t:r),e,this.littleEndian,this.bigTiff)}async parseFileDirectories(){let e=this.firstIFDOffset;const t=this.bigTiff?8:2,r=this.bigTiff?20:12,i=[];for(;0!==e;){let n=await this.getSlice(e);const o=this.bigTiff?n.readUint64(e):n.readUint16(e),s=o*r+(this.bigTiff?16:6);n.covers(e,s)||(n=await this.getSlice(e,s));const a={};let c=e+(this.bigTiff?8:2);for(let e=0;e<o;c+=r,++e){const e=n.readUint16(c),t=n.readUint16(c+2),r=this.bigTiff?n.readUint64(c+4):n.readUint32(c+4);let i,o;const s=Dt(t),f=c+(this.bigTiff?12:8);if(s*r<=(this.bigTiff?8:4))i=Mt(n,t,r,f);else{const e=n.readOffset(f),o=Dt(t)*r;if(n.covers(e,o))i=Mt(n,t,r,e);else{i=Mt(await this.getSlice(e,o),t,r,e)}}o=1===r&&-1===u.indexOf(e)&&t!==d.RATIONAL&&t!==d.SRATIONAL?i[0]:i,a[l[e]]=o}i.push([a,xt(a)]),e=n.readOffset(e+t+r*o)}return i}async getImage(e=0){this.fileDirectories||(this.fileDirectoriesParsing||(this.fileDirectoriesParsing=this.parseFileDirectories()),this.fileDirectories=await this.fileDirectoriesParsing);const t=this.fileDirectories[e];if(!t)throw new RangeError("Invalid image index");return new q(t[0],t[1],this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){return this.fileDirectories||(this.fileDirectoriesParsing||(this.fileDirectoriesParsing=this.parseFileDirectories()),this.fileDirectories=await this.fileDirectoriesParsing),this.fileDirectories.length}async getGhostValues(){const e=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const t="GDAL_STRUCTURAL_METADATA_SIZE=",r=t.length+100;let i=await this.getSlice(e,r);if(t===Mt(i,d.ASCII,t.length,e)){const t=Mt(i,d.ASCII,r,e).split("\n")[0],n=Number(t.split("=")[1].split(" ")[0])+t.length;n>r&&(i=await this.getSlice(e,n));const o=Mt(i,d.ASCII,n,e);this.ghostValues={},o.split("\n").filter(e=>e.length>0).map(e=>e.split("=")).forEach(([e,t])=>{this.ghostValues[e]=t})}return this.ghostValues}static async fromSource(e,t){const r=await e.fetch(0,1024),i=new z(r),n=i.getUint16(0,0);let o;if(18761===n)o=!0;else{if(19789!==n)throw new TypeError("Invalid byte order value.");o=!1}const s=i.getUint16(2,o);let a;if(42===s)a=!1;else{if(43!==s)throw new TypeError("Invalid magic number.");if(a=!0,8!==i.getUint16(4,o))throw new Error("Unsupported offset byte-size.")}const l=a?i.getUint64(8,o):i.getUint32(4,o);return new Ft(e,o,a,l,t)}}class Ut extends Rt{constructor(e,t){super(),this.mainFile=e,this.overviewFiles=t,this.imageFiles=[e].concat(t),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const e=[this.mainFile.parseFileDirectories()].concat(this.overviewFiles.map(e=>e.parseFileDirectories()));return this.fileDirectoriesPerFile=await Promise.all(e),this.fileDirectoriesPerFile}async getImage(e=0){this.fileDirectoriesPerFile||(this.fileDirectoriesPerFileParsing||(this.fileDirectoriesPerFileParsing=this.parseFileDirectoriesPerFile()),this.fileDirectoriesPerFile=await this.fileDirectoriesPerFileParsing);let t=e;for(let e=0;e<this.fileDirectoriesPerFile.length;++e){const r=this.fileDirectoriesPerFile[e];if(t<r.length){const i=this.imageFiles[e];return new q(r[t][0],r[t][1],i.dataView,i.littleEndian,i.cache,i.source)}t-=r.length}throw new RangeError("Invalid image index")}async getImageCount(){return this.fileDirectoriesPerFile||(this.fileDirectoriesPerFileParsing||(this.fileDirectoriesPerFileParsing=this.parseFileDirectoriesPerFile()),this.fileDirectoriesPerFile=await this.fileDirectoriesPerFileParsing),this.fileDirectoriesPerFile.reduce((e,t)=>e+t.length,0)}}async function Gt(e,t={}){return Ft.fromSource(yt(e,t))}async function Lt(e){return Ft.fromSource(function(e){return{fetch:async(t,r)=>e.slice(t,t+r)}}(e))}async function jt(e){return Ft.fromSource(wt(e))}async function Nt(e){return Ft.fromSource((t=e,{fetch:async(e,r)=>new Promise((i,n)=>{const o=t.slice(e,e+r),s=new FileReader;s.onload=e=>i(e.target.result),s.onerror=n,s.readAsArrayBuffer(o)})}));var t}async function Bt(e,t=[],r={}){const i=await Ft.fromSource(yt(e,r)),n=await Promise.all(t.map(e=>Ft.fromSource(yt(e,r))));return new Ut(i,n)}async function Kt(e,t){return Et(e,t)}}])}));